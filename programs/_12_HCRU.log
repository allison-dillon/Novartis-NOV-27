1                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6 MBCS3170) 
      Licensed to NOVARTIS - SUPPL12, Site 70189709.
NOTE: This session is executing on the Linux 3.10.0-1160.11.1.el7.x86_64 (LIN X64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/IML 15.1

NOTE: Additional host information:

 Linux LIN X64 3.10.0-1160.11.1.el7.x86_64 #1 SMP Mon Nov 30 13:05:31 EST 2020 x86_64 Red Hat Enterprise Linux Server release 7.9 
      (Maipo) 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.02 seconds
      cpu time            0.02 seconds
      

NOTE: AUTOEXEC processing beginning; file is /mnt/share/home/dingyig/proj/NOV-27/programs/autoexec.sas.

NOTE: Libref ASSIGN was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /mnt/share/sas
ODBC: AUTOCOMMIT is YES for connection 0
NOTE: Libref HEOR was successfully assigned as follows: 
      Engine:        ODBC 
      Physical Name: rwe
NOTE: Libref DERIVED was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /home/dingyig/proj/NOV-27
ODBC: AUTOCOMMIT is YES for connection 1
NOTE: Libref SOURCE was successfully assigned as follows: 
      Engine:        ODBC 
      Physical Name: rwe

NOTE: AUTOEXEC processing completed.
2                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM


1          
2          options mprint;
3          %macro labs(year, years);
4          /*counts labs during post index period*/
5          	%let cohorts=a*b;
6          	%do z=1 %to 2;
7          	%let ct = %scan(&cohorts., &z., *);
8          	%let groups=overall*mi*pad*stroke*unsta_angina*sta_angina*tia*other*revasc*cvd*anginatia*noncvd;
9          		%do i=1 %to 12;
10         			%let ad = %scan(&groups., &i., *);
11         	%create(_12_lab_&ad.&z.&year.)
12         			select q.patid, q.index_date_&ad.
13         			%do r=1 %to 7;
14         				%let lab = %scan(ldlc*hdlc*tc*tg*lpa_mg*lpa_mol*cprot, &r., *);
15         				, count(distinct case when w&r..patid is not null then w&r..rslt_nbr end) as &lab._cnt
16         			%end;
17         		from dingyig._01_cohort_6&ct. as q
18         			%do t=1 %to 7;
19         				%let lab = %scan(ldlc*hdlc*tc*tg*lpa_mg*lpa_mol*cprot, &t., *);
20         				left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2
21         						where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and
21       ! grp="&lab.")
22         					as w&t. on q.patid=w&t..patid and q.index_date_&ad. < w&t..fst_dt and w&t..fst_dt<=&years.
23         			%end;
24         			group by q.patid, q.index_date_&ad.
25         	%create(_12_lab_&ad.&z.&year.);
26         			%end;
27         		%end;
28         %mend;
29         %labs(one_year, index_date_&ad. + INTERVAL 365 DAYS);
WARNING: Apparent symbolic reference AD not resolved.
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_overall1one_year PURGE ) BY imp;
 
ODBC_1: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_overall1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085115
Total seconds used by the ODBC ACCESS engine were     0.086799
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_overall1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_overall , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall 
3                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

< w3.fst_dt and w3.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall < w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and 
w5.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and 
w7.fst_dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_2: Executed: on connection 2
CREATE TABLE dingyig._12_lab_overall1one_year AS select q.patid, q.index_date_overall , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 365 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall < w3.fst_dt and w3.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall 
< w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and w5.fst_dt<=index_date_overall + INTERVAL 365 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and w7.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.775965
Total seconds used by the ODBC ACCESS engine were     3.048685
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_overall1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_overall1one_year );
 
ODBC_3: Prepared: on connection 2
SELECT 'dingyig._12_lab_overall1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_overall1one_year
 
 
ODBC_4: Executed: on connection 2
Prepared statement ODBC_3
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004379
Total SQL execution seconds were:                   0.053712
4                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL prepare seconds were:                     0.019233
Total SQL describe seconds were:                    0.000550
Total seconds used by the ODBC ACCESS engine were     0.125549
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 1.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.68 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_mi1one_year PURGE ) BY imp;
 
ODBC_5: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_mi1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086657
Total seconds used by the ODBC ACCESS engine were     0.088290
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_mi1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , 
count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_mi < 
w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on 
q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 
365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_mi < 
w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi < w6.fst_dt and w6.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < 
w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 365 DAYS group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_6: Executed: on connection 2
CREATE TABLE dingyig._12_lab_mi1one_year AS select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
5                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w1.patid and q.index_date_mi < w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < 
w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_mi < w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi 
< w6.fst_dt and w6.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 365 DAYS group by 
q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.720957
Total seconds used by the ODBC ACCESS engine were     3.029909
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_mi1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_mi1one_year );
 
ODBC_7: Prepared: on connection 2
SELECT 'dingyig._12_lab_mi1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_mi1one_year
 
 
ODBC_8: Executed: on connection 2
Prepared statement ODBC_7
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004490
Total SQL execution seconds were:                   0.077603
Total SQL prepare seconds were:                     0.020253
Total SQL describe seconds were:                    0.000506
Total seconds used by the ODBC ACCESS engine were     0.124045
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 2.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.66 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_pad1one_year PURGE ) BY imp;
 
ODBC_9: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_pad1one_year PURGE
 
 
Summary Statistics for ODBC are:
6                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.093213
Total seconds used by the ODBC ACCESS engine were     0.094749
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_pad1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_pad < 
w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < w3.fst_dt and 
w3.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and w5.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + INTERVAL 365 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_10: Executed: on connection 2
CREATE TABLE dingyig._12_lab_pad1one_year AS select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_pad < w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < 
w3.fst_dt and w3.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and 
w5.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.673330
Total seconds used by the ODBC ACCESS engine were     2.963300
7                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_pad1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_pad1one_year );
 
ODBC_11: Prepared: on connection 2
SELECT 'dingyig._12_lab_pad1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_pad1one_year
 
 
ODBC_12: Executed: on connection 2
Prepared statement ODBC_11
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004284
Total SQL execution seconds were:                   0.064573
Total SQL prepare seconds were:                     0.019310
Total SQL describe seconds were:                    0.000491
Total seconds used by the ODBC ACCESS engine were     0.106736
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 3.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.58 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_stroke1one_year PURGE ) BY imp;
 
ODBC_13: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_stroke1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080897
Total seconds used by the ODBC ACCESS engine were     0.082472
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_stroke1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and w2.fst_dt<=index_date_stroke + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_stroke 
< w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and w4.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and 
8                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w5.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and w6.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and 
w7.fst_dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_14: Executed: on connection 2
CREATE TABLE dingyig._12_lab_stroke1one_year AS select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and 
w2.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_stroke < w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and 
w4.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and w5.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and 
w6.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and w7.fst_dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, 
q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.708352
Total seconds used by the ODBC ACCESS engine were     3.049697
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_stroke1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_stroke1one_year );
 
ODBC_15: Prepared: on connection 2
SELECT 'dingyig._12_lab_stroke1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_stroke1one_year
 
 
ODBC_16: Executed: on connection 2
Prepared statement ODBC_15
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004928
Total SQL execution seconds were:                   0.082781
Total SQL prepare seconds were:                     0.019135
Total SQL describe seconds were:                    0.000504
Total seconds used by the ODBC ACCESS engine were     0.127482
 
MPRINT(CREATE):   QUIT;
9                                                          The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 4.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.67 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina1one_year PURGE ) BY imp;
 
ODBC_17: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078228
Total seconds used by the ODBC ACCESS engine were     0.079749
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_unsta_angina1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_unsta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and w3.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and w5.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt 
and w6.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 
on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and w7.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by 
q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_18: Executed: on connection 2
CREATE TABLE dingyig._12_lab_unsta_angina1one_year AS select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid 
is not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
10                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_unsta_angina < w2.fst_dt and w2.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and w4.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 
on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt and w6.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.739428
Total seconds used by the ODBC ACCESS engine were     3.051200
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_unsta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab_unsta_angina1one_year );
 
ODBC_19: Prepared: on connection 2
SELECT 'dingyig._12_lab_unsta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_unsta_angina1one_year
 
 
ODBC_20: Executed: on connection 2
Prepared statement ODBC_19
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004600
Total SQL execution seconds were:                   0.051210
Total SQL prepare seconds were:                     0.021118
Total SQL describe seconds were:                    0.000519
Total seconds used by the ODBC ACCESS engine were     0.096532
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 5.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.69 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_sta_angina1one_year PURGE ) BY imp;
 
ODBC_21: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_sta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090656
Total seconds used by the ODBC ACCESS engine were     0.092241
11                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_sta_angina1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_sta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and w3.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and w5.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and 
w6.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and w7.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, 
q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_22: Executed: on connection 2
CREATE TABLE dingyig._12_lab_sta_angina1one_year AS select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_sta_angina < w2.fst_dt and w2.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and w4.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and w6.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.879775
Total seconds used by the ODBC ACCESS engine were     3.205422
12                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_sta_angina1one_year );
 
ODBC_23: Prepared: on connection 2
SELECT 'dingyig._12_lab_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_sta_angina1one_year
 
 
ODBC_24: Executed: on connection 2
Prepared statement ODBC_23
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004769
Total SQL execution seconds were:                   0.051488
Total SQL prepare seconds were:                     0.019152
Total SQL describe seconds were:                    0.000574
Total seconds used by the ODBC ACCESS engine were     0.096522
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 6.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.81 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_tia1one_year PURGE ) BY imp;
 
ODBC_25: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_tia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082385
Total seconds used by the ODBC ACCESS engine were     0.083974
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_tia1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_tia < 
w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < w3.fst_dt and 
w3.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and w5.fst_dt<=index_date_tia + 
13                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + INTERVAL 365 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_26: Executed: on connection 2
CREATE TABLE dingyig._12_lab_tia1one_year AS select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_tia < w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < 
w3.fst_dt and w3.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and 
w5.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.734839
Total seconds used by the ODBC ACCESS engine were     3.049759
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_tia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_tia1one_year );
 
ODBC_27: Prepared: on connection 2
SELECT 'dingyig._12_lab_tia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_tia1one_year
 
 
ODBC_28: Executed: on connection 2
Prepared statement ODBC_27
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004700
Total SQL execution seconds were:                   0.050134
Total SQL prepare seconds were:                     0.020008
Total SQL describe seconds were:                    0.000720
Total seconds used by the ODBC ACCESS engine were     0.094925
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 7.
14                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           3.64 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_other1one_year PURGE ) BY imp;
 
ODBC_29: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_other1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075907
Total seconds used by the ODBC ACCESS engine were     0.077496
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_other1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_other , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and w2.fst_dt<=index_date_other + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_other < 
w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_other < w5.fst_dt and 
w5.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_other < w7.fst_dt and 
w7.fst_dt<=index_date_other + INTERVAL 365 DAYS group by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_30: Executed: on connection 2
CREATE TABLE dingyig._12_lab_other1one_year AS select q.patid, q.index_date_other , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and 
w2.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
15                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w3.patid and q.index_date_other < w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other 
+ INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and 
q.index_date_other < w5.fst_dt and w5.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and 
q.index_date_other < w7.fst_dt and w7.fst_dt<=index_date_other + INTERVAL 365 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.771979
Total seconds used by the ODBC ACCESS engine were     3.096705
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_other1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_other1one_year );
 
ODBC_31: Prepared: on connection 2
SELECT 'dingyig._12_lab_other1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_other1one_year
 
 
ODBC_32: Executed: on connection 2
Prepared statement ODBC_31
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004710
Total SQL execution seconds were:                   0.050293
Total SQL prepare seconds were:                     0.017722
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.093798
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 8.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.70 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_revasc1one_year PURGE ) BY imp;
 
ODBC_33: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_revasc1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076793
Total seconds used by the ODBC ACCESS engine were     0.078395
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_revasc1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
16                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and w2.fst_dt<=index_date_revasc + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_revasc 
< w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and w4.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and 
w5.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and w6.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and 
w7.fst_dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_34: Executed: on connection 2
CREATE TABLE dingyig._12_lab_revasc1one_year AS select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and 
w2.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_revasc < w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and 
w4.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and w5.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and 
w6.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and w7.fst_dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, 
q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.855518
Total seconds used by the ODBC ACCESS engine were     3.170851
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_revasc1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_revasc1one_year );
 
17                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_35: Prepared: on connection 2
SELECT 'dingyig._12_lab_revasc1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_revasc1one_year
 
 
ODBC_36: Executed: on connection 2
Prepared statement ODBC_35
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004745
Total SQL execution seconds were:                   0.050656
Total SQL prepare seconds were:                     0.020529
Total SQL describe seconds were:                    0.000507
Total seconds used by the ODBC ACCESS engine were     0.096929
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 9.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.44 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_cvd1one_year PURGE ) BY imp;
 
ODBC_37: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_cvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080547
Total seconds used by the ODBC ACCESS engine were     0.082114
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_cvd1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_cvd < 
w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < w3.fst_dt and 
w3.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and w5.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
18                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + INTERVAL 365 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_38: Executed: on connection 2
CREATE TABLE dingyig._12_lab_cvd1one_year AS select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_cvd < w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < 
w3.fst_dt and w3.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and 
w5.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.688847
Total seconds used by the ODBC ACCESS engine were     2.988905
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_cvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_cvd1one_year );
 
ODBC_39: Prepared: on connection 2
SELECT 'dingyig._12_lab_cvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_cvd1one_year
 
 
ODBC_40: Executed: on connection 2
Prepared statement ODBC_39
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004758
Total SQL execution seconds were:                   0.069467
Total SQL prepare seconds were:                     0.019033
Total SQL describe seconds were:                    0.000492
Total seconds used by the ODBC ACCESS engine were     0.113286
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 10.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.60 seconds
      cpu time            0.09 seconds
      
19                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM


MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_anginatia1one_year PURGE ) BY imp;
 
ODBC_41: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_anginatia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.105851
Total seconds used by the ODBC ACCESS engine were     0.107516
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_anginatia1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_anginatia < w2.fst_dt and 
w2.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_anginatia < w4.fst_dt and 
w4.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and w5.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and 
w6.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and w7.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, 
q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_42: Executed: on connection 2
CREATE TABLE dingyig._12_lab_anginatia1one_year AS select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_anginatia < w2.fst_dt and w2.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia 
+ INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and 
20                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_anginatia < w4.fst_dt and w4.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and 
w5.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and w6.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and 
w7.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.746622
Total seconds used by the ODBC ACCESS engine were     3.031762
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_anginatia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_anginatia1one_year );
 
ODBC_43: Prepared: on connection 2
SELECT 'dingyig._12_lab_anginatia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_anginatia1one_year
 
 
ODBC_44: Executed: on connection 2
Prepared statement ODBC_43
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004189
Total SQL execution seconds were:                   0.050129
Total SQL prepare seconds were:                     0.019899
Total SQL describe seconds were:                    0.000504
Total seconds used by the ODBC ACCESS engine were     0.093400
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 11.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.65 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_noncvd1one_year PURGE ) BY imp;
 
ODBC_45: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_noncvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.109055
Total seconds used by the ODBC ACCESS engine were     0.110918
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_noncvd1one_year AS
MPRINT(LABS):   select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
21                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and w2.fst_dt<=index_date_noncvd + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_noncvd 
< w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and w4.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and 
w5.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and w6.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and 
w7.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_46: Executed: on connection 2
CREATE TABLE dingyig._12_lab_noncvd1one_year AS select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and 
w2.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_noncvd < w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and 
w4.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and w5.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and 
w6.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and w7.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, 
q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.833543
Total seconds used by the ODBC ACCESS engine were     3.138287
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_noncvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_noncvd1one_year );
 
ODBC_47: Prepared: on connection 2
SELECT 'dingyig._12_lab_noncvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_noncvd1one_year
22                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_48: Executed: on connection 2
Prepared statement ODBC_47
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004342
Total SQL execution seconds were:                   0.058832
Total SQL prepare seconds were:                     0.021839
Total SQL describe seconds were:                    0.000528
Total seconds used by the ODBC ACCESS engine were     0.105642
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 12.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.78 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_overall2one_year PURGE ) BY imp;
 
ODBC_49: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_overall2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087468
Total seconds used by the ODBC ACCESS engine were     0.089169
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_overall2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_overall , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall 
< w3.fst_dt and w3.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall < w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and 
w5.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and 
w7.fst_dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
23                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   ) BY imp;
 
ODBC_50: Executed: on connection 2
CREATE TABLE dingyig._12_lab_overall2one_year AS select q.patid, q.index_date_overall , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 365 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall < w3.fst_dt and w3.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall 
< w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and w5.fst_dt<=index_date_overall + INTERVAL 365 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and w7.fst_dt<=index_date_overall + 
INTERVAL 365 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   8.460724
Total seconds used by the ODBC ACCESS engine were     8.783946
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_overall2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_overall2one_year );
 
ODBC_51: Prepared: on connection 2
SELECT 'dingyig._12_lab_overall2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_overall2one_year
 
 
ODBC_52: Executed: on connection 2
Prepared statement ODBC_51
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005485
Total SQL execution seconds were:                   0.154316
Total SQL prepare seconds were:                     0.020469
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.203224
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 13.
NOTE: PROCEDURE SQL used (Total process time):
      real time           9.15 seconds
      cpu time            0.14 seconds
      

24                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_mi2one_year PURGE ) BY imp;
 
ODBC_53: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_mi2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081449
Total seconds used by the ODBC ACCESS engine were     0.083045
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_mi2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , 
count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_mi < 
w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on 
q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 
365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_mi < 
w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi < w6.fst_dt and w6.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < 
w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 365 DAYS group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_54: Executed: on connection 2
CREATE TABLE dingyig._12_lab_mi2one_year AS select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_mi < w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < 
w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_mi < w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
25                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi 
< w6.fst_dt and w6.fst_dt<=index_date_mi + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 365 DAYS group by 
q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.115684
Total seconds used by the ODBC ACCESS engine were     3.448354
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_mi2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_mi2one_year );
 
ODBC_55: Prepared: on connection 2
SELECT 'dingyig._12_lab_mi2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_mi2one_year
 
 
ODBC_56: Executed: on connection 2
Prepared statement ODBC_55
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005547
Total SQL execution seconds were:                   0.160108
Total SQL prepare seconds were:                     0.020199
Total SQL describe seconds were:                    0.000508
Total seconds used by the ODBC ACCESS engine were     0.208676
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 14.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.16 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_pad2one_year PURGE ) BY imp;
 
ODBC_57: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_pad2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081301
Total seconds used by the ODBC ACCESS engine were     0.082866
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_pad2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_pad < 
26                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < w3.fst_dt and 
w3.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and w5.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + INTERVAL 365 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_58: Executed: on connection 2
CREATE TABLE dingyig._12_lab_pad2one_year AS select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_pad < w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < 
w3.fst_dt and w3.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and 
w5.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.951028
Total seconds used by the ODBC ACCESS engine were     3.368596
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_pad2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_pad2one_year );
 
ODBC_59: Prepared: on connection 2
SELECT 'dingyig._12_lab_pad2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_pad2one_year
 
 
ODBC_60: Executed: on connection 2
Prepared statement ODBC_59
 
27                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005608
Total SQL execution seconds were:                   0.048250
Total SQL prepare seconds were:                     0.028039
Total SQL describe seconds were:                    0.000523
Total seconds used by the ODBC ACCESS engine were     0.115259
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 15.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.64 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_stroke2one_year PURGE ) BY imp;
 
ODBC_61: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_stroke2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079231
Total seconds used by the ODBC ACCESS engine were     0.080793
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_stroke2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and w2.fst_dt<=index_date_stroke + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_stroke 
< w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and w4.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and 
w5.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and w6.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and 
w7.fst_dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_62: Executed: on connection 2
CREATE TABLE dingyig._12_lab_stroke2one_year AS select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
28                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and 
w2.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_stroke < w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and 
w4.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and w5.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and 
w6.fst_dt<=index_date_stroke + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and w7.fst_dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, 
q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   8.316941
Total seconds used by the ODBC ACCESS engine were     8.593368
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_stroke2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_stroke2one_year );
 
ODBC_63: Prepared: on connection 2
SELECT 'dingyig._12_lab_stroke2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_stroke2one_year
 
 
ODBC_64: Executed: on connection 2
Prepared statement ODBC_63
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004116
Total SQL execution seconds were:                   0.054710
Total SQL prepare seconds were:                     0.020042
Total SQL describe seconds were:                    0.000530
Total seconds used by the ODBC ACCESS engine were     0.098422
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 16.
NOTE: PROCEDURE SQL used (Total process time):
      real time           9.19 seconds
      cpu time            0.14 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina2one_year PURGE ) BY imp;
29                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_65: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080805
Total seconds used by the ODBC ACCESS engine were     0.082489
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_unsta_angina2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_unsta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and w3.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and w5.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt 
and w6.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 
on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and w7.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by 
q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_66: Executed: on connection 2
CREATE TABLE dingyig._12_lab_unsta_angina2one_year AS select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid 
is not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_unsta_angina < w2.fst_dt and w2.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and w4.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 
on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt and w6.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
30                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.258105
Total seconds used by the ODBC ACCESS engine were     3.555535
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_unsta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab_unsta_angina2one_year );
 
ODBC_67: Prepared: on connection 2
SELECT 'dingyig._12_lab_unsta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_unsta_angina2one_year
 
 
ODBC_68: Executed: on connection 2
Prepared statement ODBC_67
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004768
Total SQL execution seconds were:                   0.180084
Total SQL prepare seconds were:                     0.020294
Total SQL describe seconds were:                    0.000520
Total seconds used by the ODBC ACCESS engine were     0.224625
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 17.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.28 seconds
      cpu time            0.12 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_sta_angina2one_year PURGE ) BY imp;
 
ODBC_69: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_sta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.105097
Total seconds used by the ODBC ACCESS engine were     0.106713
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_sta_angina2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
31                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_sta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and w3.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and w5.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and 
w6.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and w7.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, 
q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_70: Executed: on connection 2
CREATE TABLE dingyig._12_lab_sta_angina2one_year AS select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_sta_angina < w2.fst_dt and w2.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and w4.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and w6.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.717501
Total seconds used by the ODBC ACCESS engine were     3.027697
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_sta_angina2one_year );
 
ODBC_71: Prepared: on connection 2
SELECT 'dingyig._12_lab_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_sta_angina2one_year
 
 
ODBC_72: Executed: on connection 2
Prepared statement ODBC_71
 
32                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005207
Total SQL execution seconds were:                   0.368097
Total SQL prepare seconds were:                     0.019142
Total SQL describe seconds were:                    0.000538
Total seconds used by the ODBC ACCESS engine were     0.413598
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 18.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.96 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_tia2one_year PURGE ) BY imp;
 
ODBC_73: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_tia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086087
Total seconds used by the ODBC ACCESS engine were     0.088582
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_tia2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_tia < 
w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < w3.fst_dt and 
w3.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and w5.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + INTERVAL 365 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_74: Executed: on connection 2
CREATE TABLE dingyig._12_lab_tia2one_year AS select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
33                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_tia < w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < 
w3.fst_dt and w3.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and 
w5.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.094866
Total seconds used by the ODBC ACCESS engine were     3.403889
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_tia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_tia2one_year );
 
ODBC_75: Prepared: on connection 2
SELECT 'dingyig._12_lab_tia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_tia2one_year
 
 
ODBC_76: Executed: on connection 2
Prepared statement ODBC_75
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005597
Total SQL execution seconds were:                   0.343339
Total SQL prepare seconds were:                     0.363531
Total SQL describe seconds were:                    0.000569
Total seconds used by the ODBC ACCESS engine were     0.734012
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 19.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.31 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_other2one_year PURGE ) BY imp;
 
34                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_77: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_other2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079808
Total seconds used by the ODBC ACCESS engine were     0.081622
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_other2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_other , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and w2.fst_dt<=index_date_other + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_other < 
w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_other < w5.fst_dt and 
w5.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_other < w7.fst_dt and 
w7.fst_dt<=index_date_other + INTERVAL 365 DAYS group by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_78: Executed: on connection 2
CREATE TABLE dingyig._12_lab_other2one_year AS select q.patid, q.index_date_other , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and 
w2.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_other < w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other 
+ INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and 
q.index_date_other < w5.fst_dt and w5.fst_dt<=index_date_other + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and 
q.index_date_other < w7.fst_dt and w7.fst_dt<=index_date_other + INTERVAL 365 DAYS group by q.patid, q.index_date_other
35                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.836992
Total seconds used by the ODBC ACCESS engine were     3.129798
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_other2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_other2one_year );
 
ODBC_79: Prepared: on connection 2
SELECT 'dingyig._12_lab_other2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_other2one_year
 
 
ODBC_80: Executed: on connection 2
Prepared statement ODBC_79
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004293
Total SQL execution seconds were:                   0.052280
Total SQL prepare seconds were:                     0.021620
Total SQL describe seconds were:                    0.000544
Total seconds used by the ODBC ACCESS engine were     0.097527
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 20.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.73 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_revasc2one_year PURGE ) BY imp;
 
ODBC_81: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_revasc2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   1.000538
Total seconds used by the ODBC ACCESS engine were     1.002102
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_revasc2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and w2.fst_dt<=index_date_revasc + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_revasc 
36                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

< w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and w4.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and 
w5.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and w6.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and 
w7.fst_dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_82: Executed: on connection 2
CREATE TABLE dingyig._12_lab_revasc2one_year AS select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and 
w2.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_revasc < w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and 
w4.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and w5.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and 
w6.fst_dt<=index_date_revasc + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and w7.fst_dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, 
q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.264507
Total seconds used by the ODBC ACCESS engine were     3.579317
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_revasc2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_revasc2one_year );
 
ODBC_83: Prepared: on connection 2
SELECT 'dingyig._12_lab_revasc2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_revasc2one_year
 
 
ODBC_84: Executed: on connection 2
Prepared statement ODBC_83
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006628
Total SQL execution seconds were:                   0.189172
37                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL prepare seconds were:                     0.020315
Total SQL describe seconds were:                    0.000544
Total seconds used by the ODBC ACCESS engine were     0.248557
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 21.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.36 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_cvd2one_year PURGE ) BY imp;
 
ODBC_85: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_cvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075578
Total seconds used by the ODBC ACCESS engine were     0.077105
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_cvd2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_cvd < 
w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < w3.fst_dt and 
w3.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and w5.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + INTERVAL 365 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_86: Executed: on connection 2
CREATE TABLE dingyig._12_lab_cvd2one_year AS select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
38                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_cvd < w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < 
w3.fst_dt and w3.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and 
w5.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 365 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.851742
Total seconds used by the ODBC ACCESS engine were     8.131361
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_cvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_cvd2one_year );
 
ODBC_87: Prepared: on connection 2
SELECT 'dingyig._12_lab_cvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_cvd2one_year
 
 
ODBC_88: Executed: on connection 2
Prepared statement ODBC_87
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004221
Total SQL execution seconds were:                   0.055145
Total SQL prepare seconds were:                     0.264130
Total SQL describe seconds were:                    0.000550
Total seconds used by the ODBC ACCESS engine were     0.342852
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 22.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.97 seconds
      cpu time            0.15 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_anginatia2one_year PURGE ) BY imp;
 
ODBC_89: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_anginatia2one_year PURGE
 
 
39                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.734266
Total seconds used by the ODBC ACCESS engine were     0.736109
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_anginatia2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_anginatia < w2.fst_dt and 
w2.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_anginatia < w4.fst_dt and 
w4.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and w5.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and 
w6.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and w7.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, 
q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_90: Executed: on connection 2
CREATE TABLE dingyig._12_lab_anginatia2one_year AS select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_anginatia < w2.fst_dt and w2.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia 
+ INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and 
q.index_date_anginatia < w4.fst_dt and w4.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and 
w5.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and w6.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and 
w7.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
 
 
40                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.833155
Total seconds used by the ODBC ACCESS engine were     3.153292
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_anginatia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_anginatia2one_year );
 
ODBC_91: Prepared: on connection 2
SELECT 'dingyig._12_lab_anginatia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_anginatia2one_year
 
 
ODBC_92: Executed: on connection 2
Prepared statement ODBC_91
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004540
Total SQL execution seconds were:                   0.052302
Total SQL prepare seconds were:                     0.019694
Total SQL describe seconds were:                    0.000501
Total seconds used by the ODBC ACCESS engine were     0.097641
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 23.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.42 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_noncvd2one_year PURGE ) BY imp;
 
ODBC_93: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_noncvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080676
Total seconds used by the ODBC ACCESS engine were     0.082454
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_noncvd2one_year AS
MPRINT(LABS):   select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and w2.fst_dt<=index_date_noncvd + INTERVAL 365 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_noncvd 
< w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
41                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and w4.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and 
w5.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and w6.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and 
w7.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_94: Executed: on connection 2
CREATE TABLE dingyig._12_lab_noncvd2one_year AS select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and 
w2.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_noncvd < w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and 
w4.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and w5.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and 
w6.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and w7.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, 
q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.880322
Total seconds used by the ODBC ACCESS engine were     3.271931
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_noncvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_noncvd2one_year );
 
ODBC_95: Prepared: on connection 2
SELECT 'dingyig._12_lab_noncvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_noncvd2one_year
 
 
ODBC_96: Executed: on connection 2
Prepared statement ODBC_95
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004614
Total SQL execution seconds were:                   0.054537
Total SQL prepare seconds were:                     0.019406
Total SQL describe seconds were:                    0.000491
42                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.099821
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 24.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.87 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
WARNING: Apparent symbolic reference AD not resolved.
30         %labs(two_years,  index_date_&ad. + INTERVAL 730 DAYS);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_overall1two_years PURGE ) BY imp;
 
ODBC_97: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_overall1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081809
Total seconds used by the ODBC ACCESS engine were     0.083370
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_overall1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_overall , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall 
< w3.fst_dt and w3.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall < w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and 
w5.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and 
w7.fst_dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_98: Executed: on connection 2
CREATE TABLE dingyig._12_lab_overall1two_years AS select q.patid, q.index_date_overall , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
43                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 730 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall < w3.fst_dt and w3.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall 
< w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and w5.fst_dt<=index_date_overall + INTERVAL 730 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and w7.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.060322
Total seconds used by the ODBC ACCESS engine were     3.374891
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_overall1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_overall1two_years );
 
ODBC_99: Prepared: on connection 2
SELECT 'dingyig._12_lab_overall1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_overall1two_years
 
 
ODBC_100: Executed: on connection 2
Prepared statement ODBC_99
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004893
Total SQL execution seconds were:                   0.057314
Total SQL prepare seconds were:                     0.021261
Total SQL describe seconds were:                    0.000483
Total seconds used by the ODBC ACCESS engine were     0.104575
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 25.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.98 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_mi1two_years PURGE ) BY imp;
 
ODBC_101: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_mi1two_years PURGE
 
44                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079288
Total seconds used by the ODBC ACCESS engine were     0.080954
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_mi1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , 
count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_mi < 
w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on 
q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 
730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_mi < 
w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi < w6.fst_dt and w6.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < 
w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 730 DAYS group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_102: Executed: on connection 2
CREATE TABLE dingyig._12_lab_mi1two_years AS select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_mi < w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < 
w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_mi < w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi 
< w6.fst_dt and w6.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 730 DAYS group by 
q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.441650
45                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     5.749884
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_mi1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_mi1two_years );
 
ODBC_103: Prepared: on connection 2
SELECT 'dingyig._12_lab_mi1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_mi1two_years
 
 
ODBC_104: Executed: on connection 2
Prepared statement ODBC_103
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004535
Total SQL execution seconds were:                   0.052516
Total SQL prepare seconds were:                     0.022627
Total SQL describe seconds were:                    0.000484
Total seconds used by the ODBC ACCESS engine were     0.100487
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 26.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.00 seconds
      cpu time            0.12 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_pad1two_years PURGE ) BY imp;
 
ODBC_105: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_pad1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084961
Total seconds used by the ODBC ACCESS engine were     0.086514
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_pad1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_pad < 
w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < w3.fst_dt and 
w3.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
46                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and w5.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + INTERVAL 730 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_106: Executed: on connection 2
CREATE TABLE dingyig._12_lab_pad1two_years AS select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_pad < w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < 
w3.fst_dt and w3.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and 
w5.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.886948
Total seconds used by the ODBC ACCESS engine were     3.207935
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_pad1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_pad1two_years );
 
ODBC_107: Prepared: on connection 2
SELECT 'dingyig._12_lab_pad1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_pad1two_years
 
 
ODBC_108: Executed: on connection 2
Prepared statement ODBC_107
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005409
Total SQL execution seconds were:                   0.157645
Total SQL prepare seconds were:                     0.020636
Total SQL describe seconds were:                    0.000594
Total seconds used by the ODBC ACCESS engine were     0.205469
 
MPRINT(CREATE):   QUIT;
47                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 27.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.91 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_stroke1two_years PURGE ) BY imp;
 
ODBC_109: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_stroke1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.122199
Total seconds used by the ODBC ACCESS engine were     0.123809
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_stroke1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and w2.fst_dt<=index_date_stroke + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_stroke 
< w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and w4.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and 
w5.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and w6.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and 
w7.fst_dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_110: Executed: on connection 2
CREATE TABLE dingyig._12_lab_stroke1two_years AS select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and 
w2.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
48                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_stroke < w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and 
w4.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and w5.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and 
w6.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and w7.fst_dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, 
q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.634161
Total seconds used by the ODBC ACCESS engine were     2.948828
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_stroke1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_stroke1two_years );
 
ODBC_111: Prepared: on connection 2
SELECT 'dingyig._12_lab_stroke1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_stroke1two_years
 
 
ODBC_112: Executed: on connection 2
Prepared statement ODBC_111
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004948
Total SQL execution seconds were:                   0.049197
Total SQL prepare seconds were:                     0.020093
Total SQL describe seconds were:                    0.000532
Total seconds used by the ODBC ACCESS engine were     0.094570
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 28.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.59 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina1two_years PURGE ) BY imp;
 
ODBC_113: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.164537
Total seconds used by the ODBC ACCESS engine were     0.166134
 
49                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_unsta_angina1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_unsta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and w3.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and w5.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt 
and w6.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 
on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and w7.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by 
q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_114: Executed: on connection 2
CREATE TABLE dingyig._12_lab_unsta_angina1two_years AS select q.patid, q.index_date_unsta_angina , count(distinct case when 
w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as 
hdlc_cnt , count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not 
null then w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , 
count(distinct case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null 
then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_unsta_angina < w2.fst_dt and w2.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and w4.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 
on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt and w6.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.713223
Total seconds used by the ODBC ACCESS engine were     3.012311
 
50                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_unsta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab_unsta_angina1two_years );
 
ODBC_115: Prepared: on connection 2
SELECT 'dingyig._12_lab_unsta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_unsta_angina1two_years
 
 
ODBC_116: Executed: on connection 2
Prepared statement ODBC_115
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003734
Total SQL execution seconds were:                   0.052088
Total SQL prepare seconds were:                     0.021469
Total SQL describe seconds were:                    0.000954
Total seconds used by the ODBC ACCESS engine were     0.097297
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 29.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.69 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_sta_angina1two_years PURGE ) BY imp;
 
ODBC_117: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_sta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.092897
Total seconds used by the ODBC ACCESS engine were     0.095601
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_sta_angina1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_sta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and w3.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and w5.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
51                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and 
w6.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and w7.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, 
q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_118: Executed: on connection 2
CREATE TABLE dingyig._12_lab_sta_angina1two_years AS select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_sta_angina < w2.fst_dt and w2.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and w4.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and w6.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.844310
Total seconds used by the ODBC ACCESS engine were     3.113845
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_sta_angina1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_sta_angina1two_years );
 
ODBC_119: Prepared: on connection 2
SELECT 'dingyig._12_lab_sta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_sta_angina1two_years
 
 
ODBC_120: Executed: on connection 2
Prepared statement ODBC_119
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004467
Total SQL execution seconds were:                   0.053306
Total SQL prepare seconds were:                     0.019143
Total SQL describe seconds were:                    0.000875
Total seconds used by the ODBC ACCESS engine were     0.096248
 
MPRINT(CREATE):   QUIT;
52                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 30.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.72 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_tia1two_years PURGE ) BY imp;
 
ODBC_121: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_tia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077581
Total seconds used by the ODBC ACCESS engine were     0.079140
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_tia1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_tia < 
w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < w3.fst_dt and 
w3.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and w5.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + INTERVAL 730 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_122: Executed: on connection 2
CREATE TABLE dingyig._12_lab_tia1two_years AS select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_tia < w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
53                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < 
w3.fst_dt and w3.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and 
w5.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.705721
Total seconds used by the ODBC ACCESS engine were     3.010726
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_tia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_tia1two_years );
 
ODBC_123: Prepared: on connection 2
SELECT 'dingyig._12_lab_tia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_tia1two_years
 
 
ODBC_124: Executed: on connection 2
Prepared statement ODBC_123
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004552
Total SQL execution seconds were:                   0.055074
Total SQL prepare seconds were:                     0.018149
Total SQL describe seconds were:                    0.000580
Total seconds used by the ODBC ACCESS engine were     0.098094
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 31.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.62 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_other1two_years PURGE ) BY imp;
 
ODBC_125: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_other1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.238759
Total seconds used by the ODBC ACCESS engine were     0.240523
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_other1two_years AS
54                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):   select q.patid, q.index_date_other , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and w2.fst_dt<=index_date_other + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_other < 
w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_other < w5.fst_dt and 
w5.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_other < w7.fst_dt and 
w7.fst_dt<=index_date_other + INTERVAL 730 DAYS group by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_126: Executed: on connection 2
CREATE TABLE dingyig._12_lab_other1two_years AS select q.patid, q.index_date_other , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and 
w2.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_other < w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other 
+ INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and 
q.index_date_other < w5.fst_dt and w5.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and 
q.index_date_other < w7.fst_dt and w7.fst_dt<=index_date_other + INTERVAL 730 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.640005
Total seconds used by the ODBC ACCESS engine were     2.939227
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_other1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_other1two_years );
 
55                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_127: Prepared: on connection 2
SELECT 'dingyig._12_lab_other1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_other1two_years
 
 
ODBC_128: Executed: on connection 2
Prepared statement ODBC_127
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004622
Total SQL execution seconds were:                   0.052905
Total SQL prepare seconds were:                     0.020737
Total SQL describe seconds were:                    0.000490
Total seconds used by the ODBC ACCESS engine were     0.098968
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 32.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.69 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_revasc1two_years PURGE ) BY imp;
 
ODBC_129: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_revasc1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.072939
Total seconds used by the ODBC ACCESS engine were     0.074459
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_revasc1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and w2.fst_dt<=index_date_revasc + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_revasc 
< w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and w4.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and 
w5.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and w6.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
56                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and 
w7.fst_dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_130: Executed: on connection 2
CREATE TABLE dingyig._12_lab_revasc1two_years AS select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and 
w2.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_revasc < w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and 
w4.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and w5.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and 
w6.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and w7.fst_dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, 
q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.718032
Total seconds used by the ODBC ACCESS engine were     6.055290
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_revasc1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_revasc1two_years );
 
ODBC_131: Prepared: on connection 2
SELECT 'dingyig._12_lab_revasc1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_revasc1two_years
 
 
ODBC_132: Executed: on connection 2
Prepared statement ODBC_131
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005188
Total SQL execution seconds were:                  79.861627
Total SQL prepare seconds were:                     0.020305
Total SQL describe seconds were:                    0.000491
Total seconds used by the ODBC ACCESS engine were    79.912120
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 33.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:26.46
      cpu time            0.97 seconds
57                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_cvd1two_years PURGE ) BY imp;
 
ODBC_133: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_cvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.593798
Total seconds used by the ODBC ACCESS engine were     0.595437
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_cvd1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_cvd < 
w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < w3.fst_dt and 
w3.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and w5.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + INTERVAL 730 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_134: Executed: on connection 2
CREATE TABLE dingyig._12_lab_cvd1two_years AS select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_cvd < w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < 
w3.fst_dt and w3.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join 
58                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and 
w5.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.686151
Total seconds used by the ODBC ACCESS engine were     6.002178
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_cvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_cvd1two_years );
 
ODBC_135: Prepared: on connection 2
SELECT 'dingyig._12_lab_cvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_cvd1two_years
 
 
ODBC_136: Executed: on connection 2
Prepared statement ODBC_135
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003974
Total SQL execution seconds were:                   0.049437
Total SQL prepare seconds were:                     0.019771
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.094239
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 34.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.13 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_anginatia1two_years PURGE ) BY imp;
 
ODBC_137: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_anginatia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076784
Total seconds used by the ODBC ACCESS engine were     0.078356
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_anginatia1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
59                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_anginatia < w2.fst_dt and 
w2.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_anginatia < w4.fst_dt and 
w4.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and w5.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and 
w6.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and w7.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, 
q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_138: Executed: on connection 2
CREATE TABLE dingyig._12_lab_anginatia1two_years AS select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_anginatia < w2.fst_dt and w2.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia 
+ INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and 
q.index_date_anginatia < w4.fst_dt and w4.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and 
w5.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and w6.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and 
w7.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.718399
Total seconds used by the ODBC ACCESS engine were     3.028735
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_anginatia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_anginatia1two_years );
 
ODBC_139: Prepared: on connection 2
SELECT 'dingyig._12_lab_anginatia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_anginatia1two_years
60                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_140: Executed: on connection 2
Prepared statement ODBC_139
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005783
Total SQL execution seconds were:                   0.053951
Total SQL prepare seconds were:                     0.018982
Total SQL describe seconds were:                    0.000515
Total seconds used by the ODBC ACCESS engine were     0.100018
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 35.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.63 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_noncvd1two_years PURGE ) BY imp;
 
ODBC_141: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_noncvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.769594
Total seconds used by the ODBC ACCESS engine were     0.771206
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_noncvd1two_years AS
MPRINT(LABS):   select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and w2.fst_dt<=index_date_noncvd + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_noncvd 
< w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and w4.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and 
w5.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and w6.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and 
w7.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, q.index_date_noncvd
61                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   ) BY imp;
 
ODBC_142: Executed: on connection 2
CREATE TABLE dingyig._12_lab_noncvd1two_years AS select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6a as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and 
w2.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_noncvd < w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and 
w4.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and w5.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and 
w6.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and w7.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, 
q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.723738
Total seconds used by the ODBC ACCESS engine were     3.026858
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_noncvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_noncvd1two_years );
 
ODBC_143: Prepared: on connection 2
SELECT 'dingyig._12_lab_noncvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_noncvd1two_years
 
 
ODBC_144: Executed: on connection 2
Prepared statement ODBC_143
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005421
Total SQL execution seconds were:                   0.536021
Total SQL prepare seconds were:                     0.019203
Total SQL describe seconds were:                    0.000487
Total seconds used by the ODBC ACCESS engine were     0.581554
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 36.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.80 seconds
      cpu time            0.09 seconds
      

62                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_overall2two_years PURGE ) BY imp;
 
ODBC_145: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_overall2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082183
Total seconds used by the ODBC ACCESS engine were     0.083845
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_overall2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_overall , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall 
< w3.fst_dt and w3.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall < w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and 
w5.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and 
w7.fst_dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_146: Executed: on connection 2
CREATE TABLE dingyig._12_lab_overall2two_years AS select q.patid, q.index_date_overall , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_overall < w1.fst_dt and w1.fst_dt<=index_date_overall + INTERVAL 730 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_overall < w2.fst_dt and w2.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_overall < w3.fst_dt and w3.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_overall 
< w4.fst_dt and w4.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
63                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_overall < w5.fst_dt and w5.fst_dt<=index_date_overall + INTERVAL 730 DAYS 
left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_overall < w6.fst_dt and w6.fst_dt<=index_date_overall + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_overall < w7.fst_dt and w7.fst_dt<=index_date_overall + 
INTERVAL 730 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  13.464075
Total seconds used by the ODBC ACCESS engine were    13.779727
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_overall2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_overall2two_years );
 
ODBC_147: Prepared: on connection 2
SELECT 'dingyig._12_lab_overall2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_overall2two_years
 
 
ODBC_148: Executed: on connection 2
Prepared statement ODBC_147
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005254
Total SQL execution seconds were:                   0.107436
Total SQL prepare seconds were:                     0.020379
Total SQL describe seconds were:                    0.000512
Total seconds used by the ODBC ACCESS engine were     0.154763
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 37.
NOTE: PROCEDURE SQL used (Total process time):
      real time           14.43 seconds
      cpu time            0.19 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_mi2two_years PURGE ) BY imp;
 
ODBC_149: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_mi2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.104410
Total seconds used by the ODBC ACCESS engine were     0.105982
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_mi2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , 
count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
64                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_mi < 
w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on 
q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 
730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_mi < 
w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi < w6.fst_dt and w6.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < 
w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 730 DAYS group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_150: Executed: on connection 2
CREATE TABLE dingyig._12_lab_mi2two_years AS select q.patid, q.index_date_mi , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_mi < w1.fst_dt and w1.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_mi < w2.fst_dt and w2.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_mi < 
w3.fst_dt and w3.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_mi < w4.fst_dt and w4.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_mi < w5.fst_dt and w5.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_mi 
< w6.fst_dt and w6.fst_dt<=index_date_mi + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_mi < w7.fst_dt and w7.fst_dt<=index_date_mi + INTERVAL 730 DAYS group by 
q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.484620
Total seconds used by the ODBC ACCESS engine were     5.816067
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_mi2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_mi2two_years );
 
ODBC_151: Prepared: on connection 2
SELECT 'dingyig._12_lab_mi2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_mi2two_years
 
 
ODBC_152: Executed: on connection 2
Prepared statement ODBC_151
65                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004890
Total SQL execution seconds were:                   0.062348
Total SQL prepare seconds were:                     0.019703
Total SQL describe seconds were:                    0.000535
Total seconds used by the ODBC ACCESS engine were     0.108508
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 38.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.11 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_pad2two_years PURGE ) BY imp;
 
ODBC_153: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_pad2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.097979
Total seconds used by the ODBC ACCESS engine were     0.099792
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_pad2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_pad < 
w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < w3.fst_dt and 
w3.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and w5.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + INTERVAL 730 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_154: Executed: on connection 2
CREATE TABLE dingyig._12_lab_pad2two_years AS select q.patid, q.index_date_pad , count(distinct case when w1.patid is not null then 
66                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_pad < w1.fst_dt and w1.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_pad < w2.fst_dt and w2.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_pad < 
w3.fst_dt and w3.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_pad < w4.fst_dt and w4.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_pad < w5.fst_dt and 
w5.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_pad < w6.fst_dt and w6.fst_dt<=index_date_pad + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_pad < w7.fst_dt and w7.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.614149
Total seconds used by the ODBC ACCESS engine were    10.934067
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_pad2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_pad2two_years );
 
ODBC_155: Prepared: on connection 2
SELECT 'dingyig._12_lab_pad2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_pad2two_years
 
 
ODBC_156: Executed: on connection 2
Prepared statement ODBC_155
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004674
Total SQL execution seconds were:                   0.048417
Total SQL prepare seconds were:                     0.019543
Total SQL describe seconds were:                    0.000535
Total seconds used by the ODBC ACCESS engine were     0.092698
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 39.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.54 seconds
      cpu time            0.17 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_stroke2two_years PURGE ) BY imp;
67                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_157: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_stroke2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.097808
Total seconds used by the ODBC ACCESS engine were     0.099672
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_stroke2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and w2.fst_dt<=index_date_stroke + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_stroke 
< w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and w4.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and 
w5.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and w6.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and 
w7.fst_dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_158: Executed: on connection 2
CREATE TABLE dingyig._12_lab_stroke2two_years AS select q.patid, q.index_date_stroke , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_stroke < w1.fst_dt and w1.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_stroke < w2.fst_dt and 
w2.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_stroke < w3.fst_dt and w3.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_stroke < w4.fst_dt and 
w4.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_stroke < w5.fst_dt and w5.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_stroke < w6.fst_dt and 
w6.fst_dt<=index_date_stroke + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
68                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w7.patid and q.index_date_stroke < w7.fst_dt and w7.fst_dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, 
q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  13.563632
Total seconds used by the ODBC ACCESS engine were    13.899484
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_stroke2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_stroke2two_years );
 
ODBC_159: Prepared: on connection 2
SELECT 'dingyig._12_lab_stroke2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_stroke2two_years
 
 
ODBC_160: Executed: on connection 2
Prepared statement ODBC_159
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004823
Total SQL execution seconds were:                   0.060134
Total SQL prepare seconds were:                     0.020418
Total SQL describe seconds were:                    0.000507
Total seconds used by the ODBC ACCESS engine were     0.105497
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 40.
NOTE: PROCEDURE SQL used (Total process time):
      real time           14.52 seconds
      cpu time            0.18 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina2two_years PURGE ) BY imp;
 
ODBC_161: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_unsta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078450
Total seconds used by the ODBC ACCESS engine were     0.080045
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_unsta_angina2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_unsta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_unsta_angina < w2.fst_dt and 
69                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and w3.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 
on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and w5.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt 
and w6.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 
on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and w7.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by 
q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_162: Executed: on connection 2
CREATE TABLE dingyig._12_lab_unsta_angina2two_years AS select q.patid, q.index_date_unsta_angina , count(distinct case when 
w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as 
hdlc_cnt , count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not 
null then w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , 
count(distinct case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null 
then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_unsta_angina < w1.fst_dt and w1.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_unsta_angina < w2.fst_dt and w2.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_unsta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_unsta_angina < w4.fst_dt and w4.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_unsta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 
on q.patid=w6.patid and q.index_date_unsta_angina < w6.fst_dt and w6.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_unsta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.805859
Total seconds used by the ODBC ACCESS engine were     3.119772
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_unsta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab_unsta_angina2two_years );
 
ODBC_163: Prepared: on connection 2
SELECT 'dingyig._12_lab_unsta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_unsta_angina2two_years
 
 
ODBC_164: Executed: on connection 2
Prepared statement ODBC_163
 
 
70                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005299
Total SQL execution seconds were:                   0.139453
Total SQL prepare seconds were:                     0.019782
Total SQL describe seconds were:                    0.000548
Total seconds used by the ODBC ACCESS engine were     0.186758
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 41.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.47 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_sta_angina2two_years PURGE ) BY imp;
 
ODBC_165: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_sta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082456
Total seconds used by the ODBC ACCESS engine were     0.084041
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_sta_angina2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_sta_angina < w2.fst_dt and 
w2.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and w3.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and 
w4.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and w5.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and 
w6.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and w7.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, 
q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_166: Executed: on connection 2
CREATE TABLE dingyig._12_lab_sta_angina2two_years AS select q.patid, q.index_date_sta_angina , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
71                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_sta_angina < w1.fst_dt and w1.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_sta_angina < w2.fst_dt and w2.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_sta_angina < w3.fst_dt and 
w3.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_sta_angina < w4.fst_dt and w4.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_sta_angina < w5.fst_dt and 
w5.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_sta_angina < w6.fst_dt and w6.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_sta_angina < w7.fst_dt and 
w7.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.793009
Total seconds used by the ODBC ACCESS engine were     3.093885
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_sta_angina2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_sta_angina2two_years );
 
ODBC_167: Prepared: on connection 2
SELECT 'dingyig._12_lab_sta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_sta_angina2two_years
 
 
ODBC_168: Executed: on connection 2
Prepared statement ODBC_167
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004568
Total SQL execution seconds were:                   0.050191
Total SQL prepare seconds were:                     0.020117
Total SQL describe seconds were:                    0.000557
Total seconds used by the ODBC ACCESS engine were     0.095927
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 42.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.70 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_tia2two_years PURGE ) BY imp;
72                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_169: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_tia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078442
Total seconds used by the ODBC ACCESS engine were     0.080050
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_tia2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_tia < 
w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < w3.fst_dt and 
w3.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and w5.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + INTERVAL 730 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_170: Executed: on connection 2
CREATE TABLE dingyig._12_lab_tia2two_years AS select q.patid, q.index_date_tia , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_tia < w1.fst_dt and w1.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_tia < w2.fst_dt and w2.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_tia < 
w3.fst_dt and w3.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_tia < w4.fst_dt and w4.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_tia < w5.fst_dt and 
w5.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_tia < w6.fst_dt and w6.fst_dt<=index_date_tia + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_tia < w7.fst_dt and w7.fst_dt<=index_date_tia + 
73                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

INTERVAL 730 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.899548
Total seconds used by the ODBC ACCESS engine were     3.229583
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_tia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_tia2two_years );
 
ODBC_171: Prepared: on connection 2
SELECT 'dingyig._12_lab_tia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_tia2two_years
 
 
ODBC_172: Executed: on connection 2
Prepared statement ODBC_171
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004067
Total SQL execution seconds were:                   0.048327
Total SQL prepare seconds were:                     0.019861
Total SQL describe seconds were:                    0.000514
Total seconds used by the ODBC ACCESS engine were     0.091618
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 43.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.82 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_other2two_years PURGE ) BY imp;
 
ODBC_173: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_other2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075747
Total seconds used by the ODBC ACCESS engine were     0.077310
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_other2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_other , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and w2.fst_dt<=index_date_other + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
74                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_other < 
w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_other < w5.fst_dt and 
w5.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_other < w7.fst_dt and 
w7.fst_dt<=index_date_other + INTERVAL 730 DAYS group by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_174: Executed: on connection 2
CREATE TABLE dingyig._12_lab_other2two_years AS select q.patid, q.index_date_other , count(distinct case when w1.patid is not null 
then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_other < w1.fst_dt and w1.fst_dt<=index_date_other + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_other < w2.fst_dt and 
w2.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_other < w3.fst_dt and w3.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_other < w4.fst_dt and w4.fst_dt<=index_date_other 
+ INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and 
q.index_date_other < w5.fst_dt and w5.fst_dt<=index_date_other + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_other < w6.fst_dt and w6.fst_dt<=index_date_other + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and 
q.index_date_other < w7.fst_dt and w7.fst_dt<=index_date_other + INTERVAL 730 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.810302
Total seconds used by the ODBC ACCESS engine were     3.097634
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_other2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_other2two_years );
 
ODBC_175: Prepared: on connection 2
SELECT 'dingyig._12_lab_other2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_other2two_years
 
 
ODBC_176: Executed: on connection 2
Prepared statement ODBC_175
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006366
Total SQL execution seconds were:                   0.062736
75                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL prepare seconds were:                     0.026672
Total SQL describe seconds were:                    0.000492
Total seconds used by the ODBC ACCESS engine were     0.128927
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 44.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.72 seconds
      cpu time            0.07 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_revasc2two_years PURGE ) BY imp;
 
ODBC_177: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_revasc2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080876
Total seconds used by the ODBC ACCESS engine were     0.082481
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_revasc2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and w2.fst_dt<=index_date_revasc + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_revasc 
< w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and w4.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and 
w5.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and w6.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and 
w7.fst_dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_178: Executed: on connection 2
CREATE TABLE dingyig._12_lab_revasc2two_years AS select q.patid, q.index_date_revasc , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
76                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_revasc < w1.fst_dt and w1.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_revasc < w2.fst_dt and 
w2.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_revasc < w3.fst_dt and w3.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_revasc < w4.fst_dt and 
w4.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_revasc < w5.fst_dt and w5.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_revasc < w6.fst_dt and 
w6.fst_dt<=index_date_revasc + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_revasc < w7.fst_dt and w7.fst_dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, 
q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.753579
Total seconds used by the ODBC ACCESS engine were     7.073009
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_revasc2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_revasc2two_years );
 
ODBC_179: Prepared: on connection 2
SELECT 'dingyig._12_lab_revasc2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_revasc2two_years
 
 
ODBC_180: Executed: on connection 2
Prepared statement ODBC_179
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004639
Total SQL execution seconds were:                   0.051375
Total SQL prepare seconds were:                     0.020271
Total SQL describe seconds were:                    0.000515
Total seconds used by the ODBC ACCESS engine were     0.098816
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 45.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.67 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_cvd2two_years PURGE ) BY imp;
 
ODBC_181: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_cvd2two_years PURGE
 
77                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081629
Total seconds used by the ODBC ACCESS engine were     0.083285
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_cvd2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as ldlc_cnt 
, count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is not null 
then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , count(distinct 
case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null then w6.rslt_nbr 
end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b 
as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_cvd < 
w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < w3.fst_dt and 
w3.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on 
q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and w5.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and 
q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + INTERVAL 730 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_182: Executed: on connection 2
CREATE TABLE dingyig._12_lab_cvd2two_years AS select q.patid, q.index_date_cvd , count(distinct case when w1.patid is not null then 
w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct 
case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr 
end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when 
w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as 
cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on 
q.patid=w1.patid and q.index_date_cvd < w1.fst_dt and w1.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_cvd < w2.fst_dt and w2.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_cvd < 
w3.fst_dt and w3.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_cvd < w4.fst_dt and w4.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join 
(select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 
2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_cvd < w5.fst_dt and 
w5.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_cvd < w6.fst_dt and w6.fst_dt<=index_date_cvd + INTERVAL 730 DAYS left join (select patid, grp, 
fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 
and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_cvd < w7.fst_dt and w7.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
78                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  13.703925
Total seconds used by the ODBC ACCESS engine were    14.166115
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_cvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_cvd2two_years );
 
ODBC_183: Prepared: on connection 2
SELECT 'dingyig._12_lab_cvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_cvd2two_years
 
 
ODBC_184: Executed: on connection 2
Prepared statement ODBC_183
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004991
Total SQL execution seconds were:                   0.066920
Total SQL prepare seconds were:                     0.019942
Total SQL describe seconds were:                    0.000522
Total seconds used by the ODBC ACCESS engine were     0.113930
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 46.
NOTE: PROCEDURE SQL used (Total process time):
      real time           14.78 seconds
      cpu time            0.20 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_anginatia2two_years PURGE ) BY imp;
 
ODBC_185: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_anginatia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.727441
Total seconds used by the ODBC ACCESS engine were     0.729013
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_anginatia2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_anginatia < w2.fst_dt and 
w2.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_anginatia < w4.fst_dt and 
79                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w4.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and w5.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and 
w6.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and w7.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, 
q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_186: Executed: on connection 2
CREATE TABLE dingyig._12_lab_anginatia2two_years AS select q.patid, q.index_date_anginatia , count(distinct case when w1.patid is 
not null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_anginatia < w1.fst_dt and w1.fst_dt<=index_date_anginatia + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and 
q.index_date_anginatia < w2.fst_dt and w2.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_anginatia < w3.fst_dt and w3.fst_dt<=index_date_anginatia 
+ INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 
and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and 
q.index_date_anginatia < w4.fst_dt and w4.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, 
rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_anginatia < w5.fst_dt and 
w5.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_anginatia < w6.fst_dt and w6.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select 
patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_anginatia < w7.fst_dt and 
w7.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.191170
Total seconds used by the ODBC ACCESS engine were     3.511745
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_anginatia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_anginatia2two_years );
 
ODBC_187: Prepared: on connection 2
SELECT 'dingyig._12_lab_anginatia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_anginatia2two_years
 
 
ODBC_188: Executed: on connection 2
Prepared statement ODBC_187
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005518
Total SQL execution seconds were:                   0.093239
Total SQL prepare seconds were:                     0.019398
Total SQL describe seconds were:                    0.000547
80                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.139438
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 47.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.47 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab_noncvd2two_years PURGE ) BY imp;
 
ODBC_189: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab_noncvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080815
Total seconds used by the ODBC ACCESS engine were     0.082355
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab_noncvd2two_years AS
MPRINT(LABS):   select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not null then w1.rslt_nbr end) as 
ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , count(distinct case when w3.patid is 
not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then w4.rslt_nbr end) as tg_cnt , 
count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct case when w6.patid is not null 
then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then w7.rslt_nbr end) as cprot_cnt from 
dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 
2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="ldlc") as w1 on q.patid=w1.patid and 
q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and w2.fst_dt<=index_date_noncvd + INTERVAL 730 
DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on q.patid=w3.patid and q.index_date_noncvd 
< w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and w4.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left 
join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and 
w5.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on 
q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and w6.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="cprot") as w7 on q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and 
w7.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_190: Executed: on connection 2
CREATE TABLE dingyig._12_lab_noncvd2two_years AS select q.patid, q.index_date_noncvd , count(distinct case when w1.patid is not 
null then w1.rslt_nbr end) as ldlc_cnt , count(distinct case when w2.patid is not null then w2.rslt_nbr end) as hdlc_cnt , 
count(distinct case when w3.patid is not null then w3.rslt_nbr end) as tc_cnt , count(distinct case when w4.patid is not null then 
w4.rslt_nbr end) as tg_cnt , count(distinct case when w5.patid is not null then w5.rslt_nbr end) as lpa_mg_cnt , count(distinct 
case when w6.patid is not null then w6.rslt_nbr end) as lpa_mol_cnt , count(distinct case when w7.patid is not null then 
w7.rslt_nbr end) as cprot_cnt from dingyig._01_cohort_6b as q left join (select patid, grp, fst_dt, rslt_nbr from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and 
grp="ldlc") as w1 on q.patid=w1.patid and q.index_date_noncvd < w1.fst_dt and w1.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left 
81                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) 
<= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="hdlc") as w2 on q.patid=w2.patid and q.index_date_noncvd < w2.fst_dt and 
w2.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="tc") as w3 on 
q.patid=w3.patid and q.index_date_noncvd < w3.fst_dt and w3.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="tg") as w4 on q.patid=w4.patid and q.index_date_noncvd < w4.fst_dt and 
w4.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="lpa_mg") as w5 on 
q.patid=w5.patid and q.index_date_noncvd < w5.fst_dt and w5.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, 
grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999 and grp="lpa_mol") as w6 on q.patid=w6.patid and q.index_date_noncvd < w6.fst_dt and 
w6.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select patid, grp, fst_dt, rslt_nbr from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999 and grp="cprot") as w7 on 
q.patid=w7.patid and q.index_date_noncvd < w7.fst_dt and w7.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, 
q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   2.899622
Total seconds used by the ODBC ACCESS engine were     3.210416
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab_noncvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab_noncvd2two_years );
 
ODBC_191: Prepared: on connection 2
SELECT 'dingyig._12_lab_noncvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab_noncvd2two_years
 
 
ODBC_192: Executed: on connection 2
Prepared statement ODBC_191
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004764
Total SQL execution seconds were:                   0.257370
Total SQL prepare seconds were:                     0.020194
Total SQL describe seconds were:                    0.000541
Total seconds used by the ODBC ACCESS engine were     0.302773
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 48.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.03 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
31         /* %labs(all, q.eligend); */
32         
33         
34         * lab data one year post index;
35         options mprint;
36         %macro labs(year, years);
37         /*labs at index*/
38         	%let cohorts=a*b;
39         	%do z=1 %to 2;
40         	%let ct = %scan(&cohorts., &z., *);
82                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

41         	%let groups=overall*mi*pad*stroke*unsta_angina*sta_angina*tia*other*revasc*cvd*anginatia*noncvd;
42         		%do i=1 %to 12;
43         			%let ad = %scan(&groups., &i., *);
44         	%create(_12_lab1_&ad.&z.&year.)
45         			select distinct q.*
46         			/* merge comorbidities*/
47         			%do r=1 %to 7;
48         				%let lab = %scan(ldlc*hdlc*tc*tg*lpa_mg*lpa_mol*cprot, &r., *);
49         				, case when w&r..patid is not null then w&r..fst_dt end as &lab._dt
50         				, case when w&r..patid is not null then w&r..rslt_nbr end as &lab.
51         
52         			%end;
53         		from dingyig._01_cohort_6&ct. q
54         			%do t=1 %to 7;
55         				%let lab = %scan(ldlc*hdlc*tc*tg*lpa_mg*lpa_mol*cprot, &t., *);
56         				left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr
57         							from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn
58         								from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_&ad.)) as gap
59         										from dingyig._01_cohort_6&ct. as a inner join (select * from dingyig.ldlc_04_lab2
60         																			where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr <
60       ! 9999) as b
61         										on a.patid=b.patid and b.grp="&lab." and a.index_date_&ad. < b.fst_dt and b.fst_dt<=&years. ) as e						
62         								) as z
63         						
64         							where z.rn=1
65         							group by z.patid, z.grp, z.fst_dt) as w&t. on q.patid=w&t..patid and q.grp=w&t..grp
66         			%end;
67         	%create(_12_lab1_&ad.&z.&year.);
68         	%end;
69         	%end;
70         %mend;
71         
72         %labs(one_year, index_date_&ad. + INTERVAL 365 DAYS);
WARNING: Apparent symbolic reference AD not resolved.
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall1one_year PURGE ) BY imp;
 
ODBC_193: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083757
Total seconds used by the ODBC ACCESS engine were     0.085410
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
83                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_194: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
84                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.548396
Total seconds used by the ODBC ACCESS engine were     4.368290
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall1one_year );
 
ODBC_195: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall1one_year
 
 
ODBC_196: Executed: on connection 2
Prepared statement ODBC_195
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005241
Total SQL execution seconds were:                   0.055051
Total SQL prepare seconds were:                     0.017167
Total SQL describe seconds were:                    0.000524
Total seconds used by the ODBC ACCESS engine were     0.100962
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 49.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.97 seconds
      cpu time            0.09 seconds
      

85                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi1one_year PURGE ) BY imp;
 
ODBC_197: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082676
Total seconds used by the ODBC ACCESS engine were     0.084267
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
86                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_198: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.677266
Total seconds used by the ODBC ACCESS engine were     4.425261
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi1one_year );
87                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_199: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi1one_year
 
 
ODBC_200: Executed: on connection 2
Prepared statement ODBC_199
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006156
Total SQL execution seconds were:                   0.083701
Total SQL prepare seconds were:                     0.020811
Total SQL describe seconds were:                    0.000527
Total seconds used by the ODBC ACCESS engine were     0.134274
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 50.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.72 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad1one_year PURGE ) BY imp;
 
ODBC_201: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083754
Total seconds used by the ODBC ACCESS engine were     0.085570
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap 
88                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_202: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
89                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad 
< b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.488021
Total seconds used by the ODBC ACCESS engine were     4.266448
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad1one_year );
 
ODBC_203: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad1one_year
 
 
ODBC_204: Executed: on connection 2
Prepared statement ODBC_203
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005295
Total SQL execution seconds were:                   0.061757
Total SQL prepare seconds were:                     0.020365
Total SQL describe seconds were:                    0.000859
Total seconds used by the ODBC ACCESS engine were     0.110629
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 51.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.90 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke1one_year PURGE ) BY imp;
 
ODBC_205: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099348
90                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.101076
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_206: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
91                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.637874
Total seconds used by the ODBC ACCESS engine were     4.374596
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke1one_year );
 
ODBC_207: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke1one_year
 
 
ODBC_208: Executed: on connection 2
Prepared statement ODBC_207
 
 
Summary Statistics for ODBC are:
92                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total row fetch seconds were:                       0.004856
Total SQL execution seconds were:                   0.054315
Total SQL prepare seconds were:                     0.019695
Total SQL describe seconds were:                    0.000536
Total seconds used by the ODBC ACCESS engine were     0.098853
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 52.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.05 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1one_year PURGE ) BY imp;
 
ODBC_209: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084008
Total seconds used by the ODBC ACCESS engine were     0.085679
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select 
93                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_210: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
94                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on 
q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.442095
Total seconds used by the ODBC ACCESS engine were     4.127488
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_unsta_angina1one_year );
 
ODBC_211: Prepared: on connection 2
SELECT 'dingyig._12_lab1_unsta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina1one_year
 
 
ODBC_212: Executed: on connection 2
Prepared statement ODBC_211
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004254
Total SQL execution seconds were:                   0.057238
Total SQL prepare seconds were:                     0.022371
Total SQL describe seconds were:                    0.000539
Total seconds used by the ODBC ACCESS engine were     0.103204
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 53.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.74 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1one_year PURGE ) BY imp;
 
ODBC_213: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081762
Total seconds used by the ODBC ACCESS engine were     0.083375
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
95                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_214: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as 
96                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.691253
Total seconds used by the ODBC ACCESS engine were     4.328121
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_sta_angina1one_year );
 
ODBC_215: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina1one_year
 
 
ODBC_216: Executed: on connection 2
Prepared statement ODBC_215
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004521
Total SQL execution seconds were:                   0.052003
Total SQL prepare seconds were:                     0.020777
97                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL describe seconds were:                    0.000528
Total seconds used by the ODBC ACCESS engine were     0.097943
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 54.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.93 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia1one_year PURGE ) BY imp;
 
ODBC_217: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083785
Total seconds used by the ODBC ACCESS engine were     0.086392
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) 
98                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_218: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia 
< b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
99                                                         The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.525922
Total seconds used by the ODBC ACCESS engine were     4.255146
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia1one_year );
 
ODBC_219: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia1one_year
 
 
ODBC_220: Executed: on connection 2
Prepared statement ODBC_219
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004970
Total SQL execution seconds were:                   0.050362
Total SQL prepare seconds were:                     0.020178
Total SQL describe seconds were:                    0.000539
Total seconds used by the ODBC ACCESS engine were     0.095514
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 55.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.86 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other1one_year PURGE ) BY imp;
 
ODBC_221: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.122606
Total seconds used by the ODBC ACCESS engine were     0.124125
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
100                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and 
b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_222: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other 
< b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 
on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
101                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.715203
Total seconds used by the ODBC ACCESS engine were     4.634774
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other1one_year );
 
ODBC_223: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other1one_year
 
 
ODBC_224: Executed: on connection 2
Prepared statement ODBC_223
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006341
Total SQL execution seconds were:                   0.213989
Total SQL prepare seconds were:                     0.020427
Total SQL describe seconds were:                    0.000548
Total seconds used by the ODBC ACCESS engine were     0.262557
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 56.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.44 seconds
      cpu time            0.10 seconds
      

102                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc1one_year PURGE ) BY imp;
 
ODBC_225: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.100135
Total seconds used by the ODBC ACCESS engine were     0.101778
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
103                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_226: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.831219
Total seconds used by the ODBC ACCESS engine were     4.500154
 
104                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc1one_year );
 
ODBC_227: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc1one_year
 
 
ODBC_228: Executed: on connection 2
Prepared statement ODBC_227
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004821
Total SQL execution seconds were:                   0.278595
Total SQL prepare seconds were:                     0.021341
Total SQL describe seconds were:                    0.000583
Total seconds used by the ODBC ACCESS engine were     0.324506
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 57.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.34 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd1one_year PURGE ) BY imp;
 
ODBC_229: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087575
Total seconds used by the ODBC ACCESS engine were     0.089130
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
105                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_230: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as 
106                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd 
< b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.676068
Total seconds used by the ODBC ACCESS engine were     4.301911
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd1one_year );
 
ODBC_231: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd1one_year
 
 
ODBC_232: Executed: on connection 2
Prepared statement ODBC_231
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004216
Total SQL execution seconds were:                   0.050969
Total SQL prepare seconds were:                     0.020377
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.093944
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 58.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.90 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1one_year PURGE ) BY imp;
 
ODBC_233: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1one_year PURGE
 
 
107                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083915
Total seconds used by the ODBC ACCESS engine were     0.085477
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_234: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
108                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.454831
Total seconds used by the ODBC ACCESS engine were     4.179521
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia1one_year );
 
ODBC_235: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia1one_year
 
 
ODBC_236: Executed: on connection 2
109                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_235
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004783
Total SQL execution seconds were:                   0.053469
Total SQL prepare seconds were:                     0.019316
Total SQL describe seconds were:                    0.000835
Total seconds used by the ODBC ACCESS engine were     0.098890
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 59.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.78 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1one_year PURGE ) BY imp;
 
ODBC_237: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085421
Total seconds used by the ODBC ACCESS engine were     0.087094
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd1one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
110                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_238: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd1one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
111                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.619637
Total seconds used by the ODBC ACCESS engine were     4.263163
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd1one_year );
 
ODBC_239: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd1one_year
 
 
ODBC_240: Executed: on connection 2
Prepared statement ODBC_239
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004502
Total SQL execution seconds were:                   0.056497
Total SQL prepare seconds were:                     0.021046
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.101408
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 60.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.87 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall2one_year PURGE ) BY imp;
 
ODBC_241: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086414
Total seconds used by the ODBC ACCESS engine were     0.090009
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
112                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_242: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
113                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.497591
Total seconds used by the ODBC ACCESS engine were     4.139023
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall2one_year );
 
ODBC_243: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall2one_year
 
 
ODBC_244: Executed: on connection 2
Prepared statement ODBC_243
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004991
Total SQL execution seconds were:                   0.413918
Total SQL prepare seconds were:                     0.020476
Total SQL describe seconds were:                    0.000530
114                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.459209
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 61.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.11 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi2one_year PURGE ) BY imp;
 
ODBC_245: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099144
Total seconds used by the ODBC ACCESS engine were     0.101027
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
115                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_246: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
116                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.825718
Total seconds used by the ODBC ACCESS engine were     4.608476
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi2one_year );
 
ODBC_247: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi2one_year
 
 
ODBC_248: Executed: on connection 2
Prepared statement ODBC_247
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005696
Total SQL execution seconds were:                   0.267861
Total SQL prepare seconds were:                     0.022992
Total SQL describe seconds were:                    0.000783
Total seconds used by the ODBC ACCESS engine were     0.319397
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 62.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.45 seconds
      cpu time            0.15 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad2one_year PURGE ) BY imp;
 
ODBC_249: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.102755
Total seconds used by the ODBC ACCESS engine were     0.105700
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
117                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_250: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
118                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad 
< b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.527630
Total seconds used by the ODBC ACCESS engine were     4.257090
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad2one_year );
 
ODBC_251: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad2one_year
 
 
ODBC_252: Executed: on connection 2
Prepared statement ODBC_251
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005251
Total SQL execution seconds were:                   0.052240
Total SQL prepare seconds were:                     0.021274
Total SQL describe seconds were:                    0.000747
Total seconds used by the ODBC ACCESS engine were     0.101318
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 63.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.88 seconds
      cpu time            0.15 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
119                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke2one_year PURGE ) BY imp;
 
ODBC_253: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080619
Total seconds used by the ODBC ACCESS engine were     0.082362
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
120                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   ) BY imp;
 
ODBC_254: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.868880
Total seconds used by the ODBC ACCESS engine were     4.617435
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke2one_year );
 
121                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_255: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke2one_year
 
 
ODBC_256: Executed: on connection 2
Prepared statement ODBC_255
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004740
Total SQL execution seconds were:                   0.068739
Total SQL prepare seconds were:                     0.022532
Total SQL describe seconds were:                    0.000536
Total seconds used by the ODBC ACCESS engine were     0.117349
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 64.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.27 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2one_year PURGE ) BY imp;
 
ODBC_257: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086460
Total seconds used by the ODBC ACCESS engine were     0.088200
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
122                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_258: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and 
123                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on 
q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.081346
Total seconds used by the ODBC ACCESS engine were     4.811678
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_unsta_angina2one_year );
 
ODBC_259: Prepared: on connection 2
SELECT 'dingyig._12_lab1_unsta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina2one_year
 
 
ODBC_260: Executed: on connection 2
Prepared statement ODBC_259
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005051
Total SQL execution seconds were:                   0.063518
Total SQL prepare seconds were:                     0.022821
Total SQL describe seconds were:                    0.000535
Total seconds used by the ODBC ACCESS engine were     0.115330
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 65.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.43 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2one_year PURGE ) BY imp;
 
ODBC_261: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2one_year PURGE
124                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088934
Total seconds used by the ODBC ACCESS engine were     0.091532
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_262: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
125                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  68.786831
Total seconds used by the ODBC ACCESS engine were    69.395759
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_sta_angina2one_year );
 
ODBC_263: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina2one_year
 
126                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_264: Executed: on connection 2
Prepared statement ODBC_263
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004337
Total SQL execution seconds were:                   0.125500
Total SQL prepare seconds were:                     0.020978
Total SQL describe seconds were:                    0.000507
Total seconds used by the ODBC ACCESS engine were     0.169373
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 66.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:10.07
      cpu time            0.61 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia2one_year PURGE ) BY imp;
 
ODBC_265: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085738
Total seconds used by the ODBC ACCESS engine were     0.087824
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
127                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_266: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia 
< b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
128                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.887229
Total seconds used by the ODBC ACCESS engine were     8.623767
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia2one_year );
 
ODBC_267: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia2one_year
 
 
ODBC_268: Executed: on connection 2
Prepared statement ODBC_267
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005308
Total SQL execution seconds were:                   0.094769
Total SQL prepare seconds were:                     0.022728
Total SQL describe seconds were:                    0.000528
Total seconds used by the ODBC ACCESS engine were     0.144292
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 67.
NOTE: PROCEDURE SQL used (Total process time):
      real time           9.27 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other2one_year PURGE ) BY imp;
 
ODBC_269: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079432
Total seconds used by the ODBC ACCESS engine were     0.081000
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
129                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and 
b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_270: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * 
130                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other 
< b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 
on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.520540
Total seconds used by the ODBC ACCESS engine were     4.137446
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other2one_year );
 
ODBC_271: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other2one_year
 
 
ODBC_272: Executed: on connection 2
Prepared statement ODBC_271
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004255
Total SQL execution seconds were:                   0.050643
Total SQL prepare seconds were:                     0.020244
Total SQL describe seconds were:                    0.000523
131                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.093962
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 68.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.73 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc2one_year PURGE ) BY imp;
 
ODBC_273: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099654
Total seconds used by the ODBC ACCESS engine were     0.101400
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
132                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_274: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
133                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.776646
Total seconds used by the ODBC ACCESS engine were     4.387793
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc2one_year );
 
ODBC_275: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc2one_year
 
 
ODBC_276: Executed: on connection 2
Prepared statement ODBC_275
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004198
Total SQL execution seconds were:                   0.047358
Total SQL prepare seconds were:                     0.019750
Total SQL describe seconds were:                    0.000556
Total seconds used by the ODBC ACCESS engine were     0.089380
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 69.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.65 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd2one_year PURGE ) BY imp;
 
ODBC_277: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081477
Total seconds used by the ODBC ACCESS engine were     0.083094
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
134                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_278: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
135                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd 
< b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 
365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.608754
Total seconds used by the ODBC ACCESS engine were     4.314503
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd2one_year );
 
ODBC_279: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd2one_year
 
 
ODBC_280: Executed: on connection 2
Prepared statement ODBC_279
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004727
Total SQL execution seconds were:                   0.049306
Total SQL prepare seconds were:                     0.019813
Total SQL describe seconds were:                    0.000554
Total seconds used by the ODBC ACCESS engine were     0.093748
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 70.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.91 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
136                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2one_year PURGE ) BY imp;
 
ODBC_281: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083900
Total seconds used by the ODBC ACCESS engine were     0.085593
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
137                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_282: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 365 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.699812
Total seconds used by the ODBC ACCESS engine were     4.409121
138                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia2one_year );
 
ODBC_283: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia2one_year
 
 
ODBC_284: Executed: on connection 2
Prepared statement ODBC_283
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006013
Total SQL execution seconds were:                   0.065050
Total SQL prepare seconds were:                     0.026324
Total SQL describe seconds were:                    0.000531
Total seconds used by the ODBC ACCESS engine were     0.134973
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 71.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.05 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2one_year PURGE ) BY imp;
 
ODBC_285: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079636
Total seconds used by the ODBC ACCESS engine were     0.081259
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd2one_year AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and 
139                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + 
INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_286: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd2one_year AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
140                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 365 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.667455
Total seconds used by the ODBC ACCESS engine were     4.385169
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd2one_year );
 
ODBC_287: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd2one_year
 
 
ODBC_288: Executed: on connection 2
Prepared statement ODBC_287
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004805
Total SQL execution seconds were:                   0.049784
Total SQL prepare seconds were:                     0.022409
Total SQL describe seconds were:                    0.000523
Total seconds used by the ODBC ACCESS engine were     0.098361
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 72.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.98 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
WARNING: Apparent symbolic reference AD not resolved.
73         %labs(two_years,  index_date_&ad. + INTERVAL 730 DAYS);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall1two_years PURGE ) BY imp;
141                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_289: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086403
Total seconds used by the ODBC ACCESS engine were     0.088126
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
142                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_290: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.557101
Total seconds used by the ODBC ACCESS engine were     4.348639
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall1two_years );
 
ODBC_291: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall1two_years
143                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_292: Executed: on connection 2
Prepared statement ODBC_291
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004475
Total SQL execution seconds were:                   0.056336
Total SQL prepare seconds were:                     0.022368
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.104084
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 73.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.96 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi1two_years PURGE ) BY imp;
 
ODBC_293: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090312
Total seconds used by the ODBC ACCESS engine were     0.093005
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
144                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_294: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
145                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.776361
Total seconds used by the ODBC ACCESS engine were     4.578842
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi1two_years );
 
ODBC_295: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi1two_years
 
 
ODBC_296: Executed: on connection 2
Prepared statement ODBC_295
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005519
Total SQL execution seconds were:                   0.188360
Total SQL prepare seconds were:                     0.022174
Total SQL describe seconds were:                    0.000568
Total seconds used by the ODBC ACCESS engine were     0.237246
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 74.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.33 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad1two_years PURGE ) BY imp;
 
ODBC_297: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.093983
Total seconds used by the ODBC ACCESS engine were     0.097267
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad1two_years AS
146                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_298: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
147                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad 
< b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.011910
Total seconds used by the ODBC ACCESS engine were     4.641574
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad1two_years );
 
ODBC_299: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad1two_years
 
 
ODBC_300: Executed: on connection 2
Prepared statement ODBC_299
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004331
Total SQL execution seconds were:                   0.051550
Total SQL prepare seconds were:                     0.021332
Total SQL describe seconds were:                    0.000517
Total seconds used by the ODBC ACCESS engine were     0.096082
148                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 75.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.62 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke1two_years PURGE ) BY imp;
 
ODBC_301: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.089853
Total seconds used by the ODBC ACCESS engine were     0.092256
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
149                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_302: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
150                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.799215
Total seconds used by the ODBC ACCESS engine were     4.450951
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke1two_years );
 
ODBC_303: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke1two_years
 
 
ODBC_304: Executed: on connection 2
Prepared statement ODBC_303
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005004
Total SQL execution seconds were:                   0.125777
Total SQL prepare seconds were:                     0.020411
Total SQL describe seconds were:                    0.000529
Total seconds used by the ODBC ACCESS engine were     0.171601
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 76.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.13 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1two_years PURGE ) BY imp;
 
ODBC_305: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.091796
Total seconds used by the ODBC ACCESS engine were     0.093394
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
151                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_306: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
152                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on 
q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.172638
Total seconds used by the ODBC ACCESS engine were     4.880631
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_unsta_angina1two_years );
 
ODBC_307: Prepared: on connection 2
SELECT 'dingyig._12_lab1_unsta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina1two_years
 
 
ODBC_308: Executed: on connection 2
Prepared statement ODBC_307
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004551
Total SQL execution seconds were:                   0.055188
Total SQL prepare seconds were:                     0.020791
Total SQL describe seconds were:                    0.000488
Total seconds used by the ODBC ACCESS engine were     0.100673
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 77.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.49 seconds
153                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1two_years PURGE ) BY imp;
 
ODBC_309: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081202
Total seconds used by the ODBC ACCESS engine were     0.083780
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
154                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_310: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
155                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.216535
Total seconds used by the ODBC ACCESS engine were     5.039706
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_sta_angina1two_years );
 
ODBC_311: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina1two_years
 
 
ODBC_312: Executed: on connection 2
Prepared statement ODBC_311
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004820
Total SQL execution seconds were:                   0.064503
Total SQL prepare seconds were:                     0.022854
Total SQL describe seconds were:                    0.000613
Total seconds used by the ODBC ACCESS engine were     0.113900
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 78.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.66 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia1two_years PURGE ) BY imp;
 
ODBC_313: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084934
Total seconds used by the ODBC ACCESS engine were     0.086541
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
156                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_314: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
157                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia 
< b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.890215
Total seconds used by the ODBC ACCESS engine were     4.610643
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia1two_years );
 
ODBC_315: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia1two_years
 
 
ODBC_316: Executed: on connection 2
Prepared statement ODBC_315
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004622
Total SQL execution seconds were:                   0.055377
Total SQL prepare seconds were:                     0.022009
Total SQL describe seconds were:                    0.000519
Total seconds used by the ODBC ACCESS engine were     0.103519
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 79.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.22 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other1two_years PURGE ) BY imp;
158                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_317: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090328
Total seconds used by the ODBC ACCESS engine were     0.091972
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and 
b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
159                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_318: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other 
< b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 
on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.666902
Total seconds used by the ODBC ACCESS engine were     4.361122
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other1two_years );
 
ODBC_319: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other1two_years
160                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_320: Executed: on connection 2
Prepared statement ODBC_319
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006133
Total SQL execution seconds were:                   0.051346
Total SQL prepare seconds were:                     0.021022
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.099142
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 80.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.97 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc1two_years PURGE ) BY imp;
 
ODBC_321: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087438
Total seconds used by the ODBC ACCESS engine were     0.088981
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
161                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_322: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
162                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.247418
Total seconds used by the ODBC ACCESS engine were     4.889666
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc1two_years );
 
ODBC_323: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc1two_years
 
 
ODBC_324: Executed: on connection 2
Prepared statement ODBC_323
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004644
Total SQL execution seconds were:                   0.053169
Total SQL prepare seconds were:                     0.020449
Total SQL describe seconds were:                    0.000519
Total seconds used by the ODBC ACCESS engine were     0.097972
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 81.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.49 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd1two_years PURGE ) BY imp;
 
ODBC_325: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084820
Total seconds used by the ODBC ACCESS engine were     0.086454
163                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_326: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
164                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd 
< b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.638029
Total seconds used by the ODBC ACCESS engine were     4.418972
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd1two_years );
 
ODBC_327: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd1two_years
 
 
ODBC_328: Executed: on connection 2
Prepared statement ODBC_327
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005297
Total SQL execution seconds were:                   0.492803
Total SQL prepare seconds were:                     0.020969
165                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL describe seconds were:                    0.000499
Total seconds used by the ODBC ACCESS engine were     0.540012
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 82.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.48 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1two_years PURGE ) BY imp;
 
ODBC_329: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083663
Total seconds used by the ODBC ACCESS engine were     0.085164
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
166                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap 
from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_330: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
167                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.788919
Total seconds used by the ODBC ACCESS engine were     4.439868
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia1two_years );
 
ODBC_331: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia1two_years
 
 
ODBC_332: Executed: on connection 2
Prepared statement ODBC_331
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004069
Total SQL execution seconds were:                   0.050459
Total SQL prepare seconds were:                     0.021140
Total SQL describe seconds were:                    0.000553
Total seconds used by the ODBC ACCESS engine were     0.094326
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 83.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.03 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1two_years PURGE ) BY imp;
 
ODBC_333: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083109
Total seconds used by the ODBC ACCESS engine were     0.085686
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd1two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
168                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_334: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd1two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
169                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.830533
Total seconds used by the ODBC ACCESS engine were     4.456340
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd1two_years );
 
ODBC_335: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd1two_years
 
 
ODBC_336: Executed: on connection 2
Prepared statement ODBC_335
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004171
Total SQL execution seconds were:                   0.050630
Total SQL prepare seconds were:                     0.019639
Total SQL describe seconds were:                    0.000543
Total seconds used by the ODBC ACCESS engine were     0.093370
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 84.
NOTE: PROCEDURE SQL used (Total process time):
170                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      real time           5.05 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall2two_years PURGE ) BY imp;
 
ODBC_337: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084506
Total seconds used by the ODBC ACCESS engine were     0.086161
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
171                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_338: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 
on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and 
b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=index_date_overall + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
172                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.790262
Total seconds used by the ODBC ACCESS engine were     4.443008
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall2two_years );
 
ODBC_339: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall2two_years
 
 
ODBC_340: Executed: on connection 2
Prepared statement ODBC_339
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004414
Total SQL execution seconds were:                   0.065234
Total SQL prepare seconds were:                     0.020711
Total SQL describe seconds were:                    0.000507
Total seconds used by the ODBC ACCESS engine were     0.109607
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 85.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.06 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi2two_years PURGE ) BY imp;
 
ODBC_341: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081623
Total seconds used by the ODBC ACCESS engine were     0.083309
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
173                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_342: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < 
b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
174                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi 
< b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where 
year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and 
b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=index_date_mi + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.855594
Total seconds used by the ODBC ACCESS engine were     4.603173
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi2two_years );
 
ODBC_343: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi2two_years
 
 
ODBC_344: Executed: on connection 2
Prepared statement ODBC_343
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004351
Total SQL execution seconds were:                   0.053173
Total SQL prepare seconds were:                     0.019985
Total SQL describe seconds were:                    0.000551
Total seconds used by the ODBC ACCESS engine were     0.098451
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 86.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.20 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad2two_years PURGE ) BY imp;
 
175                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_345: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.176030
Total seconds used by the ODBC ACCESS engine were     0.179467
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_346: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
176                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < 
b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad 
< b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=index_date_pad + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.927604
Total seconds used by the ODBC ACCESS engine were     4.557059
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad2two_years );
 
ODBC_347: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad2two_years
 
 
ODBC_348: Executed: on connection 2
177                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_347
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003704
Total SQL execution seconds were:                   0.057966
Total SQL prepare seconds were:                     0.021418
Total SQL describe seconds were:                    0.000512
Total seconds used by the ODBC ACCESS engine were     0.102867
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 87.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.27 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke2two_years PURGE ) BY imp;
 
ODBC_349: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079540
Total seconds used by the ODBC ACCESS engine were     0.081072
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
178                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_350: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
179                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and 
b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=index_date_stroke + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.719664
Total seconds used by the ODBC ACCESS engine were     4.426611
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke2two_years );
 
ODBC_351: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke2two_years
 
 
ODBC_352: Executed: on connection 2
Prepared statement ODBC_351
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004932
Total SQL execution seconds were:                   0.178028
Total SQL prepare seconds were:                     0.020953
Total SQL describe seconds were:                    0.000540
Total seconds used by the ODBC ACCESS engine were     0.224743
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 88.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.81 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2two_years PURGE ) BY imp;
 
ODBC_353: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.092463
Total seconds used by the ODBC ACCESS engine were     0.093999
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
180                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_354: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
181                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=index_date_unsta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on 
q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.459309
Total seconds used by the ODBC ACCESS engine were     4.105431
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_unsta_angina2two_years );
 
ODBC_355: Prepared: on connection 2
SELECT 'dingyig._12_lab1_unsta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina2two_years
 
 
ODBC_356: Executed: on connection 2
Prepared statement ODBC_355
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004168
182                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.049435
Total SQL prepare seconds were:                     0.020526
Total SQL describe seconds were:                    0.000574
Total seconds used by the ODBC ACCESS engine were     0.093385
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 89.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.71 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2two_years PURGE ) BY imp;
 
ODBC_357: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083603
Total seconds used by the ODBC ACCESS engine were     0.085239
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
183                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_358: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
184                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and 
b.fst_dt<=index_date_sta_angina + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=index_date_sta_angina + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.665195
Total seconds used by the ODBC ACCESS engine were     4.285977
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_lab1_sta_angina2two_years );
 
ODBC_359: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina2two_years
 
 
ODBC_360: Executed: on connection 2
Prepared statement ODBC_359
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004330
Total SQL execution seconds were:                   0.054002
Total SQL prepare seconds were:                     0.016333
Total SQL describe seconds were:                    0.000514
Total seconds used by the ODBC ACCESS engine were     0.093330
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 90.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.93 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia2two_years PURGE ) BY imp;
 
ODBC_361: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082852
Total seconds used by the ODBC ACCESS engine were     0.084556
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
185                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_362: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
186                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < 
b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia 
< b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=index_date_tia + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.509520
Total seconds used by the ODBC ACCESS engine were     4.211049
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia2two_years );
 
ODBC_363: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia2two_years
 
 
ODBC_364: Executed: on connection 2
Prepared statement ODBC_363
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004455
Total SQL execution seconds were:                   0.050005
Total SQL prepare seconds were:                     0.020652
Total SQL describe seconds were:                    0.000543
Total seconds used by the ODBC ACCESS engine were     0.094718
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 91.
NOTE: PROCEDURE SQL used (Total process time):
187                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      real time           4.81 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other2two_years PURGE ) BY imp;
 
ODBC_365: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.172777
Total seconds used by the ODBC ACCESS engine were     0.176551
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and 
b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as 
188                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_366: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other 
< b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 
on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_other < b.fst_dt and b.fst_dt<=index_date_other + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
189                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.491078
Total seconds used by the ODBC ACCESS engine were     4.179950
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other2two_years );
 
ODBC_367: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other2two_years
 
 
ODBC_368: Executed: on connection 2
Prepared statement ODBC_367
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004901
Total SQL execution seconds were:                   0.073283
Total SQL prepare seconds were:                     0.020915
Total SQL describe seconds were:                    0.000573
Total seconds used by the ODBC ACCESS engine were     0.123352
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 92.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.90 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc2two_years PURGE ) BY imp;
 
ODBC_369: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090576
Total seconds used by the ODBC ACCESS engine were     0.093821
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
190                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_370: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) 
191                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and 
b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=index_date_revasc + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.644436
Total seconds used by the ODBC ACCESS engine were     4.279049
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc2two_years );
 
ODBC_371: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc2two_years
 
 
ODBC_372: Executed: on connection 2
Prepared statement ODBC_371
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004725
Total SQL execution seconds were:                   0.078317
Total SQL prepare seconds were:                     0.020044
Total SQL describe seconds were:                    0.000883
Total seconds used by the ODBC ACCESS engine were     0.124882
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 93.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.92 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
192                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd2two_years PURGE ) BY imp;
 
ODBC_373: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086869
Total seconds used by the ODBC ACCESS engine were     0.088848
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
193                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_374: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < 
b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as 
e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd 
< b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=index_date_cvd + INTERVAL 
730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  73.619688
Total seconds used by the ODBC ACCESS engine were    74.325076
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd2two_years );
 
ODBC_375: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd2two_years
 
194                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_376: Executed: on connection 2
Prepared statement ODBC_375
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004649
Total SQL execution seconds were:                   0.059763
Total SQL prepare seconds were:                     0.018830
Total SQL describe seconds were:                    0.000570
Total seconds used by the ODBC ACCESS engine were     0.103516
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 94.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:14.59
      cpu time            0.64 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2two_years PURGE ) BY imp;
 
ODBC_377: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081379
Total seconds used by the ODBC ACCESS engine were     0.082924
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
195                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 
DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select 
z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by 
e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap 
from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_378: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on 
q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) 
196                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and 
b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=index_date_anginatia + INTERVAL 730 DAYS 
) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.580360
Total seconds used by the ODBC ACCESS engine were     4.217292
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia2two_years );
 
ODBC_379: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia2two_years
 
 
ODBC_380: Executed: on connection 2
Prepared statement ODBC_379
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004162
Total SQL execution seconds were:                   0.059816
Total SQL prepare seconds were:                     0.019035
Total SQL describe seconds were:                    0.000590
Total seconds used by the ODBC ACCESS engine were     0.101971
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 95.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.82 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2two_years PURGE ) BY imp;
 
ODBC_381: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083680
197                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.085384
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd2two_years AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + 
INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_382: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd2two_years AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
198                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd 
+ INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as 
gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, 
z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on 
q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and 
b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=index_date_noncvd + INTERVAL 730 DAYS ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.527355
Total seconds used by the ODBC ACCESS engine were     4.188757
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd2two_years );
 
ODBC_383: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd2two_years
 
 
ODBC_384: Executed: on connection 2
Prepared statement ODBC_383
 
 
Summary Statistics for ODBC are:
199                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total row fetch seconds were:                       0.004878
Total SQL execution seconds were:                   0.067871
Total SQL prepare seconds were:                     0.021677
Total SQL describe seconds were:                    0.000503
Total seconds used by the ODBC ACCESS engine were     0.114365
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 96.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.80 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
74         %labs(all, eligend);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall1all PURGE ) BY imp;
 
ODBC_385: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085297
Total seconds used by the ODBC ACCESS engine were     0.086873
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
200                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_386: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and 
q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
201                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.589412
Total seconds used by the ODBC ACCESS engine were     4.293011
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall1all );
 
ODBC_387: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall1all
 
 
ODBC_388: Executed: on connection 2
Prepared statement ODBC_387
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004303
Total SQL execution seconds were:                   0.081419
Total SQL prepare seconds were:                     0.021226
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.127398
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 97.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.93 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi1all PURGE ) BY imp;
 
ODBC_389: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081619
Total seconds used by the ODBC ACCESS engine were     0.083292
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
202                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_390: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
203                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.618807
Total seconds used by the ODBC ACCESS engine were     4.283613
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi1all );
 
ODBC_391: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi1all
 
 
ODBC_392: Executed: on connection 2
Prepared statement ODBC_391
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005028
Total SQL execution seconds were:                   0.204627
Total SQL prepare seconds were:                     0.020998
Total SQL describe seconds were:                    0.000495
Total seconds used by the ODBC ACCESS engine were     0.253819
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 98.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.04 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
204                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad1all PURGE ) BY imp;
 
ODBC_393: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079438
Total seconds used by the ODBC ACCESS engine were     0.081026
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_394: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
205                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.512632
Total seconds used by the ODBC ACCESS engine were     4.217702
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad1all );
 
ODBC_395: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad1all
 
 
ODBC_396: Executed: on connection 2
Prepared statement ODBC_395
 
206                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003651
Total SQL execution seconds were:                   0.049884
Total SQL prepare seconds were:                     0.021958
Total SQL describe seconds were:                    0.000491
Total seconds used by the ODBC ACCESS engine were     0.095391
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 99.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.48 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke1all PURGE ) BY imp;
 
ODBC_397: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087877
Total seconds used by the ODBC ACCESS engine were     0.089536
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
207                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_398: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
208                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.785493
Total seconds used by the ODBC ACCESS engine were     4.506654
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke1all );
 
ODBC_399: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke1all
 
 
ODBC_400: Executed: on connection 2
Prepared statement ODBC_399
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004345
Total SQL execution seconds were:                   0.060143
Total SQL prepare seconds were:                     0.021796
Total SQL describe seconds were:                    0.000551
Total seconds used by the ODBC ACCESS engine were     0.105347
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 100.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.78 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1all PURGE ) BY imp;
 
ODBC_401: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082271
Total seconds used by the ODBC ACCESS engine were     0.083851
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
209                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_402: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
210                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.522171
Total seconds used by the ODBC ACCESS engine were     4.238828
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_unsta_angina1all );
 
ODBC_403: Prepared: on connection 2
SELECT 'dingyig._12_lab1_unsta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina1all
 
 
ODBC_404: Executed: on connection 2
Prepared statement ODBC_403
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005330
Total SQL execution seconds were:                   0.298359
Total SQL prepare seconds were:                     0.019280
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.343720
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 101.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.75 seconds
      cpu time            0.08 seconds
211                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1all PURGE ) BY imp;
 
ODBC_405: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081331
Total seconds used by the ODBC ACCESS engine were     0.082898
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
212                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_406: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.524441
Total seconds used by the ODBC ACCESS engine were     4.245664
 
213                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_sta_angina1all );
 
ODBC_407: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina1all
 
 
ODBC_408: Executed: on connection 2
Prepared statement ODBC_407
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004768
Total SQL execution seconds were:                   0.050971
Total SQL prepare seconds were:                     0.020549
Total SQL describe seconds were:                    0.000881
Total seconds used by the ODBC ACCESS engine were     0.097934
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 102.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.85 seconds
      cpu time            0.11 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia1all PURGE ) BY imp;
 
ODBC_409: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080278
Total seconds used by the ODBC ACCESS engine were     0.081973
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
214                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_410: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as a inner 
215                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.606419
Total seconds used by the ODBC ACCESS engine were     4.350583
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia1all );
 
ODBC_411: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia1all
 
 
ODBC_412: Executed: on connection 2
Prepared statement ODBC_411
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004756
Total SQL execution seconds were:                   0.052273
Total SQL prepare seconds were:                     0.022297
Total SQL describe seconds were:                    0.000555
Total seconds used by the ODBC ACCESS engine were     0.100399
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 103.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.95 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other1all PURGE ) BY imp;
 
ODBC_413: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080440
Total seconds used by the ODBC ACCESS engine were     0.082082
 
216                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_414: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * 
217                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < 
b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.573989
Total seconds used by the ODBC ACCESS engine were     4.349175
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other1all );
 
ODBC_415: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other1all
 
 
ODBC_416: Executed: on connection 2
Prepared statement ODBC_415
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005161
Total SQL execution seconds were:                   0.060866
Total SQL prepare seconds were:                     0.019337
Total SQL describe seconds were:                    0.000509
Total seconds used by the ODBC ACCESS engine were     0.106678
 
218                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 104.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.62 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc1all PURGE ) BY imp;
 
ODBC_417: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.097219
Total seconds used by the ODBC ACCESS engine were     0.100788
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
219                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_418: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
220                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   3.516513
Total seconds used by the ODBC ACCESS engine were     4.142662
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc1all );
 
ODBC_419: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc1all
 
 
ODBC_420: Executed: on connection 2
Prepared statement ODBC_419
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004251
Total SQL execution seconds were:                   0.054350
Total SQL prepare seconds were:                     0.021171
Total SQL describe seconds were:                    0.000904
Total seconds used by the ODBC ACCESS engine were     0.100091
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 105.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.76 seconds
      cpu time            0.14 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd1all PURGE ) BY imp;
 
ODBC_421: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080315
Total seconds used by the ODBC ACCESS engine were     0.081927
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
221                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_422: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
222                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6a as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.610102
Total seconds used by the ODBC ACCESS engine were     4.233210
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd1all );
 
ODBC_423: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd1all
 
 
ODBC_424: Executed: on connection 2
Prepared statement ODBC_423
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004380
Total SQL execution seconds were:                   0.075462
Total SQL prepare seconds were:                     0.019176
Total SQL describe seconds were:                    0.000507
Total seconds used by the ODBC ACCESS engine were     0.118618
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 106.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.85 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1all PURGE ) BY imp;
 
ODBC_425: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia1all PURGE
 
 
Summary Statistics for ODBC are:
223                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.086029
Total seconds used by the ODBC ACCESS engine were     0.087746
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_426: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
224                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.773825
Total seconds used by the ODBC ACCESS engine were     4.471125
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia1all );
 
ODBC_427: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia1all
 
 
ODBC_428: Executed: on connection 2
Prepared statement ODBC_427
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004805
225                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.137638
Total SQL prepare seconds were:                     0.019890
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.182112
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 107.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.20 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1all PURGE ) BY imp;
 
ODBC_429: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080293
Total seconds used by the ODBC ACCESS engine were     0.081864
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd1all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
226                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_430: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd1all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6a q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6a as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
227                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.029379
Total seconds used by the ODBC ACCESS engine were     4.757979
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd1all );
 
ODBC_431: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd1all
 
 
ODBC_432: Executed: on connection 2
Prepared statement ODBC_431
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005261
Total SQL execution seconds were:                   0.061982
Total SQL prepare seconds were:                     0.021355
Total SQL describe seconds were:                    0.000487
Total seconds used by the ODBC ACCESS engine were     0.111714
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 108.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.02 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_overall2all PURGE ) BY imp;
 
ODBC_433: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_overall2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099159
Total seconds used by the ODBC ACCESS engine were     0.101727
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_overall2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
228                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_434: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_overall2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
229                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_overall 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and 
q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="tg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_overall)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_overall < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.560734
Total seconds used by the ODBC ACCESS engine were     4.181245
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_overall2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_overall2all );
 
ODBC_435: Prepared: on connection 2
SELECT 'dingyig._12_lab1_overall2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_overall2all
 
 
ODBC_436: Executed: on connection 2
Prepared statement ODBC_435
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005070
Total SQL execution seconds were:                   0.151289
Total SQL prepare seconds were:                     0.016569
Total SQL describe seconds were:                    0.000816
Total seconds used by the ODBC ACCESS engine were     0.193939
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 109.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.90 seconds
      cpu time            0.14 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
230                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_mi2all PURGE ) BY imp;
 
ODBC_437: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_mi2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.102151
Total seconds used by the ODBC ACCESS engine were     0.103858
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_mi2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_438: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_mi2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
231                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_mi)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_mi < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.444927
Total seconds used by the ODBC ACCESS engine were     5.141246
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_mi2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_mi2all );
 
ODBC_439: Prepared: on connection 2
SELECT 'dingyig._12_lab1_mi2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_mi2all
 
 
ODBC_440: Executed: on connection 2
Prepared statement ODBC_439
 
232                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004526
Total SQL execution seconds were:                   0.048606
Total SQL prepare seconds were:                     0.019951
Total SQL describe seconds were:                    0.000490
Total seconds used by the ODBC ACCESS engine were     0.092029
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 110.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.41 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_pad2all PURGE ) BY imp;
 
ODBC_441: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_pad2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.097681
Total seconds used by the ODBC ACCESS engine were     0.099416
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_pad2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
233                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_442: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_pad2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_pad)) as gap from dingyig._01_cohort_6b as 
234                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_pad < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.682436
Total seconds used by the ODBC ACCESS engine were     4.408451
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_pad2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_pad2all );
 
ODBC_443: Prepared: on connection 2
SELECT 'dingyig._12_lab1_pad2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_pad2all
 
 
ODBC_444: Executed: on connection 2
Prepared statement ODBC_443
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004636
Total SQL execution seconds were:                   0.050771
Total SQL prepare seconds were:                     0.019356
Total SQL describe seconds were:                    0.000853
Total seconds used by the ODBC ACCESS engine were     0.098255
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 111.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.72 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_stroke2all PURGE ) BY imp;
 
ODBC_445: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_stroke2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099822
Total seconds used by the ODBC ACCESS engine were     0.101561
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_stroke2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
235                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_446: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_stroke2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b 
236                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_stroke 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_stroke)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_stroke < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.636539
Total seconds used by the ODBC ACCESS engine were     4.383480
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_stroke2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_stroke2all );
 
ODBC_447: Prepared: on connection 2
SELECT 'dingyig._12_lab1_stroke2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_stroke2all
 
 
ODBC_448: Executed: on connection 2
Prepared statement ODBC_447
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005282
Total SQL execution seconds were:                   0.050704
Total SQL prepare seconds were:                     0.020256
Total SQL describe seconds were:                    0.000886
Total seconds used by the ODBC ACCESS engine were     0.098195
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 112.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.67 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
237                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2all PURGE ) BY imp;
 
ODBC_449: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_unsta_angina2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.166953
Total seconds used by the ODBC ACCESS engine were     0.168548
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_unsta_angina2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
238                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_450: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_unsta_angina2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as 
ldlc_dt , case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as 
hdlc_dt , case when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt 
, case when w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case 
when w4.patid is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when 
w5.patid is not null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when 
w6.patid is not null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when 
w7.patid is not null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="hdlc" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_unsta_angina < b.fst_dt and 
b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left 
join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp 
order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_unsta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_unsta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.457313
Total seconds used by the ODBC ACCESS engine were     4.165587
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_unsta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_unsta_angina2all );
 
ODBC_451: Prepared: on connection 2
239                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

SELECT 'dingyig._12_lab1_unsta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_unsta_angina2all
 
 
ODBC_452: Executed: on connection 2
Prepared statement ODBC_451
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004890
Total SQL execution seconds were:                   0.050659
Total SQL prepare seconds were:                     0.019576
Total SQL describe seconds were:                    0.000577
Total seconds used by the ODBC ACCESS engine were     0.095548
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 113.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.84 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2all PURGE ) BY imp;
 
ODBC_453: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_sta_angina2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.098160
Total seconds used by the ODBC ACCESS engine were     0.099935
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_sta_angina2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
240                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_454: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_sta_angina2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt 
, case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
241                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_sta_angina)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_sta_angina < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.620260
Total seconds used by the ODBC ACCESS engine were     4.404853
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_sta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_sta_angina2all );
 
ODBC_455: Prepared: on connection 2
SELECT 'dingyig._12_lab1_sta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_sta_angina2all
 
 
ODBC_456: Executed: on connection 2
Prepared statement ODBC_455
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004624
Total SQL execution seconds were:                   0.051011
Total SQL prepare seconds were:                     0.020013
Total SQL describe seconds were:                    0.000889
Total seconds used by the ODBC ACCESS engine were     0.097754
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 114.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.69 seconds
      cpu time            0.13 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_tia2all PURGE ) BY imp;
 
ODBC_457: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_tia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080778
Total seconds used by the ODBC ACCESS engine were     0.082479
 
242                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_tia2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_458: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_tia2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
243                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

b on a.patid=b.patid and b.grp="ldlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_tia)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_tia < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.491233
Total seconds used by the ODBC ACCESS engine were     4.216004
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_tia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_tia2all );
 
ODBC_459: Prepared: on connection 2
SELECT 'dingyig._12_lab1_tia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_tia2all
 
 
ODBC_460: Executed: on connection 2
Prepared statement ODBC_459
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003875
Total SQL execution seconds were:                   0.051354
Total SQL prepare seconds were:                     0.021099
Total SQL describe seconds were:                    0.000502
Total seconds used by the ODBC ACCESS engine were     0.096455
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 115.
244                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           4.82 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_other2all PURGE ) BY imp;
 
ODBC_461: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_other2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080594
Total seconds used by the ODBC ACCESS engine were     0.082018
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_other2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
245                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_462: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_other2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_other < 
b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_other)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_other < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.546952
Total seconds used by the ODBC ACCESS engine were     4.241427
246                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_other2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_other2all );
 
ODBC_463: Prepared: on connection 2
SELECT 'dingyig._12_lab1_other2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_other2all
 
 
ODBC_464: Executed: on connection 2
Prepared statement ODBC_463
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004473
Total SQL execution seconds were:                   0.049525
Total SQL prepare seconds were:                     0.020800
Total SQL describe seconds were:                    0.000497
Total seconds used by the ODBC ACCESS engine were     0.094919
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 116.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.83 seconds
      cpu time            0.08 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_revasc2all PURGE ) BY imp;
 
ODBC_465: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_revasc2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082276
Total seconds used by the ODBC ACCESS engine were     0.084978
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_revasc2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
247                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_466: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_revasc2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_revasc 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
248                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_revasc)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_revasc < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.659708
Total seconds used by the ODBC ACCESS engine were     4.407492
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_revasc2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_revasc2all );
 
ODBC_467: Prepared: on connection 2
SELECT 'dingyig._12_lab1_revasc2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_revasc2all
 
 
ODBC_468: Executed: on connection 2
Prepared statement ODBC_467
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004266
Total SQL execution seconds were:                   0.077932
Total SQL prepare seconds were:                     0.021102
Total SQL describe seconds were:                    0.000556
Total seconds used by the ODBC ACCESS engine were     0.124377
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 117.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.03 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_cvd2all PURGE ) BY imp;
 
ODBC_469: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_cvd2all PURGE
 
 
Summary Statistics for ODBC are:
249                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.100964
Total seconds used by the ODBC ACCESS engine were     0.102851
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_cvd2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_470: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_cvd2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case 
when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when 
w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid 
is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not 
null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null 
then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null 
then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null 
then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr 
250                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, 
b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner join (select * 
from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where 
z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as a inner 
join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_cvd)) as gap from dingyig._01_cohort_6b as 
a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr 
> 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_cvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.950123
Total seconds used by the ODBC ACCESS engine were     4.671309
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_cvd2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_cvd2all );
 
ODBC_471: Prepared: on connection 2
SELECT 'dingyig._12_lab1_cvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_cvd2all
 
 
ODBC_472: Executed: on connection 2
Prepared statement ODBC_471
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004829
Total SQL execution seconds were:                   0.051067
Total SQL prepare seconds were:                     0.021116
Total SQL describe seconds were:                    0.000848
Total seconds used by the ODBC ACCESS engine were     0.098735
251                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 118.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.29 seconds
      cpu time            0.16 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2all PURGE ) BY imp;
 
ODBC_473: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_anginatia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085328
Total seconds used by the ODBC ACCESS engine were     0.086989
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_anginatia2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on 
q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
252                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mol" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w6 on 
q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_474: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_anginatia2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on 
q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="tc" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join 
(select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and 
rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z 
where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_anginatia)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_anginatia < b.fst_dt and b.fst_dt<=eligend ) as e 
) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
253                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   4.199883
Total seconds used by the ODBC ACCESS engine were     4.880591
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_anginatia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_anginatia2all );
 
ODBC_475: Prepared: on connection 2
SELECT 'dingyig._12_lab1_anginatia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_anginatia2all
 
 
ODBC_476: Executed: on connection 2
Prepared statement ODBC_475
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004225
Total SQL execution seconds were:                   0.056514
Total SQL prepare seconds were:                     0.023399
Total SQL describe seconds were:                    0.000469
Total seconds used by the ODBC ACCESS engine were     0.103007
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 119.
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.49 seconds
      cpu time            0.10 seconds
      

MPRINT(LABS):  ;
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2all PURGE ) BY imp;
 
ODBC_477: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_lab1_noncvd2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084918
Total seconds used by the ODBC ACCESS engine were     0.086465
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_lab1_noncvd2all AS
MPRINT(LABS):   select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , case when w1.patid is not null 
then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case when w2.patid is not null then 
w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when w3.patid is not null then 
w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid is not null then 
w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not null then 
w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not null then 
w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not null then 
w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
254                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as 
z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and q.grp=w4.grp left join (select z.patid, 
z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="lpa_mg" and 
a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w5 on 
q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, 
row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by 
z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
MPRINT(CREATE):   ) BY imp;
 
ODBC_478: Executed: on connection 2
CREATE TABLE dingyig._12_lab1_noncvd2all AS select distinct q.* , case when w1.patid is not null then w1.fst_dt end as ldlc_dt , 
case when w1.patid is not null then w1.rslt_nbr end as ldlc , case when w2.patid is not null then w2.fst_dt end as hdlc_dt , case 
when w2.patid is not null then w2.rslt_nbr end as hdlc , case when w3.patid is not null then w3.fst_dt end as tc_dt , case when 
w3.patid is not null then w3.rslt_nbr end as tc , case when w4.patid is not null then w4.fst_dt end as tg_dt , case when w4.patid 
is not null then w4.rslt_nbr end as tg , case when w5.patid is not null then w5.fst_dt end as lpa_mg_dt , case when w5.patid is not 
null then w5.rslt_nbr end as lpa_mg , case when w6.patid is not null then w6.fst_dt end as lpa_mol_dt , case when w6.patid is not 
null then w6.rslt_nbr end as lpa_mol , case when w7.patid is not null then w7.fst_dt end as cprot_dt , case when w7.patid is not 
null then w7.rslt_nbr end as cprot from dingyig._01_cohort_6b q left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as 
rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="ldlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w1 on q.patid=w1.patid and q.grp=w1.grp left join (select z.patid, z.grp, z.fst_dt, 
avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from 
(select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a 
inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 
0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="hdlc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) 
as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w2 on q.patid=w2.patid and q.grp=w2.grp left join (select z.patid, z.grp, 
z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as 
rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b 
as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and 
rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tc" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) 
as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w3 on q.patid=w3.patid and q.grp=w3.grp left join (select z.patid, 
255                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, 
e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from 
dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and 
year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid and b.grp="tg" and a.index_date_noncvd 
< b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, z.fst_dt) as w4 on q.patid=w4.patid and 
q.grp=w4.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from (select e.*, row_number() over (partition 
by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, b.rslt_nbr, 
abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from dingyig.ldlc_04_lab2 
where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as b on a.patid=b.patid 
and b.grp="lpa_mg" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group by z.patid, z.grp, 
z.fst_dt) as w5 on q.patid=w5.patid and q.grp=w5.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) as rslt_nbr from 
(select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, a.grp, b.fst_dt, 
b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select * from 
dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 9999) as 
b on a.patid=b.patid and b.grp="lpa_mol" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 group 
by z.patid, z.grp, z.fst_dt) as w6 on q.patid=w6.patid and q.grp=w6.grp left join (select z.patid, z.grp, z.fst_dt, avg(z.rslt_nbr) 
as rslt_nbr from (select e.*, row_number() over (partition by e.patid, e.grp order by e.gap, e.fst_dt) as rn from (select a.patid, 
a.grp, b.fst_dt, b.rslt_nbr, abs(datediff(b.fst_dt,a.index_date_noncvd)) as gap from dingyig._01_cohort_6b as a inner join (select 
* from dingyig.ldlc_04_lab2 where year(to_date(fst_dt)) >= 2007 and year(to_date(fst_dt)) <= 2019 and rslt_nbr > 0 and rslt_nbr < 
9999) as b on a.patid=b.patid and b.grp="cprot" and a.index_date_noncvd < b.fst_dt and b.fst_dt<=eligend ) as e ) as z where z.rn=1 
group by z.patid, z.grp, z.fst_dt) as w7 on q.patid=w7.patid and q.grp=w7.grp
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   3.569570
Total seconds used by the ODBC ACCESS engine were     4.302656
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_lab1_noncvd2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_lab1_noncvd2all );
 
ODBC_479: Prepared: on connection 2
SELECT 'dingyig._12_lab1_noncvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_lab1_noncvd2all
 
 
ODBC_480: Executed: on connection 2
Prepared statement ODBC_479
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004028
Total SQL execution seconds were:                   0.050231
Total SQL prepare seconds were:                     0.020003
Total SQL describe seconds were:                    0.000526
Total seconds used by the ODBC ACCESS engine were     0.096327
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 120.
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.56 seconds
      cpu time            0.09 seconds
      

MPRINT(LABS):  ;
75         
76         
77         %macro procs(year, years);
78         	%do z=1 %to 2;
79         	%let groups=overall*mi*pad*stroke*unsta_angina*sta_angina*tia*other*revasc*cvd*anginatia*noncvd;
256                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

80         		%do zz=1 %to 12;
81         			%let ad = %scan(&groups., &zz., *);
82         /*procedures one year post index not including index date - added in count of procedures for frequency*/
83         	%create(_12_proc_&ad.&z.&year.)
84         		select q.patid, q.index_date_&ad.
85         			%do i=1 %to 2;
86         				%let proc_nm = %scan(aphe*dial, &i., *);	
87         				, max(case when w&i..patid is not null and index_date_&ad.< w&i..dt and w&i..dt<= &years. then 1 end) as &proc_nm.
88         				, count(distinct case when w&i..patid is not null then w&i..dt end) as &proc_nm._cnt
89         			%end;
90         			, max(case when s.patid is not null then 1 end) as revasc
91         			, count(distinct case when s.patid  is not null then  s.dt end) as revasc_cnt
92         		
93         		from dingyig._12_lab1_&ad.&z.&year. as q
94         			%do t=1 %to 2;
95         				%let proc_nm = %scan(aphe*dial, &t., *);	
96         				left join (select * from dingyig.optum2_01_other_proc  where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019)
96       !  as w&t.
97         				on q.patid=w&t..patid and w&t..grp="&proc_nm." and q.index_date_&ad. < w&t..dt and w&t..dt<=&years.
98         			%end;
99         	/* 			Revascularization */
100        			left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019
101        				and code in (select distinct code from dingyig.optum2_01_proc)) as s
102        			on q.patid=s.patid and q.index_date_&ad. < s.dt and s.dt<=&years.
103        
104        
105        		group by q.patid, q.index_date_&ad.
106        	%create(_12_proc_&ad.&z.&year.)
107        	%end;
108        	%end;
109        %mend;
110        %procs(one_year, index_date_&ad. + INTERVAL 365 DAYS);
WARNING: Apparent symbolic reference AD not resolved.
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall1one_year PURGE ) BY imp;
 
ODBC_481: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077108
Total seconds used by the ODBC ACCESS engine were     0.078780
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= index_date_overall + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= index_date_overall + INTERVAL 365 DAYS 
then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null 
then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_overall1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
257                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_482: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall1one_year AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
index_date_overall< w1.dt and w1.dt<= index_date_overall + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= 
index_date_overall + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_overall1one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < 
w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.230556
Total seconds used by the ODBC ACCESS engine were    10.478451
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall1one_year );
 
ODBC_483: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall1one_year
 
 
ODBC_484: Executed: on connection 2
Prepared statement ODBC_483
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004355
Total SQL execution seconds were:                   0.420391
Total SQL prepare seconds were:                     0.019716
Total SQL describe seconds were:                    0.000487
Total seconds used by the ODBC ACCESS engine were     0.465307
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 121.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.44 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi1one_year PURGE ) BY imp;
 
ODBC_485: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_mi1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077761
258                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.079392
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
index_date_mi + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi1one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 365 DAYS group by 
q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_486: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi1one_year AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and 
index_date_mi< w1.dt and w1.dt<= index_date_mi + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 
365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_mi1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 
365 DAYS group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.058210
Total seconds used by the ODBC ACCESS engine were    10.344273
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi1one_year );
 
ODBC_487: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi1one_year
 
 
ODBC_488: Executed: on connection 2
Prepared statement ODBC_487
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004990
Total SQL execution seconds were:                   0.051818
Total SQL prepare seconds were:                     0.021282
Total SQL describe seconds were:                    0.000517
Total seconds used by the ODBC ACCESS engine were     0.101484
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 122.
NOTE: PROCEDURE SQL used (Total process time):
      real time           10.94 seconds
259                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad1one_year PURGE ) BY imp;
 
ODBC_489: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079502
Total seconds used by the ODBC ACCESS engine were     0.081052
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
index_date_pad + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad1one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 365 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_490: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad1one_year AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and 
index_date_pad< w1.dt and w1.dt<= index_date_pad + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_pad1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 
365 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.636580
Total seconds used by the ODBC ACCESS engine were    10.876254
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad1one_year );
 
ODBC_491: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad1one_year
 
 
ODBC_492: Executed: on connection 2
260                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_491
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005022
Total SQL execution seconds were:                   0.095651
Total SQL prepare seconds were:                     0.024851
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.145941
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 123.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.20 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke1one_year PURGE ) BY imp;
 
ODBC_493: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079127
Total seconds used by the ODBC ACCESS engine were     0.082618
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
index_date_stroke + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= index_date_stroke + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke1one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 
365 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_494: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke1one_year AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= index_date_stroke + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= 
index_date_stroke + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_stroke1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and 
w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and 
w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, q.index_date_stroke
261                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.559732
Total seconds used by the ODBC ACCESS engine were    10.964773
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke1one_year );
 
ODBC_495: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke1one_year
 
 
ODBC_496: Executed: on connection 2
Prepared statement ODBC_495
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005509
Total SQL execution seconds were:                   0.105448
Total SQL prepare seconds were:                     0.020018
Total SQL describe seconds were:                    0.000639
Total seconds used by the ODBC ACCESS engine were     0.153733
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 124.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.27 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1one_year PURGE ) BY imp;
 
ODBC_497: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076486
Total seconds used by the ODBC ACCESS engine were     0.078113
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then 
w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina 
+ INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_unsta_angina1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
262                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_498: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina1one_year AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not 
null and index_date_unsta_angina< w1.dt and w1.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as aphe , 
count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and 
index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case 
when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct 
case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina1one_year as q left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 
365 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.472754
Total seconds used by the ODBC ACCESS engine were    10.728022
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_unsta_angina1one_year );
 
ODBC_499: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina1one_year
 
 
ODBC_500: Executed: on connection 2
Prepared statement ODBC_499
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004953
Total SQL execution seconds were:                   0.049342
Total SQL prepare seconds were:                     0.020215
Total SQL describe seconds were:                    0.000548
Total seconds used by the ODBC ACCESS engine were     0.095496
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 125.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.31 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1one_year PURGE ) BY imp;
 
ODBC_501: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.095733
Total seconds used by the ODBC ACCESS engine were     0.098632
263                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= index_date_sta_angina + INTERVAL 
365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_sta_angina1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_502: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina1one_year AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null 
and index_date_sta_angina< w1.dt and w1.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case 
when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and 
w2.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt 
end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt 
end) as revasc_cnt from dingyig._12_lab1_sta_angina1one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < 
w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.032223
Total seconds used by the ODBC ACCESS engine were    10.422893
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_sta_angina1one_year );
 
ODBC_503: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina1one_year
 
 
ODBC_504: Executed: on connection 2
Prepared statement ODBC_503
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005355
Total SQL execution seconds were:                   0.150838
Total SQL prepare seconds were:                     0.017849
Total SQL describe seconds were:                    0.000497
Total seconds used by the ODBC ACCESS engine were     0.195501
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 126.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.15 seconds
      cpu time            0.16 seconds
264                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia1one_year PURGE ) BY imp;
 
ODBC_505: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_tia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077732
Total seconds used by the ODBC ACCESS engine were     0.079365
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
index_date_tia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia1one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 365 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_506: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia1one_year AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and 
index_date_tia< w1.dt and w1.dt<= index_date_tia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_tia1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 
365 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.428637
Total seconds used by the ODBC ACCESS engine were    10.688895
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia1one_year );
 
ODBC_507: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia1one_year
 
 
ODBC_508: Executed: on connection 2
Prepared statement ODBC_507
265                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004879
Total SQL execution seconds were:                   0.189921
Total SQL prepare seconds were:                     0.020231
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.236411
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 127.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.08 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other1one_year PURGE ) BY imp;
 
ODBC_509: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080215
Total seconds used by the ODBC ACCESS engine were     0.081858
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
index_date_other + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other1one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + INTERVAL 365 DAYS group 
by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_510: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other1one_year AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= index_date_other + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is 
not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other 
+ INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_other1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS 
left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + 
INTERVAL 365 DAYS group by q.patid, q.index_date_other
 
266                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.399293
Total seconds used by the ODBC ACCESS engine were    10.626889
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other1one_year );
 
ODBC_511: Prepared: on connection 2
SELECT 'dingyig._12_proc_other1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other1one_year
 
 
ODBC_512: Executed: on connection 2
Prepared statement ODBC_511
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004937
Total SQL execution seconds were:                   0.167085
Total SQL prepare seconds were:                     0.019340
Total SQL describe seconds were:                    0.000538
Total seconds used by the ODBC ACCESS engine were     0.219229
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 128.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.35 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc1one_year PURGE ) BY imp;
 
ODBC_513: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082201
Total seconds used by the ODBC ACCESS engine were     0.083774
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
index_date_revasc + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= index_date_revasc + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc1one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 
365 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
267                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_514: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc1one_year AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= index_date_revasc + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= 
index_date_revasc + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_revasc1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and 
w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and 
w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  77.313122
Total seconds used by the ODBC ACCESS engine were    77.538959
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc1one_year );
 
ODBC_515: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc1one_year
 
 
ODBC_516: Executed: on connection 2
Prepared statement ODBC_515
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005052
Total SQL execution seconds were:                  39.269442
Total SQL prepare seconds were:                     0.019883
Total SQL describe seconds were:                    0.000491
Total seconds used by the ODBC ACCESS engine were    39.314826
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 129.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:57.39
      cpu time            1.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd1one_year PURGE ) BY imp;
 
ODBC_517: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076538
Total seconds used by the ODBC ACCESS engine were     0.079249
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd1one_year AS
268                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
index_date_cvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd1one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 365 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_518: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd1one_year AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and 
index_date_cvd< w1.dt and w1.dt<= index_date_cvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_cvd1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 
365 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   9.995885
Total seconds used by the ODBC ACCESS engine were    10.221528
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd1one_year );
 
ODBC_519: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd1one_year
 
 
ODBC_520: Executed: on connection 2
Prepared statement ODBC_519
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004653
Total SQL execution seconds were:                   0.049422
Total SQL prepare seconds were:                     0.020571
Total SQL describe seconds were:                    0.000510
Total seconds used by the ODBC ACCESS engine were     0.094449
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 130.
NOTE: PROCEDURE SQL used (Total process time):
      real time           10.82 seconds
      cpu time            0.15 seconds
      

269                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia1one_year PURGE ) BY imp;
 
ODBC_521: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079495
Total seconds used by the ODBC ACCESS engine were     0.082064
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= index_date_anginatia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= index_date_anginatia + INTERVAL 
365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_anginatia1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < w2.dt and 
w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_522: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia1one_year AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and 
index_date_anginatia< w1.dt and w1.dt<= index_date_anginatia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= 
index_date_anginatia + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_anginatia1one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < 
w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   9.299377
Total seconds used by the ODBC ACCESS engine were     9.533485
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia1one_year );
 
ODBC_523: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia1one_year
 
 
ODBC_524: Executed: on connection 2
Prepared statement ODBC_523
 
 
270                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004754
Total SQL execution seconds were:                   0.048342
Total SQL prepare seconds were:                     0.019361
Total SQL describe seconds were:                    0.000521
Total seconds used by the ODBC ACCESS engine were     0.092635
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 131.
NOTE: PROCEDURE SQL used (Total process time):
      real time           10.15 seconds
      cpu time            0.14 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd1one_year PURGE ) BY imp;
 
ODBC_525: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_noncvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079455
Total seconds used by the ODBC ACCESS engine were     0.082166
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd1one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
index_date_noncvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= index_date_noncvd + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd1one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 
365 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_526: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd1one_year AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= index_date_noncvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= 
index_date_noncvd + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_noncvd1one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and 
w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and 
w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
271                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  10.463938
Total seconds used by the ODBC ACCESS engine were    10.679293
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd1one_year );
 
ODBC_527: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd1one_year
 
 
ODBC_528: Executed: on connection 2
Prepared statement ODBC_527
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004246
Total SQL execution seconds were:                   0.198873
Total SQL prepare seconds were:                     0.020232
Total SQL describe seconds were:                    0.000498
Total seconds used by the ODBC ACCESS engine were     0.243172
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 132.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.42 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall2one_year PURGE ) BY imp;
 
ODBC_529: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078986
Total seconds used by the ODBC ACCESS engine were     0.080527
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= index_date_overall + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= index_date_overall + INTERVAL 365 DAYS 
then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null 
then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_overall2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_530: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall2one_year AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
272                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

index_date_overall< w1.dt and w1.dt<= index_date_overall + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= 
index_date_overall + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_overall2one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < 
w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 365 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.525339
Total seconds used by the ODBC ACCESS engine were    10.989200
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall2one_year );
 
ODBC_531: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall2one_year
 
 
ODBC_532: Executed: on connection 2
Prepared statement ODBC_531
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004668
Total SQL execution seconds were:                   0.050839
Total SQL prepare seconds were:                     0.021410
Total SQL describe seconds were:                    0.000544
Total seconds used by the ODBC ACCESS engine were     0.098124
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 133.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.59 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi2one_year PURGE ) BY imp;
 
ODBC_533: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_mi2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.074656
Total seconds used by the ODBC ACCESS engine were     0.076275
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
index_date_mi + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
273                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi2one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 365 DAYS group by 
q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_534: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi2one_year AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and 
index_date_mi< w1.dt and w1.dt<= index_date_mi + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 
365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_mi2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 
365 DAYS group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.719844
Total seconds used by the ODBC ACCESS engine were    10.950937
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi2one_year );
 
ODBC_535: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi2one_year
 
 
ODBC_536: Executed: on connection 2
Prepared statement ODBC_535
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004584
Total SQL execution seconds were:                   0.049223
Total SQL prepare seconds were:                     0.019796
Total SQL describe seconds were:                    0.000486
Total seconds used by the ODBC ACCESS engine were     0.093922
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 134.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.55 seconds
      cpu time            0.14 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
274                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad2one_year PURGE ) BY imp;
 
ODBC_537: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081915
Total seconds used by the ODBC ACCESS engine were     0.083651
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
index_date_pad + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad2one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 365 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_538: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad2one_year AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and 
index_date_pad< w1.dt and w1.dt<= index_date_pad + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_pad2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 
365 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.386166
Total seconds used by the ODBC ACCESS engine were    10.614155
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad2one_year );
 
ODBC_539: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad2one_year
 
 
ODBC_540: Executed: on connection 2
Prepared statement ODBC_539
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004423
275                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.309078
Total SQL prepare seconds were:                     0.021838
Total SQL describe seconds were:                    0.000491
Total seconds used by the ODBC ACCESS engine were     0.355512
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 135.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.47 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke2one_year PURGE ) BY imp;
 
ODBC_541: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.074671
Total seconds used by the ODBC ACCESS engine were     0.076236
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
index_date_stroke + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= index_date_stroke + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke2one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 
365 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_542: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke2one_year AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= index_date_stroke + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= 
index_date_stroke + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_stroke2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and 
w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and 
w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 365 DAYS group by q.patid, q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  16.000892
Total seconds used by the ODBC ACCESS engine were    16.249990
276                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke2one_year );
 
ODBC_543: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke2one_year
 
 
ODBC_544: Executed: on connection 2
Prepared statement ODBC_543
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005500
Total SQL execution seconds were:                   0.118953
Total SQL prepare seconds were:                     0.019421
Total SQL describe seconds were:                    0.000499
Total seconds used by the ODBC ACCESS engine were     0.166869
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 136.
NOTE: PROCEDURE SQL used (Total process time):
      real time           16.57 seconds
      cpu time            0.20 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2one_year PURGE ) BY imp;
 
ODBC_545: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.103137
Total seconds used by the ODBC ACCESS engine were     0.104863
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then 
w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina 
+ INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_unsta_angina2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_546: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina2one_year AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not 
null and index_date_unsta_angina< w1.dt and w1.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as aphe , 
count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and 
277                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case 
when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct 
case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina2one_year as q left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 
365 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.331652
Total seconds used by the ODBC ACCESS engine were    10.545560
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_unsta_angina2one_year );
 
ODBC_547: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina2one_year
 
 
ODBC_548: Executed: on connection 2
Prepared statement ODBC_547
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004396
Total SQL execution seconds were:                   0.047418
Total SQL prepare seconds were:                     0.020362
Total SQL describe seconds were:                    0.000907
Total seconds used by the ODBC ACCESS engine were     0.094193
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 137.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.17 seconds
      cpu time            0.20 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2one_year PURGE ) BY imp;
 
ODBC_549: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082542
Total seconds used by the ODBC ACCESS engine were     0.084129
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= index_date_sta_angina + INTERVAL 
278                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_sta_angina2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_550: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina2one_year AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null 
and index_date_sta_angina< w1.dt and w1.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case 
when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and 
w2.dt<= index_date_sta_angina + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt 
end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt 
end) as revasc_cnt from dingyig._12_lab1_sta_angina2one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < 
w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 365 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.709205
Total seconds used by the ODBC ACCESS engine were    10.927337
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_sta_angina2one_year );
 
ODBC_551: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina2one_year
 
 
ODBC_552: Executed: on connection 2
Prepared statement ODBC_551
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004444
Total SQL execution seconds were:                   0.048131
Total SQL prepare seconds were:                     0.019942
Total SQL describe seconds were:                    0.000585
Total seconds used by the ODBC ACCESS engine were     0.092018
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 138.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.52 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
279                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia2one_year PURGE ) BY imp;
 
ODBC_553: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_tia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076169
Total seconds used by the ODBC ACCESS engine were     0.077836
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
index_date_tia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia2one_year as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 365 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_554: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia2one_year AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and 
index_date_tia< w1.dt and w1.dt<= index_date_tia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_tia2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 
365 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  17.079909
Total seconds used by the ODBC ACCESS engine were    17.331950
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia2one_year );
 
ODBC_555: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia2one_year
 
 
ODBC_556: Executed: on connection 2
Prepared statement ODBC_555
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004697
Total SQL execution seconds were:                   0.054980
280                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL prepare seconds were:                     0.019296
Total SQL describe seconds were:                    0.000517
Total seconds used by the ODBC ACCESS engine were     0.101705
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 139.
NOTE: PROCEDURE SQL used (Total process time):
      real time           17.58 seconds
      cpu time            0.21 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other2one_year PURGE ) BY imp;
 
ODBC_557: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.136607
Total seconds used by the ODBC ACCESS engine were     0.151080
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
index_date_other + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other2one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + INTERVAL 365 DAYS group 
by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_558: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other2one_year AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= index_date_other + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is 
not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other 
+ INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_other2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS 
left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + 
INTERVAL 365 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.747989
Total seconds used by the ODBC ACCESS engine were    10.985072
 
281                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other2one_year );
 
ODBC_559: Prepared: on connection 2
SELECT 'dingyig._12_proc_other2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other2one_year
 
 
ODBC_560: Executed: on connection 2
Prepared statement ODBC_559
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004686
Total SQL execution seconds were:                   0.156619
Total SQL prepare seconds were:                     0.020304
Total SQL describe seconds were:                    0.000472
Total seconds used by the ODBC ACCESS engine were     0.202394
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 140.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.77 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc2one_year PURGE ) BY imp;
 
ODBC_561: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080594
Total seconds used by the ODBC ACCESS engine were     0.082129
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
index_date_revasc + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= index_date_revasc + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc2one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 
365 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_562: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc2one_year AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= index_date_revasc + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= 
index_date_revasc + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
282                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_revasc2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and 
w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and 
w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 365 DAYS group by q.patid, q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   9.616367
Total seconds used by the ODBC ACCESS engine were     9.826747
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc2one_year );
 
ODBC_563: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc2one_year
 
 
ODBC_564: Executed: on connection 2
Prepared statement ODBC_563
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004162
Total SQL execution seconds were:                   0.055070
Total SQL prepare seconds were:                     0.022276
Total SQL describe seconds were:                    0.000629
Total seconds used by the ODBC ACCESS engine were     0.100932
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 141.
NOTE: PROCEDURE SQL used (Total process time):
      real time           10.43 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd2one_year PURGE ) BY imp;
 
ODBC_565: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075486
Total seconds used by the ODBC ACCESS engine were     0.078086
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
index_date_cvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + INTERVAL 365 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd2one_year as q left join 
283                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 365 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_566: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd2one_year AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and 
index_date_cvd< w1.dt and w1.dt<= index_date_cvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + 
INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_cvd2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 
365 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.197595
Total seconds used by the ODBC ACCESS engine were    10.429805
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd2one_year );
 
ODBC_567: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd2one_year
 
 
ODBC_568: Executed: on connection 2
Prepared statement ODBC_567
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004809
Total SQL execution seconds were:                   0.138427
Total SQL prepare seconds were:                     0.031440
Total SQL describe seconds were:                    0.000577
Total seconds used by the ODBC ACCESS engine were     0.196306
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 142.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.13 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia2one_year PURGE ) BY imp;
 
284                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_569: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078993
Total seconds used by the ODBC ACCESS engine were     0.080470
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= index_date_anginatia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= index_date_anginatia + INTERVAL 
365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_anginatia2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < w2.dt and 
w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_570: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia2one_year AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and 
index_date_anginatia< w1.dt and w1.dt<= index_date_anginatia + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= 
index_date_anginatia + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_anginatia2one_year as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < 
w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 365 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.722085
Total seconds used by the ODBC ACCESS engine were    10.958121
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia2one_year );
 
ODBC_571: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia2one_year
 
 
ODBC_572: Executed: on connection 2
Prepared statement ODBC_571
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004820
Total SQL execution seconds were:                   0.054651
Total SQL prepare seconds were:                     0.020203
Total SQL describe seconds were:                    0.000527
285                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.099636
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 143.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.55 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd2one_year PURGE ) BY imp;
 
ODBC_573: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_noncvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085221
Total seconds used by the ODBC ACCESS engine were     0.088036
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd2one_year AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
index_date_noncvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= index_date_noncvd + INTERVAL 365 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd2one_year as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 
365 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_574: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd2one_year AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= index_date_noncvd + INTERVAL 365 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= 
index_date_noncvd + INTERVAL 365 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_noncvd2one_year as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and 
w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and 
w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 365 DAYS group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.100715
Total seconds used by the ODBC ACCESS engine were    11.333067
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd2one_year );
286                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_575: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd2one_year
 
 
ODBC_576: Executed: on connection 2
Prepared statement ODBC_575
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004792
Total SQL execution seconds were:                   0.049254
Total SQL prepare seconds were:                     0.021042
Total SQL describe seconds were:                    0.000490
Total seconds used by the ODBC ACCESS engine were     0.095287
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 144.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.95 seconds
      cpu time            0.17 seconds
      

WARNING: Apparent symbolic reference AD not resolved.
111        %procs(two_years,  index_date_&ad. + INTERVAL 730 DAYS);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall1two_years PURGE ) BY imp;
 
ODBC_577: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.089010
Total seconds used by the ODBC ACCESS engine were     0.091670
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= index_date_overall + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= index_date_overall + INTERVAL 730 DAYS 
then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null 
then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_overall1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_578: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall1two_years AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
index_date_overall< w1.dt and w1.dt<= index_date_overall + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= 
index_date_overall + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
287                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_overall1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < 
w1.dt and w1.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
w2.dt and w2.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.628273
Total seconds used by the ODBC ACCESS engine were    11.022927
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall1two_years );
 
ODBC_579: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall1two_years
 
 
ODBC_580: Executed: on connection 2
Prepared statement ODBC_579
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004581
Total SQL execution seconds were:                   0.049843
Total SQL prepare seconds were:                     0.019295
Total SQL describe seconds were:                    0.000531
Total seconds used by the ODBC ACCESS engine were     0.093216
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 145.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.63 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi1two_years PURGE ) BY imp;
 
ODBC_581: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_mi1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086939
Total seconds used by the ODBC ACCESS engine were     0.088855
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
index_date_mi + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi1two_years as q left join 
288                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 730 DAYS group by 
q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_582: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi1two_years AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and 
index_date_mi< w1.dt and w1.dt<= index_date_mi + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_mi1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 
730 DAYS group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.198020
Total seconds used by the ODBC ACCESS engine were    10.468702
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi1two_years );
 
ODBC_583: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi1two_years
 
 
ODBC_584: Executed: on connection 2
Prepared statement ODBC_583
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005457
Total SQL execution seconds were:                   0.190152
Total SQL prepare seconds were:                     0.021357
Total SQL describe seconds were:                    0.000479
Total seconds used by the ODBC ACCESS engine were     0.239836
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 146.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.22 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad1two_years PURGE ) BY imp;
 
289                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_585: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078532
Total seconds used by the ODBC ACCESS engine were     0.080228
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
index_date_pad + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad1two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 730 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_586: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad1two_years AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and 
index_date_pad< w1.dt and w1.dt<= index_date_pad + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_pad1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 
730 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.710233
Total seconds used by the ODBC ACCESS engine were    11.153820
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad1two_years );
 
ODBC_587: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad1two_years
 
 
ODBC_588: Executed: on connection 2
Prepared statement ODBC_587
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005349
Total SQL execution seconds were:                   0.201521
Total SQL prepare seconds were:                     0.021377
Total SQL describe seconds were:                    0.000474
290                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.250877
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 147.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.90 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke1two_years PURGE ) BY imp;
 
ODBC_589: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081927
Total seconds used by the ODBC ACCESS engine were     0.085409
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
index_date_stroke + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= index_date_stroke + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke1two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 
730 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_590: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke1two_years AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= index_date_stroke + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= 
index_date_stroke + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_stroke1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < 
w1.dt and w1.dt<=index_date_stroke + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < 
w2.dt and w2.dt<=index_date_stroke + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.580436
Total seconds used by the ODBC ACCESS engine were    10.809325
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke1two_years );
291                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_591: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke1two_years
 
 
ODBC_592: Executed: on connection 2
Prepared statement ODBC_591
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.014882
Total SQL execution seconds were:                   0.144379
Total SQL prepare seconds were:                     0.020066
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.200109
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 148.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.51 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1two_years PURGE ) BY imp;
 
ODBC_593: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075088
Total seconds used by the ODBC ACCESS engine were     0.076759
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then 
w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina 
+ INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_unsta_angina1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_594: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina1two_years AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not 
null and index_date_unsta_angina< w1.dt and w1.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as aphe , 
count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and 
index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case 
when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct 
case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina1two_years as q left join (select * 
292                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 
730 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.681897
Total seconds used by the ODBC ACCESS engine were    11.154993
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_unsta_angina1two_years );
 
ODBC_595: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina1two_years
 
 
ODBC_596: Executed: on connection 2
Prepared statement ODBC_595
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005338
Total SQL execution seconds were:                   0.081337
Total SQL prepare seconds were:                     0.023635
Total SQL describe seconds were:                    0.000895
Total seconds used by the ODBC ACCESS engine were     0.132111
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 149.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.78 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1two_years PURGE ) BY imp;
 
ODBC_597: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078793
Total seconds used by the ODBC ACCESS engine were     0.080440
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= index_date_sta_angina + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_sta_angina1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
293                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_598: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina1two_years AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null 
and index_date_sta_angina< w1.dt and w1.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case 
when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and 
w2.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt 
end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt 
end) as revasc_cnt from dingyig._12_lab1_sta_angina1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < 
w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.488548
Total seconds used by the ODBC ACCESS engine were    10.721501
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_sta_angina1two_years );
 
ODBC_599: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina1two_years
 
 
ODBC_600: Executed: on connection 2
Prepared statement ODBC_599
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.059647
Total SQL execution seconds were:                   0.114187
Total SQL prepare seconds were:                     0.021877
Total SQL describe seconds were:                    0.000492
Total seconds used by the ODBC ACCESS engine were     0.215305
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 150.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.10 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia1two_years PURGE ) BY imp;
 
ODBC_601: Executed: on connection 2
294                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_proc_tia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081764
Total seconds used by the ODBC ACCESS engine were     0.083679
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
index_date_tia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia1two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 730 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_602: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia1two_years AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and 
index_date_tia< w1.dt and w1.dt<= index_date_tia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_tia1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 
730 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.970983
Total seconds used by the ODBC ACCESS engine were    11.193574
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia1two_years );
 
ODBC_603: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia1two_years
 
 
ODBC_604: Executed: on connection 2
Prepared statement ODBC_603
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004382
Total SQL execution seconds were:                   0.051846
Total SQL prepare seconds were:                     0.020352
Total SQL describe seconds were:                    0.000490
Total seconds used by the ODBC ACCESS engine were     0.096422
295                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 151.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.79 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other1two_years PURGE ) BY imp;
 
ODBC_605: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079963
Total seconds used by the ODBC ACCESS engine were     0.081593
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
index_date_other + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other1two_years as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 730 DAYS left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + INTERVAL 730 DAYS group 
by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_606: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other1two_years AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= index_date_other + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is 
not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other 
+ INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_other1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 730 DAYS 
left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + 
INTERVAL 730 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.746939
Total seconds used by the ODBC ACCESS engine were    10.960586
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other1two_years );
 
296                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_607: Prepared: on connection 2
SELECT 'dingyig._12_proc_other1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other1two_years
 
 
ODBC_608: Executed: on connection 2
Prepared statement ODBC_607
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004313
Total SQL execution seconds were:                   0.053849
Total SQL prepare seconds were:                     0.020865
Total SQL describe seconds were:                    0.000482
Total seconds used by the ODBC ACCESS engine were     0.098877
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 152.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.57 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc1two_years PURGE ) BY imp;
 
ODBC_609: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076333
Total seconds used by the ODBC ACCESS engine were     0.079809
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
index_date_revasc + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= index_date_revasc + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc1two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 
730 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_610: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc1two_years AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= index_date_revasc + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= 
index_date_revasc + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_revasc1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < 
297                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w1.dt and w1.dt<=index_date_revasc + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < 
w2.dt and w2.dt<=index_date_revasc + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.639990
Total seconds used by the ODBC ACCESS engine were    10.864798
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc1two_years );
 
ODBC_611: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc1two_years
 
 
ODBC_612: Executed: on connection 2
Prepared statement ODBC_611
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.032159
Total SQL execution seconds were:                   0.147014
Total SQL prepare seconds were:                     0.020726
Total SQL describe seconds were:                    0.000533
Total seconds used by the ODBC ACCESS engine were     0.221468
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 153.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.59 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd1two_years PURGE ) BY imp;
 
ODBC_613: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078130
Total seconds used by the ODBC ACCESS engine were     0.079662
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
index_date_cvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd1two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
298                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 730 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_614: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd1two_years AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and 
index_date_cvd< w1.dt and w1.dt<= index_date_cvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_cvd1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 
730 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.751712
Total seconds used by the ODBC ACCESS engine were    11.000706
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd1two_years );
 
ODBC_615: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd1two_years
 
 
ODBC_616: Executed: on connection 2
Prepared statement ODBC_615
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005016
Total SQL execution seconds were:                   0.050882
Total SQL prepare seconds were:                     0.020275
Total SQL describe seconds were:                    0.000534
Total seconds used by the ODBC ACCESS engine were     0.097499
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 154.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.60 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia1two_years PURGE ) BY imp;
 
ODBC_617: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia1two_years PURGE
 
299                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076124
Total seconds used by the ODBC ACCESS engine were     0.077713
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= index_date_anginatia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= index_date_anginatia + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_anginatia1two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < w2.dt and 
w2.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_618: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia1two_years AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null 
and index_date_anginatia< w1.dt and w1.dt<= index_date_anginatia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= 
index_date_anginatia + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_anginatia1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < 
w1.dt and w1.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.412623
Total seconds used by the ODBC ACCESS engine were    11.858280
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia1two_years );
 
ODBC_619: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia1two_years
 
 
ODBC_620: Executed: on connection 2
Prepared statement ODBC_619
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005057
Total SQL execution seconds were:                   0.051601
Total SQL prepare seconds were:                     0.021435
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.098679
 
MPRINT(CREATE):   QUIT;
300                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 155.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.45 seconds
      cpu time            0.19 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd1two_years PURGE ) BY imp;
 
ODBC_621: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_noncvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077702
Total seconds used by the ODBC ACCESS engine were     0.081116
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd1two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
index_date_noncvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= index_date_noncvd + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd1two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 
730 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_622: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd1two_years AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= index_date_noncvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= 
index_date_noncvd + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_noncvd1two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < 
w1.dt and w1.dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < 
w2.dt and w2.dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.718263
Total seconds used by the ODBC ACCESS engine were    10.946744
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd1two_years );
 
ODBC_623: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd1two_years
301                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_624: Executed: on connection 2
Prepared statement ODBC_623
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.016559
Total SQL execution seconds were:                   0.213284
Total SQL prepare seconds were:                     0.020151
Total SQL describe seconds were:                    0.000504
Total seconds used by the ODBC ACCESS engine were     0.270393
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 156.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.72 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall2two_years PURGE ) BY imp;
 
ODBC_625: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075905
Total seconds used by the ODBC ACCESS engine were     0.077482
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= index_date_overall + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= index_date_overall + INTERVAL 730 DAYS 
then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null 
then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_overall2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_626: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall2two_years AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
index_date_overall< w1.dt and w1.dt<= index_date_overall + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= 
index_date_overall + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_overall2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < 
w1.dt and w1.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
302                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.dt and w2.dt<=index_date_overall + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_overall < s.dt and s.dt<=index_date_overall + INTERVAL 730 DAYS group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.429942
Total seconds used by the ODBC ACCESS engine were    10.659092
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall2two_years );
 
ODBC_627: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall2two_years
 
 
ODBC_628: Executed: on connection 2
Prepared statement ODBC_627
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004297
Total SQL execution seconds were:                   0.051214
Total SQL prepare seconds were:                     0.018487
Total SQL describe seconds were:                    0.000524
Total seconds used by the ODBC ACCESS engine were     0.101714
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 157.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.26 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi2two_years PURGE ) BY imp;
 
ODBC_629: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_mi2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083909
Total seconds used by the ODBC ACCESS engine were     0.085454
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
index_date_mi + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi2two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
303                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 730 DAYS group by 
q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_630: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi2two_years AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and 
index_date_mi< w1.dt and w1.dt<= index_date_mi + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= index_date_mi + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_mi2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=index_date_mi + INTERVAL 
730 DAYS group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.742866
Total seconds used by the ODBC ACCESS engine were    10.982344
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi2two_years );
 
ODBC_631: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi2two_years
 
 
ODBC_632: Executed: on connection 2
Prepared statement ODBC_631
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004920
Total SQL execution seconds were:                   0.219494
Total SQL prepare seconds were:                     0.020746
Total SQL describe seconds were:                    0.000527
Total seconds used by the ODBC ACCESS engine were     0.267448
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 158.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.75 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad2two_years PURGE ) BY imp;
 
ODBC_633: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad2two_years PURGE
 
 
Summary Statistics for ODBC are:
304                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.075699
Total seconds used by the ODBC ACCESS engine were     0.077296
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
index_date_pad + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad2two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 730 DAYS group by 
q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_634: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad2two_years AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and 
index_date_pad< w1.dt and w1.dt<= index_date_pad + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= index_date_pad + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_pad2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=index_date_pad + INTERVAL 
730 DAYS group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.080534
Total seconds used by the ODBC ACCESS engine were    11.300198
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad2two_years );
 
ODBC_635: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad2two_years
 
 
ODBC_636: Executed: on connection 2
Prepared statement ODBC_635
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004368
Total SQL execution seconds were:                   0.536060
Total SQL prepare seconds were:                     0.019727
Total SQL describe seconds were:                    0.000921
Total seconds used by the ODBC ACCESS engine were     0.583018
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 159.
NOTE: PROCEDURE SQL used (Total process time):
305                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      real time           12.40 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke2two_years PURGE ) BY imp;
 
ODBC_637: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.444628
Total seconds used by the ODBC ACCESS engine were     0.446310
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
index_date_stroke + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= index_date_stroke + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke2two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 
730 DAYS group by q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_638: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke2two_years AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= index_date_stroke + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= 
index_date_stroke + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_stroke2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < 
w1.dt and w1.dt<=index_date_stroke + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < 
w2.dt and w2.dt<=index_date_stroke + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_stroke < s.dt and s.dt<=index_date_stroke + INTERVAL 730 DAYS group by q.patid, q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.650111
Total seconds used by the ODBC ACCESS engine were    10.876129
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke2two_years );
 
ODBC_639: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke2two_years
 
 
306                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_640: Executed: on connection 2
Prepared statement ODBC_639
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004833
Total SQL execution seconds were:                   0.057866
Total SQL prepare seconds were:                     0.020869
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.104438
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 160.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.84 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2two_years PURGE ) BY imp;
 
ODBC_641: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079205
Total seconds used by the ODBC ACCESS engine were     0.080833
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then 
w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina 
+ INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_unsta_angina2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_642: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina2two_years AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not 
null and index_date_unsta_angina< w1.dt and w1.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as aphe , 
count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and 
index_date_unsta_angina< w2.dt and w2.dt<= index_date_unsta_angina + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case 
when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct 
case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina2two_years as q left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
307                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=index_date_unsta_angina + INTERVAL 
730 DAYS group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.545658
Total seconds used by the ODBC ACCESS engine were    10.772538
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_unsta_angina2two_years );
 
ODBC_643: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina2two_years
 
 
ODBC_644: Executed: on connection 2
Prepared statement ODBC_643
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004751
Total SQL execution seconds were:                   0.051091
Total SQL prepare seconds were:                     0.021475
Total SQL describe seconds were:                    0.000529
Total seconds used by the ODBC ACCESS engine were     0.097954
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 161.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.37 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2two_years PURGE ) BY imp;
 
ODBC_645: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077228
Total seconds used by the ODBC ACCESS engine were     0.078820
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= index_date_sta_angina + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_sta_angina2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 
and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
308                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_646: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina2two_years AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null 
and index_date_sta_angina< w1.dt and w1.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case 
when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and 
w2.dt<= index_date_sta_angina + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt 
end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt 
end) as revasc_cnt from dingyig._12_lab1_sta_angina2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < 
w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_sta_angina < s.dt and s.dt<=index_date_sta_angina + INTERVAL 730 DAYS group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.120026
Total seconds used by the ODBC ACCESS engine were    11.346755
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_proc_sta_angina2two_years );
 
ODBC_647: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina2two_years
 
 
ODBC_648: Executed: on connection 2
Prepared statement ODBC_647
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004555
Total SQL execution seconds were:                   0.050147
Total SQL prepare seconds were:                     0.021127
Total SQL describe seconds were:                    0.000536
Total seconds used by the ODBC ACCESS engine were     0.097250
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 162.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.94 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia2two_years PURGE ) BY imp;
 
ODBC_649: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_tia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080218
309                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.081761
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
index_date_tia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia2two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 730 DAYS group by 
q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_650: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia2two_years AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and 
index_date_tia< w1.dt and w1.dt<= index_date_tia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= index_date_tia + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_tia2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=index_date_tia + INTERVAL 
730 DAYS group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.200144
Total seconds used by the ODBC ACCESS engine were    11.449453
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia2two_years );
 
ODBC_651: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia2two_years
 
 
ODBC_652: Executed: on connection 2
Prepared statement ODBC_651
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005603
Total SQL execution seconds were:                   0.463063
Total SQL prepare seconds were:                     0.020607
Total SQL describe seconds were:                    0.000522
Total seconds used by the ODBC ACCESS engine were     0.514922
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 163.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.46 seconds
310                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other2two_years PURGE ) BY imp;
 
ODBC_653: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082555
Total seconds used by the ODBC ACCESS engine were     0.084406
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
index_date_other + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other2two_years as 
q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 730 DAYS left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + INTERVAL 730 DAYS group 
by q.patid, q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_654: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other2two_years AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= index_date_other + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is 
not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= index_date_other 
+ INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_other2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=index_date_other + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 730 DAYS 
left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=index_date_other + 
INTERVAL 730 DAYS group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.335814
Total seconds used by the ODBC ACCESS engine were    11.576556
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other2two_years );
 
ODBC_655: Prepared: on connection 2
SELECT 'dingyig._12_proc_other2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other2two_years
 
 
ODBC_656: Executed: on connection 2
311                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_655
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004819
Total SQL execution seconds were:                   0.062278
Total SQL prepare seconds were:                     0.021166
Total SQL describe seconds were:                    0.000669
Total seconds used by the ODBC ACCESS engine were     0.108857
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 164.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.20 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc2two_years PURGE ) BY imp;
 
ODBC_657: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076849
Total seconds used by the ODBC ACCESS engine were     0.078738
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
index_date_revasc + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= index_date_revasc + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc2two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 
730 DAYS group by q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_658: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc2two_years AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= index_date_revasc + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= 
index_date_revasc + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_revasc2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < 
w1.dt and w1.dt<=index_date_revasc + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < 
w2.dt and w2.dt<=index_date_revasc + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_revasc < s.dt and s.dt<=index_date_revasc + INTERVAL 730 DAYS group by q.patid, q.index_date_revasc
312                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.448970
Total seconds used by the ODBC ACCESS engine were    10.685874
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc2two_years );
 
ODBC_659: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc2two_years
 
 
ODBC_660: Executed: on connection 2
Prepared statement ODBC_659
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004897
Total SQL execution seconds were:                   0.185188
Total SQL prepare seconds were:                     0.020963
Total SQL describe seconds were:                    0.000522
Total seconds used by the ODBC ACCESS engine were     0.232012
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 165.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.09 seconds
      cpu time            0.16 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd2two_years PURGE ) BY imp;
 
ODBC_661: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086264
Total seconds used by the ODBC ACCESS engine were     0.157304
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
index_date_cvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt 
, max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + INTERVAL 730 DAYS then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd2two_years as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 730 DAYS left join (select * 
from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 730 DAYS left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 730 DAYS group by 
q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
313                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_662: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd2two_years AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and 
index_date_cvd< w1.dt and w1.dt<= index_date_cvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not 
null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= index_date_cvd + 
INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when 
s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_cvd2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 730 DAYS left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=index_date_cvd + INTERVAL 
730 DAYS group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  13.496219
Total seconds used by the ODBC ACCESS engine were    13.722401
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd2two_years );
 
ODBC_663: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd2two_years
 
 
ODBC_664: Executed: on connection 2
Prepared statement ODBC_663
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004447
Total SQL execution seconds were:                   0.321044
Total SQL prepare seconds were:                     0.019953
Total SQL describe seconds were:                    0.000478
Total seconds used by the ODBC ACCESS engine were     0.366159
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 166.
NOTE: PROCEDURE SQL used (Total process time):
      real time           14.66 seconds
      cpu time            0.19 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia2two_years PURGE ) BY imp;
 
ODBC_665: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084630
Total seconds used by the ODBC ACCESS engine were     0.086253
 
314                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= index_date_anginatia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= index_date_anginatia + INTERVAL 
730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is 
not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from 
dingyig._12_lab1_anginatia2two_years as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < w2.dt and 
w2.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_666: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia2two_years AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null 
and index_date_anginatia< w1.dt and w1.dt<= index_date_anginatia + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when 
w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= 
index_date_anginatia + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_anginatia2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < 
w1.dt and w1.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=index_date_anginatia + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) 
>= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_anginatia < s.dt and s.dt<=index_date_anginatia + INTERVAL 730 DAYS group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.310611
Total seconds used by the ODBC ACCESS engine were    10.523714
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia2two_years );
 
ODBC_667: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia2two_years
 
 
ODBC_668: Executed: on connection 2
Prepared statement ODBC_667
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004293
Total SQL execution seconds were:                   0.050201
Total SQL prepare seconds were:                     0.019926
Total SQL describe seconds were:                    0.000538
Total seconds used by the ODBC ACCESS engine were     0.095338
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 167.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.12 seconds
      cpu time            0.15 seconds
      
315                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM


MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd2two_years PURGE ) BY imp;
 
ODBC_669: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_noncvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076215
Total seconds used by the ODBC ACCESS engine were     0.078820
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd2two_years AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
index_date_noncvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as 
aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= index_date_noncvd + INTERVAL 730 DAYS then 1 
end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 
end) as revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd2two_years 
as q left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on 
q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 730 DAYS left join 
(select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct 
code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 
730 DAYS group by q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_670: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd2two_years AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= index_date_noncvd + INTERVAL 730 DAYS then 1 end) as aphe , count(distinct case when w1.patid 
is not null then w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= 
index_date_noncvd + INTERVAL 730 DAYS then 1 end) as dial , count(distinct case when w2.patid is not null then w2.dt end) as 
dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null then s.dt end) as 
revasc_cnt from dingyig._12_lab1_noncvd2two_years as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < 
w1.dt and w1.dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < 
w2.dt and w2.dt<=index_date_noncvd + INTERVAL 730 DAYS left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_noncvd < s.dt and s.dt<=index_date_noncvd + INTERVAL 730 DAYS group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.940208
Total seconds used by the ODBC ACCESS engine were    11.153005
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd2two_years );
 
ODBC_671: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd2two_years
 
 
ODBC_672: Executed: on connection 2
Prepared statement ODBC_671
 
316                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004474
Total SQL execution seconds were:                   0.260836
Total SQL prepare seconds were:                     0.018464
Total SQL describe seconds were:                    0.000492
Total seconds used by the ODBC ACCESS engine were     0.304923
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 168.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.61 seconds
      cpu time            0.19 seconds
      

112        %procs(all, q.eligend);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall1all PURGE ) BY imp;
 
ODBC_673: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.073934
Total seconds used by the ODBC ACCESS engine were     0.075478
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall1all AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_overall< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is 
not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid 
is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_overall1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_overall < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_overall < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_674: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall1all AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
index_date_overall< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_overall1all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_overall < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_overall < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
317                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  10.930423
Total seconds used by the ODBC ACCESS engine were    11.139751
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall1all );
 
ODBC_675: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall1all
 
 
ODBC_676: Executed: on connection 2
Prepared statement ODBC_675
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.023064
Total SQL execution seconds were:                   0.096641
Total SQL prepare seconds were:                     0.019524
Total SQL describe seconds were:                    0.000531
Total seconds used by the ODBC ACCESS engine were     0.158886
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 169.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.45 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi1all PURGE ) BY imp;
 
ODBC_677: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_mi1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.073969
Total seconds used by the ODBC ACCESS engine were     0.075502
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi1all AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_mi< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null then 
w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null 
then s.dt end) as revasc_cnt from dingyig._12_lab1_mi1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_678: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi1all AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
318                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.969477
Total seconds used by the ODBC ACCESS engine were    11.174423
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi1all );
 
ODBC_679: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi1all
 
 
ODBC_680: Executed: on connection 2
Prepared statement ODBC_679
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.058979
Total SQL execution seconds were:                   0.139971
Total SQL prepare seconds were:                     0.018902
Total SQL describe seconds were:                    0.000473
Total seconds used by the ODBC ACCESS engine were     0.238320
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 170.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.56 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad1all PURGE ) BY imp;
 
ODBC_681: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080526
Total seconds used by the ODBC ACCESS engine were     0.082054
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad1all AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_pad< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad1all as q left join (select * from dingyig.optum2_01_other_proc where 
319                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_682: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad1all AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.669484
Total seconds used by the ODBC ACCESS engine were    10.897217
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad1all );
 
ODBC_683: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad1all
 
 
ODBC_684: Executed: on connection 2
Prepared statement ODBC_683
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004548
Total SQL execution seconds were:                   0.047640
Total SQL prepare seconds were:                     0.019776
Total SQL describe seconds were:                    0.000502
Total seconds used by the ODBC ACCESS engine were     0.093930
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 171.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.49 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke1all PURGE ) BY imp;
 
ODBC_685: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke1all PURGE
 
320                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.073974
Total seconds used by the ODBC ACCESS engine were     0.076450
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke1all AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_stroke< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_686: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke1all AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke1all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_stroke
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.715964
Total seconds used by the ODBC ACCESS engine were    10.925327
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke1all );
 
ODBC_687: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke1all
 
 
ODBC_688: Executed: on connection 2
Prepared statement ODBC_687
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004266
Total SQL execution seconds were:                   0.050185
Total SQL prepare seconds were:                     0.019784
Total SQL describe seconds were:                    0.000520
Total seconds used by the ODBC ACCESS engine were     0.092319
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 172.
NOTE: PROCEDURE SQL used (Total process time):
321                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      real time           11.52 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1all PURGE ) BY imp;
 
ODBC_689: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075947
Total seconds used by the ODBC ACCESS engine were     0.077628
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina1all AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case 
when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc 
where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and 
q.index_date_unsta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_690: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina1all AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null 
and index_date_unsta_angina< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then 
w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as 
dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as 
revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina1all as q left 
join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.898317
Total seconds used by the ODBC ACCESS engine were    11.128424
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_unsta_angina1all );
 
ODBC_691: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina1all
 
 
ODBC_692: Executed: on connection 2
Prepared statement ODBC_691
322                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004695
Total SQL execution seconds were:                   0.049890
Total SQL prepare seconds were:                     0.022280
Total SQL describe seconds were:                    0.000545
Total seconds used by the ODBC ACCESS engine were     0.097117
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 173.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.72 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1all PURGE ) BY imp;
 
ODBC_693: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077589
Total seconds used by the ODBC ACCESS engine were     0.079209
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina1all AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid 
is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when 
s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_sta_angina1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_sta_angina < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_sta_angina < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_694: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina1all AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and 
index_date_sta_angina< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_sta_angina1all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_sta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_sta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
323                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  11.110818
Total seconds used by the ODBC ACCESS engine were    11.336642
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_sta_angina1all );
 
ODBC_695: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina1all
 
 
ODBC_696: Executed: on connection 2
Prepared statement ODBC_695
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.078960
Total SQL execution seconds were:                   0.100103
Total SQL prepare seconds were:                     0.022175
Total SQL describe seconds were:                    0.000557
Total seconds used by the ODBC ACCESS engine were     0.222599
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 174.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.06 seconds
      cpu time            0.32 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia1all PURGE ) BY imp;
 
ODBC_697: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_tia1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.102236
Total seconds used by the ODBC ACCESS engine were     0.103834
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia1all AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_tia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_698: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia1all AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
324                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.754588
Total seconds used by the ODBC ACCESS engine were    11.966442
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia1all );
 
ODBC_699: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia1all
 
 
ODBC_700: Executed: on connection 2
Prepared statement ODBC_699
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004540
Total SQL execution seconds were:                   0.152418
Total SQL prepare seconds were:                     0.020292
Total SQL describe seconds were:                    0.000530
Total seconds used by the ODBC ACCESS engine were     0.197687
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 175.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.69 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other1all PURGE ) BY imp;
 
ODBC_701: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086125
Total seconds used by the ODBC ACCESS engine were     0.087662
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other1all AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_other< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_other1all as q left join (select * from dingyig.optum2_01_other_proc where 
325                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=q.eligend group by q.patid, 
q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_702: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other1all AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other1all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.098439
Total seconds used by the ODBC ACCESS engine were    11.330219
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other1all );
 
ODBC_703: Prepared: on connection 2
SELECT 'dingyig._12_proc_other1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other1all
 
 
ODBC_704: Executed: on connection 2
Prepared statement ODBC_703
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.010561
Total SQL execution seconds were:                   0.623083
Total SQL prepare seconds were:                     0.022158
Total SQL describe seconds were:                    0.000483
Total seconds used by the ODBC ACCESS engine were     0.679245
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 176.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.52 seconds
      cpu time            0.33 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc1all PURGE ) BY imp;
 
ODBC_705: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc1all PURGE
326                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.091686
Total seconds used by the ODBC ACCESS engine were     0.093273
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc1all AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_revasc< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_706: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc1all AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc1all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_revasc
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.611336
Total seconds used by the ODBC ACCESS engine were    10.884740
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc1all );
 
ODBC_707: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc1all
 
 
ODBC_708: Executed: on connection 2
Prepared statement ODBC_707
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004350
Total SQL execution seconds were:                   0.052065
Total SQL prepare seconds were:                     0.022158
Total SQL describe seconds were:                    0.000501
Total seconds used by the ODBC ACCESS engine were     0.099627
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 177.
327                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           11.49 seconds
      cpu time            0.30 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd1all PURGE ) BY imp;
 
ODBC_709: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.093386
Total seconds used by the ODBC ACCESS engine were     0.094949
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd1all AS
MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_cvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_710: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd1all AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.924750
Total seconds used by the ODBC ACCESS engine were    11.165038
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd1all );
 
ODBC_711: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd1all
 
 
ODBC_712: Executed: on connection 2
Prepared statement ODBC_711
328                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004583
Total SQL execution seconds were:                   0.055866
Total SQL prepare seconds were:                     0.020949
Total SQL describe seconds were:                    0.000630
Total seconds used by the ODBC ACCESS engine were     0.104065
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 178.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.79 seconds
      cpu time            0.32 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia1all PURGE ) BY imp;
 
ODBC_713: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081086
Total seconds used by the ODBC ACCESS engine were     0.082597
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia1all AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid 
is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when 
s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_anginatia1all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_anginatia < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_anginatia < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_714: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia1all AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and 
index_date_anginatia< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_anginatia1all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_anginatia < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_anginatia < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
329                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  11.142182
Total seconds used by the ODBC ACCESS engine were    11.372638
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia1all );
 
ODBC_715: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia1all
 
 
ODBC_716: Executed: on connection 2
Prepared statement ODBC_715
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004739
Total SQL execution seconds were:                   0.049306
Total SQL prepare seconds were:                     0.020098
Total SQL describe seconds were:                    0.000502
Total seconds used by the ODBC ACCESS engine were     0.094137
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 179.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.96 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd1all PURGE ) BY imp;
 
ODBC_717: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_noncvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.074180
Total seconds used by the ODBC ACCESS engine were     0.075873
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd1all AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_noncvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd1all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_718: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd1all AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
330                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd1all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.309291
Total seconds used by the ODBC ACCESS engine were    11.520209
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd1all );
 
ODBC_719: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd1all
 
 
ODBC_720: Executed: on connection 2
Prepared statement ODBC_719
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004477
Total SQL execution seconds were:                   0.183634
Total SQL prepare seconds were:                     0.019739
Total SQL describe seconds were:                    0.000483
Total seconds used by the ODBC ACCESS engine were     0.227481
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 180.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.26 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_overall2all PURGE ) BY imp;
 
ODBC_721: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_overall2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080760
Total seconds used by the ODBC ACCESS engine were     0.082454
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_overall2all AS
MPRINT(PROCS):   select q.patid, q.index_date_overall , max(case when w1.patid is not null and index_date_overall< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_overall< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is 
not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid 
331                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_overall2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_overall < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_overall < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_overall < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_overall
MPRINT(CREATE):   ) BY imp;
 
ODBC_722: Executed: on connection 2
CREATE TABLE dingyig._12_proc_overall2all AS select q.patid, q.index_date_overall , max(case when w1.patid is not null and 
index_date_overall< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_overall< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_overall2all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_overall < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_overall < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_overall < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_overall
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.555863
Total seconds used by the ODBC ACCESS engine were    10.788942
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_overall2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_overall2all );
 
ODBC_723: Prepared: on connection 2
SELECT 'dingyig._12_proc_overall2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_overall2all
 
 
ODBC_724: Executed: on connection 2
Prepared statement ODBC_723
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004932
Total SQL execution seconds were:                   0.049419
Total SQL prepare seconds were:                     0.019597
Total SQL describe seconds were:                    0.000539
Total seconds used by the ODBC ACCESS engine were     0.093767
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 181.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.39 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_mi2all PURGE ) BY imp;
 
ODBC_725: Executed: on connection 2
332                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_proc_mi2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080809
Total seconds used by the ODBC ACCESS engine were     0.082608
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_mi2all AS
MPRINT(PROCS):   select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_mi< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null then 
w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not null 
then s.dt end) as revasc_cnt from dingyig._12_lab1_mi2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_mi < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_mi
MPRINT(CREATE):   ) BY imp;
 
ODBC_726: Executed: on connection 2
CREATE TABLE dingyig._12_proc_mi2all AS select q.patid, q.index_date_mi , max(case when w1.patid is not null and index_date_mi< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_mi< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_mi2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_mi < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_mi < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_mi < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_mi
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.806889
Total seconds used by the ODBC ACCESS engine were    11.264379
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_mi2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_mi2all );
 
ODBC_727: Prepared: on connection 2
SELECT 'dingyig._12_proc_mi2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_mi2all
 
 
ODBC_728: Executed: on connection 2
Prepared statement ODBC_727
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005173
Total SQL execution seconds were:                   0.160689
Total SQL prepare seconds were:                     0.026320
Total SQL describe seconds were:                    0.000508
Total seconds used by the ODBC ACCESS engine were     0.214528
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 182.
333                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           11.98 seconds
      cpu time            0.30 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_pad2all PURGE ) BY imp;
 
ODBC_729: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_pad2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.079278
Total seconds used by the ODBC ACCESS engine were     0.080781
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_pad2all AS
MPRINT(PROCS):   select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_pad< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_pad < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_pad
MPRINT(CREATE):   ) BY imp;
 
ODBC_730: Executed: on connection 2
CREATE TABLE dingyig._12_proc_pad2all AS select q.patid, q.index_date_pad , max(case when w1.patid is not null and index_date_pad< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_pad< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_pad2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_pad < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_pad < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_pad < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_pad
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.447472
Total seconds used by the ODBC ACCESS engine were    10.692813
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_pad2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_pad2all );
 
ODBC_731: Prepared: on connection 2
SELECT 'dingyig._12_proc_pad2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_pad2all
 
 
ODBC_732: Executed: on connection 2
Prepared statement ODBC_731
334                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005676
Total SQL execution seconds were:                   0.392609
Total SQL prepare seconds were:                     0.026863
Total SQL describe seconds were:                    0.000477
Total seconds used by the ODBC ACCESS engine were     0.448125
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 183.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.63 seconds
      cpu time            0.30 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_stroke2all PURGE ) BY imp;
 
ODBC_733: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_stroke2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075984
Total seconds used by the ODBC ACCESS engine were     0.078641
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_stroke2all AS
MPRINT(PROCS):   select q.patid, q.index_date_stroke , max(case when w1.patid is not null and index_date_stroke< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_stroke< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_stroke < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_stroke
MPRINT(CREATE):   ) BY imp;
 
ODBC_734: Executed: on connection 2
CREATE TABLE dingyig._12_proc_stroke2all AS select q.patid, q.index_date_stroke , max(case when w1.patid is not null and 
index_date_stroke< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_stroke< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_stroke2all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_stroke < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_stroke < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_stroke < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_stroke
 
 
Summary Statistics for ODBC are:
335                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                  11.146291
Total seconds used by the ODBC ACCESS engine were    11.385788
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_stroke2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_stroke2all );
 
ODBC_735: Prepared: on connection 2
SELECT 'dingyig._12_proc_stroke2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_stroke2all
 
 
ODBC_736: Executed: on connection 2
Prepared statement ODBC_735
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004378
Total SQL execution seconds were:                   0.050001
Total SQL prepare seconds were:                     0.020954
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.095326
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 184.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.98 seconds
      cpu time            0.32 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2all PURGE ) BY imp;
 
ODBC_737: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_unsta_angina2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.074076
Total seconds used by the ODBC ACCESS engine were     0.075688
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_unsta_angina2all AS
MPRINT(PROCS):   select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null and index_date_unsta_angina< w1.dt 
and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case 
when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc 
where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and 
q.index_date_unsta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 
2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and 
q.index_date_unsta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_unsta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_738: Executed: on connection 2
CREATE TABLE dingyig._12_proc_unsta_angina2all AS select q.patid, q.index_date_unsta_angina , max(case when w1.patid is not null 
and index_date_unsta_angina< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then 
336                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w1.dt end) as aphe_cnt , max(case when w2.patid is not null and index_date_unsta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as 
dial , count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as 
revasc , count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_unsta_angina2all as q left 
join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_unsta_angina < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_unsta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_unsta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_unsta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.797035
Total seconds used by the ODBC ACCESS engine were    11.023103
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_unsta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_unsta_angina2all );
 
ODBC_739: Prepared: on connection 2
SELECT 'dingyig._12_proc_unsta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_unsta_angina2all
 
 
ODBC_740: Executed: on connection 2
Prepared statement ODBC_739
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004680
Total SQL execution seconds were:                   0.049810
Total SQL prepare seconds were:                     0.019774
Total SQL describe seconds were:                    0.000611
Total seconds used by the ODBC ACCESS engine were     0.094367
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 185.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.60 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2all PURGE ) BY imp;
 
ODBC_741: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_sta_angina2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077478
Total seconds used by the ODBC ACCESS engine were     0.079054
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_sta_angina2all AS
MPRINT(PROCS):   select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and index_date_sta_angina< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid 
is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when 
337                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_sta_angina2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_sta_angina < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_sta_angina < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_sta_angina < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_sta_angina
MPRINT(CREATE):   ) BY imp;
 
ODBC_742: Executed: on connection 2
CREATE TABLE dingyig._12_proc_sta_angina2all AS select q.patid, q.index_date_sta_angina , max(case when w1.patid is not null and 
index_date_sta_angina< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_sta_angina< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_sta_angina2all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_sta_angina < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_sta_angina < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_sta_angina < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_sta_angina
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.264269
Total seconds used by the ODBC ACCESS engine were    11.510986
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_sta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_sta_angina2all );
 
ODBC_743: Prepared: on connection 2
SELECT 'dingyig._12_proc_sta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_sta_angina2all
 
 
ODBC_744: Executed: on connection 2
Prepared statement ODBC_743
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004798
Total SQL execution seconds were:                   0.050254
Total SQL prepare seconds were:                     0.019071
Total SQL describe seconds were:                    0.000496
Total seconds used by the ODBC ACCESS engine were     0.096265
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 186.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.10 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_tia2all PURGE ) BY imp;
 
ODBC_745: Executed: on connection 2
338                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_proc_tia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.076799
Total seconds used by the ODBC ACCESS engine were     0.078479
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_tia2all AS
MPRINT(PROCS):   select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_tia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_tia < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_tia
MPRINT(CREATE):   ) BY imp;
 
ODBC_746: Executed: on connection 2
CREATE TABLE dingyig._12_proc_tia2all AS select q.patid, q.index_date_tia , max(case when w1.patid is not null and index_date_tia< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
max(case when w2.patid is not null and index_date_tia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_tia2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_tia < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_tia < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_tia < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_tia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.336558
Total seconds used by the ODBC ACCESS engine were    11.575015
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_tia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_tia2all );
 
ODBC_747: Prepared: on connection 2
SELECT 'dingyig._12_proc_tia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_tia2all
 
 
ODBC_748: Executed: on connection 2
Prepared statement ODBC_747
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004460
Total SQL execution seconds were:                   0.049601
Total SQL prepare seconds were:                     0.020297
Total SQL describe seconds were:                    0.000482
Total seconds used by the ODBC ACCESS engine were     0.093969
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 187.
339                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           12.16 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_other2all PURGE ) BY imp;
 
ODBC_749: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_other2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084924
Total seconds used by the ODBC ACCESS engine were     0.086430
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_other2all AS
MPRINT(PROCS):   select q.patid, q.index_date_other , max(case when w1.patid is not null and index_date_other< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_other< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_other2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_other < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and s.dt<=q.eligend group by q.patid, 
q.index_date_other
MPRINT(CREATE):   ) BY imp;
 
ODBC_750: Executed: on connection 2
CREATE TABLE dingyig._12_proc_other2all AS select q.patid, q.index_date_other , max(case when w1.patid is not null and 
index_date_other< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_other< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_other2all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_other < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_other < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_other < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_other
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.553262
Total seconds used by the ODBC ACCESS engine were    10.780580
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_other2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_other2all );
 
ODBC_751: Prepared: on connection 2
SELECT 'dingyig._12_proc_other2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_other2all
 
 
ODBC_752: Executed: on connection 2
340                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_751
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005250
Total SQL execution seconds were:                   0.146358
Total SQL prepare seconds were:                     0.019570
Total SQL describe seconds were:                    0.000515
Total seconds used by the ODBC ACCESS engine were     0.192347
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 188.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.48 seconds
      cpu time            0.30 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_revasc2all PURGE ) BY imp;
 
ODBC_753: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_revasc2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.077752
Total seconds used by the ODBC ACCESS engine were     0.079417
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_revasc2all AS
MPRINT(PROCS):   select q.patid, q.index_date_revasc , max(case when w1.patid is not null and index_date_revasc< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_revasc< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_revasc < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_revasc
MPRINT(CREATE):   ) BY imp;
 
ODBC_754: Executed: on connection 2
CREATE TABLE dingyig._12_proc_revasc2all AS select q.patid, q.index_date_revasc , max(case when w1.patid is not null and 
index_date_revasc< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_revasc< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_revasc2all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_revasc < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_revasc < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_revasc < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_revasc
 
 
341                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.829649
Total seconds used by the ODBC ACCESS engine were    11.075168
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_revasc2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_revasc2all );
 
ODBC_755: Prepared: on connection 2
SELECT 'dingyig._12_proc_revasc2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_revasc2all
 
 
ODBC_756: Executed: on connection 2
Prepared statement ODBC_755
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004555
Total SQL execution seconds were:                   0.065827
Total SQL prepare seconds were:                     0.019828
Total SQL describe seconds were:                    0.000547
Total seconds used by the ODBC ACCESS engine were     0.110244
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 189.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.68 seconds
      cpu time            0.29 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_cvd2all PURGE ) BY imp;
 
ODBC_757: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_cvd2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.101938
Total seconds used by the ODBC ACCESS engine were     0.103471
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_cvd2all AS
MPRINT(PROCS):   select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_cvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_cvd < w1.dt 
and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt and w2.dt<=q.eligend left join (select * from 
dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from 
dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_cvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_758: Executed: on connection 2
CREATE TABLE dingyig._12_proc_cvd2all AS select q.patid, q.index_date_cvd , max(case when w1.patid is not null and index_date_cvd< 
w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , 
342                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

max(case when w2.patid is not null and index_date_cvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when 
w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case 
when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_cvd2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_cvd < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_cvd < w2.dt 
and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 
and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_cvd < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_cvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.701907
Total seconds used by the ODBC ACCESS engine were    10.951817
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_cvd2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_cvd2all );
 
ODBC_759: Prepared: on connection 2
SELECT 'dingyig._12_proc_cvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_cvd2all
 
 
ODBC_760: Executed: on connection 2
Prepared statement ODBC_759
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004773
Total SQL execution seconds were:                   0.052743
Total SQL prepare seconds were:                     0.018452
Total SQL describe seconds were:                    0.000511
Total seconds used by the ODBC ACCESS engine were     0.095926
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 190.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.57 seconds
      cpu time            0.29 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_anginatia2all PURGE ) BY imp;
 
ODBC_761: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_proc_anginatia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.646270
Total seconds used by the ODBC ACCESS engine were     0.647814
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_anginatia2all AS
MPRINT(PROCS):   select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and index_date_anginatia< w1.dt and 
w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when 
w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid 
is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when 
343                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_anginatia2all as q left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_anginatia < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_anginatia < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_anginatia < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_anginatia
MPRINT(CREATE):   ) BY imp;
 
ODBC_762: Executed: on connection 2
CREATE TABLE dingyig._12_proc_anginatia2all AS select q.patid, q.index_date_anginatia , max(case when w1.patid is not null and 
index_date_anginatia< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt 
end) as aphe_cnt , max(case when w2.patid is not null and index_date_anginatia< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_anginatia2all as q left join 
(select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on 
q.patid=w1.patid and w1.grp="aphe" and q.index_date_anginatia < w1.dt and w1.dt<=q.eligend left join (select * from 
dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and 
w2.grp="dial" and q.index_date_anginatia < w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on 
q.patid=s.patid and q.index_date_anginatia < s.dt and s.dt<=q.eligend group by q.patid, q.index_date_anginatia
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.254779
Total seconds used by the ODBC ACCESS engine were    11.487039
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_anginatia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_anginatia2all );
 
ODBC_763: Prepared: on connection 2
SELECT 'dingyig._12_proc_anginatia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_anginatia2all
 
 
ODBC_764: Executed: on connection 2
Prepared statement ODBC_763
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.019611
Total SQL execution seconds were:                   0.288236
Total SQL prepare seconds were:                     0.019875
Total SQL describe seconds were:                    0.000506
Total seconds used by the ODBC ACCESS engine were     0.349446
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 191.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.92 seconds
      cpu time            0.31 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_proc_noncvd2all PURGE ) BY imp;
 
ODBC_765: Executed: on connection 2
344                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_proc_noncvd2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078944
Total seconds used by the ODBC ACCESS engine were     0.080541
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_proc_noncvd2all AS
MPRINT(PROCS):   select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and index_date_noncvd< w1.dt and w1.dt<= 
q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) as aphe_cnt , max(case when w2.patid 
is not null and index_date_noncvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , count(distinct case when w2.patid is not null 
then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc , count(distinct case when s.patid is not 
null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd2all as q left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and w1.grp="aphe" and q.index_date_noncvd < 
w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and 
year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < w2.dt and w2.dt<=q.eligend left 
join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019 and code in (select 
distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and s.dt<=q.eligend group by 
q.patid, q.index_date_noncvd
MPRINT(CREATE):   ) BY imp;
 
ODBC_766: Executed: on connection 2
CREATE TABLE dingyig._12_proc_noncvd2all AS select q.patid, q.index_date_noncvd , max(case when w1.patid is not null and 
index_date_noncvd< w1.dt and w1.dt<= q.eligend then 1 end) as aphe , count(distinct case when w1.patid is not null then w1.dt end) 
as aphe_cnt , max(case when w2.patid is not null and index_date_noncvd< w2.dt and w2.dt<= q.eligend then 1 end) as dial , 
count(distinct case when w2.patid is not null then w2.dt end) as dial_cnt , max(case when s.patid is not null then 1 end) as revasc 
, count(distinct case when s.patid is not null then s.dt end) as revasc_cnt from dingyig._12_lab1_noncvd2all as q left join (select 
* from dingyig.optum2_01_other_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w1 on q.patid=w1.patid and 
w1.grp="aphe" and q.index_date_noncvd < w1.dt and w1.dt<=q.eligend left join (select * from dingyig.optum2_01_other_proc where 
year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 2019) as w2 on q.patid=w2.patid and w2.grp="dial" and q.index_date_noncvd < 
w2.dt and w2.dt<=q.eligend left join (select * from dingyig.optum2_01_proc where year(to_date(dt)) >= 2007 and year(to_date(dt)) <= 
2019 and code in (select distinct code from dingyig.optum2_01_proc)) as s on q.patid=s.patid and q.index_date_noncvd < s.dt and 
s.dt<=q.eligend group by q.patid, q.index_date_noncvd
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.500546
Total seconds used by the ODBC ACCESS engine were    11.717641
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_proc_noncvd2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_proc_noncvd2all );
 
ODBC_767: Prepared: on connection 2
SELECT 'dingyig._12_proc_noncvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_proc_noncvd2all
 
 
ODBC_768: Executed: on connection 2
Prepared statement ODBC_767
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005070
Total SQL execution seconds were:                   0.447071
Total SQL prepare seconds were:                     0.020666
Total SQL describe seconds were:                    0.000514
Total seconds used by the ODBC ACCESS engine were     0.493488
 
MPRINT(CREATE):   QUIT;
345                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 192.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.73 seconds
      cpu time            0.32 seconds
      

113        
114        
115        * Medications at index - need to do for all for consistency;
116        %macro demo_tx(year, years);
117        %do z=1 %to 2;
118        	%let groups=overall*mi*pad*stroke*unsta_angina*sta_angina*tia*other*revasc*cvd*anginatia*noncvd;
119        		%do zz=1 %to 12;
120        		%let ad = %scan(&groups., &zz., *);	
121        %create(_12_demo_tx_&ad.&z.&year.)
122        		select distinct q.*
123        			%do i=1 %to 16;
124        				%let tx =
124      ! %scan(Statins*PCSK9i*Ezetimibe*Fibrates*Niacin*Mipomersen*Tocilizumab*Hormone*Fibrinolytic*Betablocker*ACE*Antiplatelet*N
124      ! iacin_Statin*Loop_Diuretic*MRA*Anticoagulant, &i., *);	
125        				, case when w&i..patid is not null then 1 end as &tx.
126        			%end;
127        		from dingyig._12_lab1_&ad.&z.&year. as q
128        			%do t=1 %to 16;
129        				%let tx =
129      ! %scan(Statins*PCSK9i*Ezetimibe*Fibrates*Niacin*Mipomersen*Tocilizumab*Hormone*Fibrinolytic*Betablocker*ACE*Antiplatelet*N
129      ! iacin_Statin*Loop_Diuretic*MRA*Anticoagulant, &t., *);	
130        				left join dingyig.ldlc_04_drugs as w&t.
131        				on q.patid=w&t..patid and w&t..generic="&tx." and q.index_date_&ad.=w&t..dt	
132        			%end;						
133        	%create(_12_demo_tx_&ad.&z.&year.)
134        	%end;
135        	%end;
136        %mend demo_tx;
137        
138        %demo_tx(one_year, index_date_&ad. + INTERVAL 365 DAYS);
WARNING: Apparent symbolic reference AD not resolved.
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1one_year PURGE ) BY imp;
 
ODBC_769: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082939
Total seconds used by the ODBC ACCESS engine were     0.086931
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
346                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_770: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.754069
Total seconds used by the ODBC ACCESS engine were     6.242158
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_overall1one_year );
 
ODBC_771: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall1one_year
 
 
ODBC_772: Executed: on connection 2
347                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_771
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004034
Total SQL execution seconds were:                   0.048456
Total SQL prepare seconds were:                     0.020078
Total SQL describe seconds were:                    0.000537
Total seconds used by the ODBC ACCESS engine were     0.091336
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 193.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.84 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1one_year PURGE ) BY imp;
 
ODBC_773: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084931
Total seconds used by the ODBC ACCESS engine were     0.086499
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_774: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
348                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.089316
Total seconds used by the ODBC ACCESS engine were     6.820448
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi1one_year );
 
ODBC_775: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi1one_year
 
 
ODBC_776: Executed: on connection 2
Prepared statement ODBC_775
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004700
Total SQL execution seconds were:                   0.060542
Total SQL prepare seconds were:                     0.020652
Total SQL describe seconds were:                    0.000534
Total seconds used by the ODBC ACCESS engine were     0.107605
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 194.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.43 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1one_year PURGE ) BY imp;
 
349                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_777: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085629
Total seconds used by the ODBC ACCESS engine were     0.087276
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_778: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
350                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.993436
Total seconds used by the ODBC ACCESS engine were     6.498643
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad1one_year );
 
ODBC_779: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad1one_year
 
 
ODBC_780: Executed: on connection 2
Prepared statement ODBC_779
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004651
Total SQL execution seconds were:                   0.061088
Total SQL prepare seconds were:                     0.020516
Total SQL describe seconds were:                    0.000503
Total seconds used by the ODBC ACCESS engine were     0.107707
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 195.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.12 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1one_year PURGE ) BY imp;
 
ODBC_781: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082132
Total seconds used by the ODBC ACCESS engine were     0.084455
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
351                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_782: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.255579
Total seconds used by the ODBC ACCESS engine were     6.762189
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke1one_year );
 
ODBC_783: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke1one_year
 
 
ODBC_784: Executed: on connection 2
Prepared statement ODBC_783
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005397
352                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.723829
Total SQL prepare seconds were:                     0.021329
Total SQL describe seconds were:                    0.000561
Total seconds used by the ODBC ACCESS engine were     0.772226
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 196.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.05 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1one_year PURGE ) BY imp;
 
ODBC_785: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.126334
Total seconds used by the ODBC ACCESS engine were     0.127893
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina1one_year as q left join dingyig.ldlc_04_drugs 
as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_786: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as 
Statins , case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when 
w4.patid is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null 
then 1 end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as 
Hormone , case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , 
353                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

case when w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when 
w13.patid is not null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when 
w15.patid is not null then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from 
dingyig._12_lab1_unsta_angina1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and 
q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and 
q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and 
q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and 
q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and 
q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and 
q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and 
q.index_date_unsta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.056809
Total seconds used by the ODBC ACCESS engine were     6.538437
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_unsta_angina1one_year );
 
ODBC_787: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina1one_year
 
 
ODBC_788: Executed: on connection 2
Prepared statement ODBC_787
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004206
Total SQL execution seconds were:                   0.069824
Total SQL prepare seconds were:                     0.016750
Total SQL describe seconds were:                    0.000510
Total seconds used by the ODBC ACCESS engine were     0.111053
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 197.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.19 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1one_year PURGE ) BY imp;
 
ODBC_789: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1one_year PURGE
354                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.157275
Total seconds used by the ODBC ACCESS engine were     0.160760
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1one_year as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_790: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_sta_angina1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
355                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.979820
Total seconds used by the ODBC ACCESS engine were     6.517544
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_sta_angina1one_year );
 
ODBC_791: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina1one_year
 
 
ODBC_792: Executed: on connection 2
Prepared statement ODBC_791
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006334
Total SQL execution seconds were:                   0.053873
Total SQL prepare seconds were:                     0.021973
Total SQL describe seconds were:                    0.000468
Total seconds used by the ODBC ACCESS engine were     0.115529
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 198.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.21 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1one_year PURGE ) BY imp;
 
ODBC_793: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082462
Total seconds used by the ODBC ACCESS engine were     0.083980
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
356                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_794: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.047743
Total seconds used by the ODBC ACCESS engine were     6.535852
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia1one_year );
 
ODBC_795: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia1one_year
 
 
ODBC_796: Executed: on connection 2
Prepared statement ODBC_795
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004644
Total SQL execution seconds were:                   0.060874
Total SQL prepare seconds were:                     0.019537
357                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL describe seconds were:                    0.000479
Total seconds used by the ODBC ACCESS engine were     0.106682
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 199.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.14 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other1one_year PURGE ) BY imp;
 
ODBC_797: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083330
Total seconds used by the ODBC ACCESS engine were     0.084935
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_798: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
358                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.920231
Total seconds used by the ODBC ACCESS engine were     6.420369
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other1one_year );
 
ODBC_799: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other1one_year
 
 
ODBC_800: Executed: on connection 2
Prepared statement ODBC_799
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004751
Total SQL execution seconds were:                   0.072185
Total SQL prepare seconds were:                     0.019767
Total SQL describe seconds were:                    0.000529
Total seconds used by the ODBC ACCESS engine were     0.118032
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 200.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.04 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1one_year PURGE ) BY imp;
 
ODBC_801: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1one_year PURGE
 
 
Summary Statistics for ODBC are:
359                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.097855
Total seconds used by the ODBC ACCESS engine were     0.099437
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_802: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
360                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   5.811956
Total seconds used by the ODBC ACCESS engine were     6.435076
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc1one_year );
 
ODBC_803: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc1one_year
 
 
ODBC_804: Executed: on connection 2
Prepared statement ODBC_803
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004805
Total SQL execution seconds were:                   0.052177
Total SQL prepare seconds were:                     0.020109
Total SQL describe seconds were:                    0.000489
Total seconds used by the ODBC ACCESS engine were     0.099163
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 201.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.05 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1one_year PURGE ) BY imp;
 
ODBC_805: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081918
Total seconds used by the ODBC ACCESS engine were     0.083560
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
361                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_806: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.946596
Total seconds used by the ODBC ACCESS engine were     6.472935
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd1one_year );
 
ODBC_807: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd1one_year
 
 
ODBC_808: Executed: on connection 2
Prepared statement ODBC_807
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004812
Total SQL execution seconds were:                   0.050980
Total SQL prepare seconds were:                     0.020055
Total SQL describe seconds were:                    0.000648
Total seconds used by the ODBC ACCESS engine were     0.099543
 
362                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 202.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.07 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1one_year PURGE ) BY imp;
 
ODBC_809: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.081988
Total seconds used by the ODBC ACCESS engine were     0.083813
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1one_year as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_810: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
363                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.229937
Total seconds used by the ODBC ACCESS engine were     6.713777
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_anginatia1one_year );
 
ODBC_811: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia1one_year
 
 
ODBC_812: Executed: on connection 2
Prepared statement ODBC_811
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004285
Total SQL execution seconds were:                   0.049588
Total SQL prepare seconds were:                     0.020970
Total SQL describe seconds were:                    0.000612
Total seconds used by the ODBC ACCESS engine were     0.094408
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 203.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.31 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1one_year PURGE ) BY imp;
 
ODBC_813: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085701
Total seconds used by the ODBC ACCESS engine were     0.087339
 
364                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_814: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd1one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.733882
Total seconds used by the ODBC ACCESS engine were     6.256621
 
365                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_noncvd1one_year );
 
ODBC_815: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd1one_year
 
 
ODBC_816: Executed: on connection 2
Prepared statement ODBC_815
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004375
Total SQL execution seconds were:                   0.058308
Total SQL prepare seconds were:                     0.021105
Total SQL describe seconds were:                    0.000519
Total seconds used by the ODBC ACCESS engine were     0.106822
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 204.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.53 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2one_year PURGE ) BY imp;
 
ODBC_817: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088163
Total seconds used by the ODBC ACCESS engine were     0.089732
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
366                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_818: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.802153
Total seconds used by the ODBC ACCESS engine were     6.279465
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_overall2one_year );
 
ODBC_819: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall2one_year
 
 
ODBC_820: Executed: on connection 2
Prepared statement ODBC_819
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004522
Total SQL execution seconds were:                   0.054684
Total SQL prepare seconds were:                     0.020575
Total SQL describe seconds were:                    0.000478
Total seconds used by the ODBC ACCESS engine were     0.098898
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 205.
367                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           6.89 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2one_year PURGE ) BY imp;
 
ODBC_821: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084390
Total seconds used by the ODBC ACCESS engine were     0.085967
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_822: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
368                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.827190
Total seconds used by the ODBC ACCESS engine were     6.355876
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi2one_year );
 
ODBC_823: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi2one_year
 
 
ODBC_824: Executed: on connection 2
Prepared statement ODBC_823
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004680
Total SQL execution seconds were:                   0.050475
Total SQL prepare seconds were:                     0.020294
Total SQL describe seconds were:                    0.000510
Total seconds used by the ODBC ACCESS engine were     0.095676
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 206.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.62 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2one_year PURGE ) BY imp;
 
ODBC_825: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085437
Total seconds used by the ODBC ACCESS engine were     0.087059
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
369                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_826: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.750800
Total seconds used by the ODBC ACCESS engine were     6.246995
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad2one_year );
 
ODBC_827: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad2one_year
370                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
ODBC_828: Executed: on connection 2
Prepared statement ODBC_827
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004698
Total SQL execution seconds were:                   0.060636
Total SQL prepare seconds were:                     0.020405
Total SQL describe seconds were:                    0.000514
Total seconds used by the ODBC ACCESS engine were     0.105378
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 207.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.85 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2one_year PURGE ) BY imp;
 
ODBC_829: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.075007
Total seconds used by the ODBC ACCESS engine were     0.078217
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
371                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   ) BY imp;
 
ODBC_830: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.762287
Total seconds used by the ODBC ACCESS engine were     6.272988
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke2one_year );
 
ODBC_831: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke2one_year
 
 
ODBC_832: Executed: on connection 2
Prepared statement ODBC_831
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004613
Total SQL execution seconds were:                   0.049959
Total SQL prepare seconds were:                     0.019173
Total SQL describe seconds were:                    0.000843
Total seconds used by the ODBC ACCESS engine were     0.096490
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 208.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.86 seconds
      cpu time            0.43 seconds
      

372                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2one_year PURGE ) BY imp;
 
ODBC_833: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085952
Total seconds used by the ODBC ACCESS engine were     0.087438
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina2one_year as q left join dingyig.ldlc_04_drugs 
as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_834: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as 
Statins , case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when 
w4.patid is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null 
then 1 end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as 
Hormone , case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , 
case when w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when 
w13.patid is not null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when 
w15.patid is not null then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from 
dingyig._12_lab1_unsta_angina2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and 
373                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and 
q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and 
q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and 
q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and 
q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and 
q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and 
q.index_date_unsta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.344981
Total seconds used by the ODBC ACCESS engine were     6.839184
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_unsta_angina2one_year );
 
ODBC_835: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina2one_year
 
 
ODBC_836: Executed: on connection 2
Prepared statement ODBC_835
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003988
Total SQL execution seconds were:                   0.061210
Total SQL prepare seconds were:                     0.020936
Total SQL describe seconds were:                    0.000519
Total seconds used by the ODBC ACCESS engine were     0.105077
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 209.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.48 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2one_year PURGE ) BY imp;
 
ODBC_837: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082403
Total seconds used by the ODBC ACCESS engine were     0.083917
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
374                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2one_year as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_838: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_sta_angina2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.805893
Total seconds used by the ODBC ACCESS engine were     6.302301
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_sta_angina2one_year );
 
ODBC_839: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina2one_year
 
375                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_840: Executed: on connection 2
Prepared statement ODBC_839
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.164182
Total SQL execution seconds were:                   0.049136
Total SQL prepare seconds were:                     0.020354
Total SQL describe seconds were:                    0.000832
Total seconds used by the ODBC ACCESS engine were     0.256817
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 210.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.06 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2one_year PURGE ) BY imp;
 
ODBC_841: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.078830
Total seconds used by the ODBC ACCESS engine were     0.080401
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
376                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_842: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.010964
Total seconds used by the ODBC ACCESS engine were     6.480710
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia2one_year );
 
ODBC_843: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia2one_year
 
 
ODBC_844: Executed: on connection 2
Prepared statement ODBC_843
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004424
Total SQL execution seconds were:                   0.053044
Total SQL prepare seconds were:                     0.019514
Total SQL describe seconds were:                    0.000520
Total seconds used by the ODBC ACCESS engine were     0.095934
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 211.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.09 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
377                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other2one_year PURGE ) BY imp;
 
ODBC_845: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086198
Total seconds used by the ODBC ACCESS engine were     0.087690
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_846: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
378                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.755125
Total seconds used by the ODBC ACCESS engine were     6.262158
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other2one_year );
 
ODBC_847: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other2one_year
 
 
ODBC_848: Executed: on connection 2
Prepared statement ODBC_847
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004588
Total SQL execution seconds were:                   0.116868
Total SQL prepare seconds were:                     0.019743
Total SQL describe seconds were:                    0.000542
Total seconds used by the ODBC ACCESS engine were     0.163844
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 212.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.93 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2one_year PURGE ) BY imp;
 
ODBC_849: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087430
Total seconds used by the ODBC ACCESS engine were     0.088984
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2one_year as q left join dingyig.ldlc_04_drugs as w1 
379                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_850: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.824213
Total seconds used by the ODBC ACCESS engine were     6.320252
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc2one_year );
 
ODBC_851: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc2one_year
 
 
ODBC_852: Executed: on connection 2
Prepared statement ODBC_851
380                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003823
Total SQL execution seconds were:                   0.062281
Total SQL prepare seconds were:                     0.020986
Total SQL describe seconds were:                    0.000542
Total seconds used by the ODBC ACCESS engine were     0.107513
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 213.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.94 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2one_year PURGE ) BY imp;
 
ODBC_853: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083173
Total seconds used by the ODBC ACCESS engine were     0.084746
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_854: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
381                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.791850
Total seconds used by the ODBC ACCESS engine were     6.285917
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd2one_year );
 
ODBC_855: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd2one_year
 
 
ODBC_856: Executed: on connection 2
Prepared statement ODBC_855
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005036
Total SQL execution seconds were:                   0.108774
Total SQL prepare seconds were:                     0.020381
Total SQL describe seconds were:                    0.000540
Total seconds used by the ODBC ACCESS engine were     0.155313
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 214.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.94 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2one_year PURGE ) BY imp;
 
382                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_857: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088059
Total seconds used by the ODBC ACCESS engine were     0.089659
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2one_year as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_858: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
383                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.832658
Total seconds used by the ODBC ACCESS engine were     6.351955
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_anginatia2one_year );
 
ODBC_859: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia2one_year
 
 
ODBC_860: Executed: on connection 2
Prepared statement ODBC_859
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004922
Total SQL execution seconds were:                   0.050619
Total SQL prepare seconds were:                     0.019403
Total SQL describe seconds were:                    0.000511
Total seconds used by the ODBC ACCESS engine were     0.098305
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 215.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.95 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2one_year PURGE ) BY imp;
 
ODBC_861: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085939
Total seconds used by the ODBC ACCESS engine were     0.087694
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2one_year as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
384                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_862: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd2one_year AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2one_year as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.745225
Total seconds used by the ODBC ACCESS engine were     6.254844
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_noncvd2one_year );
 
ODBC_863: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd2one_year
 
 
ODBC_864: Executed: on connection 2
Prepared statement ODBC_863
 
 
Summary Statistics for ODBC are:
385                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total row fetch seconds were:                       0.004526
Total SQL execution seconds were:                   0.051638
Total SQL prepare seconds were:                     0.020269
Total SQL describe seconds were:                    0.000512
Total seconds used by the ODBC ACCESS engine were     0.096325
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 216.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.86 seconds
      cpu time            0.43 seconds
      

WARNING: Apparent symbolic reference AD not resolved.
139        %demo_tx(two_years,  index_date_&ad. + INTERVAL 730 DAYS);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1two_years PURGE ) BY imp;
 
ODBC_865: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080556
Total seconds used by the ODBC ACCESS engine were     0.082044
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1two_years as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_866: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
386                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.818576
Total seconds used by the ODBC ACCESS engine were     6.350295
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_overall1two_years );
 
ODBC_867: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall1two_years
 
 
ODBC_868: Executed: on connection 2
Prepared statement ODBC_867
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004642
Total SQL execution seconds were:                   0.052186
Total SQL prepare seconds were:                     0.021045
Total SQL describe seconds were:                    0.000499
Total seconds used by the ODBC ACCESS engine were     0.099011
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 217.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.95 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1two_years PURGE ) BY imp;
 
387                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_869: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087671
Total seconds used by the ODBC ACCESS engine were     0.089273
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_870: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
388                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.854615
Total seconds used by the ODBC ACCESS engine were     6.351763
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi1two_years );
 
ODBC_871: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi1two_years
 
 
ODBC_872: Executed: on connection 2
Prepared statement ODBC_871
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004241
Total SQL execution seconds were:                   0.050876
Total SQL prepare seconds were:                     0.021226
Total SQL describe seconds were:                    0.000495
Total seconds used by the ODBC ACCESS engine were     0.095415
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 218.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.96 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1two_years PURGE ) BY imp;
 
ODBC_873: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087035
Total seconds used by the ODBC ACCESS engine were     0.090429
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
389                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_874: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.768565
Total seconds used by the ODBC ACCESS engine were     6.264323
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad1two_years );
 
ODBC_875: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad1two_years
 
 
ODBC_876: Executed: on connection 2
Prepared statement ODBC_875
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004647
Total SQL execution seconds were:                   0.116295
Total SQL prepare seconds were:                     0.021899
390                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL describe seconds were:                    0.000830
Total seconds used by the ODBC ACCESS engine were     0.164061
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 219.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.93 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1two_years PURGE ) BY imp;
 
ODBC_877: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082698
Total seconds used by the ODBC ACCESS engine were     0.084250
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_878: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
391                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.075242
Total seconds used by the ODBC ACCESS engine were     6.602393
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke1two_years );
 
ODBC_879: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke1two_years
 
 
ODBC_880: Executed: on connection 2
Prepared statement ODBC_879
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005934
Total SQL execution seconds were:                   0.057875
Total SQL prepare seconds were:                     0.019104
Total SQL describe seconds were:                    0.000587
Total seconds used by the ODBC ACCESS engine were     0.105278
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 220.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.21 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1two_years PURGE ) BY imp;
 
ODBC_881: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
392                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.081062
Total seconds used by the ODBC ACCESS engine were     0.082645
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina1two_years as q left join dingyig.ldlc_04_drugs 
as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_882: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as 
Statins , case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when 
w4.patid is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null 
then 1 end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as 
Hormone , case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , 
case when w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when 
w13.patid is not null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when 
w15.patid is not null then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from 
dingyig._12_lab1_unsta_angina1two_years as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and 
q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and 
q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and 
q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and 
q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and 
q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and 
q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and 
q.index_date_unsta_angina=w16.dt
 
 
393                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.749719
Total seconds used by the ODBC ACCESS engine were     6.262925
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina1two_years' As _table, COUNT(*) AS 
_rows FROM dingyig._12_demo_tx_unsta_angina1two_years );
 
ODBC_883: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina1two_years
 
 
ODBC_884: Executed: on connection 2
Prepared statement ODBC_883
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004933
Total SQL execution seconds were:                   0.052293
Total SQL prepare seconds were:                     0.021167
Total SQL describe seconds were:                    0.000577
Total seconds used by the ODBC ACCESS engine were     0.099910
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 221.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.86 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1two_years PURGE ) BY imp;
 
ODBC_885: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088457
Total seconds used by the ODBC ACCESS engine were     0.090234
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1two_years as q left join dingyig.ldlc_04_drugs 
as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
394                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_886: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_sta_angina1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1two_years as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.225899
Total seconds used by the ODBC ACCESS engine were     6.707464
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_sta_angina1two_years );
 
ODBC_887: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina1two_years
 
 
ODBC_888: Executed: on connection 2
Prepared statement ODBC_887
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004196
Total SQL execution seconds were:                   0.059593
Total SQL prepare seconds were:                     0.020537
Total SQL describe seconds were:                    0.000528
395                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.103210
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 222.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.32 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1two_years PURGE ) BY imp;
 
ODBC_889: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.093926
Total seconds used by the ODBC ACCESS engine were     0.095615
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_890: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
396                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.835484
Total seconds used by the ODBC ACCESS engine were     6.354013
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia1two_years );
 
ODBC_891: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia1two_years
 
 
ODBC_892: Executed: on connection 2
Prepared statement ODBC_891
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004594
Total SQL execution seconds were:                   0.049305
Total SQL prepare seconds were:                     0.020364
Total SQL describe seconds were:                    0.000488
Total seconds used by the ODBC ACCESS engine were     0.096347
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 223.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.98 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other1two_years PURGE ) BY imp;
 
ODBC_893: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084423
Total seconds used by the ODBC ACCESS engine were     0.086044
397                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_894: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.950119
Total seconds used by the ODBC ACCESS engine were     6.438583
398                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other1two_years );
 
ODBC_895: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other1two_years
 
 
ODBC_896: Executed: on connection 2
Prepared statement ODBC_895
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004224
Total SQL execution seconds were:                   0.055543
Total SQL prepare seconds were:                     0.021886
Total SQL describe seconds were:                    0.000513
Total seconds used by the ODBC ACCESS engine were     0.100044
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 224.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.70 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1two_years PURGE ) BY imp;
 
ODBC_897: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099354
Total seconds used by the ODBC ACCESS engine were     0.100947
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
399                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_898: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.649745
Total seconds used by the ODBC ACCESS engine were     6.168098
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc1two_years );
 
ODBC_899: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc1two_years
 
 
ODBC_900: Executed: on connection 2
Prepared statement ODBC_899
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004682
Total SQL execution seconds were:                   0.059979
Total SQL prepare seconds were:                     0.019550
Total SQL describe seconds were:                    0.000530
Total seconds used by the ODBC ACCESS engine were     0.104315
 
MPRINT(CREATE):   QUIT;
400                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 225.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.79 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1two_years PURGE ) BY imp;
 
ODBC_901: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.093583
Total seconds used by the ODBC ACCESS engine were     0.095163
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_902: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
401                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.731310
Total seconds used by the ODBC ACCESS engine were     6.211578
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd1two_years );
 
ODBC_903: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd1two_years
 
 
ODBC_904: Executed: on connection 2
Prepared statement ODBC_903
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004094
Total SQL execution seconds were:                   0.052171
Total SQL prepare seconds were:                     0.021651
Total SQL describe seconds were:                    0.000518
Total seconds used by the ODBC ACCESS engine were     0.096787
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 226.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.82 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1two_years PURGE ) BY imp;
 
ODBC_905: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085086
Total seconds used by the ODBC ACCESS engine were     0.086610
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
402                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1two_years as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_906: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.862824
Total seconds used by the ODBC ACCESS engine were     6.384878
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia1two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_anginatia1two_years );
403                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_907: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia1two_years
 
 
ODBC_908: Executed: on connection 2
Prepared statement ODBC_907
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004583
Total SQL execution seconds were:                   0.053148
Total SQL prepare seconds were:                     0.022214
Total SQL describe seconds were:                    0.000569
Total seconds used by the ODBC ACCESS engine were     0.100501
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 227.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.99 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1two_years PURGE ) BY imp;
 
ODBC_909: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087056
Total seconds used by the ODBC ACCESS engine were     0.088620
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd1two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
404                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_910: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd1two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.754760
Total seconds used by the ODBC ACCESS engine were     6.300203
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd1two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_noncvd1two_years );
 
ODBC_911: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd1two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd1two_years
 
 
ODBC_912: Executed: on connection 2
Prepared statement ODBC_911
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006612
Total SQL execution seconds were:                   0.063433
Total SQL prepare seconds were:                     0.017634
Total SQL describe seconds were:                    0.000518
Total seconds used by the ODBC ACCESS engine were     0.111770
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 228.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.92 seconds
405                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2two_years PURGE ) BY imp;
 
ODBC_913: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.321513
Total seconds used by the ODBC ACCESS engine were     0.323149
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2two_years as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_914: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
406                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.014210
Total seconds used by the ODBC ACCESS engine were     6.529234
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_overall2two_years );
 
ODBC_915: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall2two_years
 
 
ODBC_916: Executed: on connection 2
Prepared statement ODBC_915
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004412
Total SQL execution seconds were:                   0.055684
Total SQL prepare seconds were:                     0.021161
Total SQL describe seconds were:                    0.000506
Total seconds used by the ODBC ACCESS engine were     0.101692
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 229.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.38 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2two_years PURGE ) BY imp;
 
ODBC_917: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.080394
Total seconds used by the ODBC ACCESS engine were     0.082000
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
407                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_918: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.288769
Total seconds used by the ODBC ACCESS engine were     6.796154
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi2two_years );
 
ODBC_919: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi2two_years
 
408                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_920: Executed: on connection 2
Prepared statement ODBC_919
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004457
Total SQL execution seconds were:                   0.065084
Total SQL prepare seconds were:                     0.019870
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.107922
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 230.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.41 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2two_years PURGE ) BY imp;
 
ODBC_921: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090956
Total seconds used by the ODBC ACCESS engine were     0.092738
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
409                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_922: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.882985
Total seconds used by the ODBC ACCESS engine were     6.484619
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad2two_years );
 
ODBC_923: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad2two_years
 
 
ODBC_924: Executed: on connection 2
Prepared statement ODBC_923
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005219
Total SQL execution seconds were:                   0.054776
Total SQL prepare seconds were:                     0.029150
Total SQL describe seconds were:                    0.000497
Total seconds used by the ODBC ACCESS engine were     0.114227
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 231.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.11 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
410                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2two_years PURGE ) BY imp;
 
ODBC_925: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084557
Total seconds used by the ODBC ACCESS engine were     0.086228
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_926: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
411                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.799274
Total seconds used by the ODBC ACCESS engine were     6.293482
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke2two_years );
 
ODBC_927: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke2two_years
 
 
ODBC_928: Executed: on connection 2
Prepared statement ODBC_927
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004521
Total SQL execution seconds were:                   0.052764
Total SQL prepare seconds were:                     0.021626
Total SQL describe seconds were:                    0.000527
Total seconds used by the ODBC ACCESS engine were     0.101216
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 232.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.90 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2two_years PURGE ) BY imp;
 
ODBC_929: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083124
Total seconds used by the ODBC ACCESS engine were     0.084693
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina2two_years as q left join dingyig.ldlc_04_drugs 
412                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_930: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as 
Statins , case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when 
w4.patid is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null 
then 1 end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as 
Hormone , case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , 
case when w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when 
w13.patid is not null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when 
w15.patid is not null then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from 
dingyig._12_lab1_unsta_angina2two_years as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and 
q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and 
q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and 
q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and 
q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and 
q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and 
q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and 
q.index_date_unsta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.023656
Total seconds used by the ODBC ACCESS engine were     6.550938
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina2two_years' As _table, COUNT(*) AS 
_rows FROM dingyig._12_demo_tx_unsta_angina2two_years );
 
ODBC_931: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina2two_years
 
 
ODBC_932: Executed: on connection 2
413                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_931
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004701
Total SQL execution seconds were:                   0.050687
Total SQL prepare seconds were:                     0.019451
Total SQL describe seconds were:                    0.000478
Total seconds used by the ODBC ACCESS engine were     0.095204
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 233.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.15 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2two_years PURGE ) BY imp;
 
ODBC_933: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082660
Total seconds used by the ODBC ACCESS engine were     0.084298
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2two_years as q left join dingyig.ldlc_04_drugs 
as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_934: Executed: on connection 2
414                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

CREATE TABLE dingyig._12_demo_tx_sta_angina2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2two_years as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.797573
Total seconds used by the ODBC ACCESS engine were     6.290703
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_sta_angina2two_years );
 
ODBC_935: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina2two_years
 
 
ODBC_936: Executed: on connection 2
Prepared statement ODBC_935
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004977
Total SQL execution seconds were:                   0.050503
Total SQL prepare seconds were:                     0.020833
Total SQL describe seconds were:                    0.000537
Total seconds used by the ODBC ACCESS engine were     0.095807
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 234.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.88 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
415                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2two_years PURGE ) BY imp;
 
ODBC_937: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082633
Total seconds used by the ODBC ACCESS engine were     0.084203
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_938: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
416                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.866425
Total seconds used by the ODBC ACCESS engine were     6.406285
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia2two_years );
 
ODBC_939: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia2two_years
 
 
ODBC_940: Executed: on connection 2
Prepared statement ODBC_939
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004732
Total SQL execution seconds were:                   0.061025
Total SQL prepare seconds were:                     0.019107
Total SQL describe seconds were:                    0.000473
Total seconds used by the ODBC ACCESS engine were     0.105832
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 235.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.01 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other2two_years PURGE ) BY imp;
 
ODBC_941: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084367
Total seconds used by the ODBC ACCESS engine were     0.086002
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
417                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_942: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.125945
Total seconds used by the ODBC ACCESS engine were     6.735570
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other2two_years );
 
ODBC_943: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other2two_years
 
 
ODBC_944: Executed: on connection 2
Prepared statement ODBC_943
 
 
418                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.006129
Total SQL execution seconds were:                   0.106637
Total SQL prepare seconds were:                     0.020729
Total SQL describe seconds were:                    0.000502
Total seconds used by the ODBC ACCESS engine were     0.156833
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 236.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.42 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2two_years PURGE ) BY imp;
 
ODBC_945: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084834
Total seconds used by the ODBC ACCESS engine were     0.086615
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_946: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
419                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.734516
Total seconds used by the ODBC ACCESS engine were     6.256875
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc2two_years );
 
ODBC_947: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc2two_years
 
 
ODBC_948: Executed: on connection 2
Prepared statement ODBC_947
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004436
Total SQL execution seconds were:                   0.052825
Total SQL prepare seconds were:                     0.020149
Total SQL describe seconds were:                    0.000518
Total seconds used by the ODBC ACCESS engine were     0.097761
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 237.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.52 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2two_years PURGE ) BY imp;
 
ODBC_949: Executed: on connection 2
420                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085755
Total seconds used by the ODBC ACCESS engine were     0.087489
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2two_years as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_950: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2two_years as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
421                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.802009
Total seconds used by the ODBC ACCESS engine were     6.353254
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd2two_years );
 
ODBC_951: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd2two_years
 
 
ODBC_952: Executed: on connection 2
Prepared statement ODBC_951
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005476
Total SQL execution seconds were:                   0.130989
Total SQL prepare seconds were:                     0.020184
Total SQL describe seconds were:                    0.000549
Total seconds used by the ODBC ACCESS engine were     0.180413
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 238.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.04 seconds
      cpu time            0.46 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2two_years PURGE ) BY imp;
 
ODBC_953: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088922
Total seconds used by the ODBC ACCESS engine were     0.090517
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2two_years as q left join dingyig.ldlc_04_drugs as 
w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
422                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_954: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins 
, case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.438452
Total seconds used by the ODBC ACCESS engine were     6.940972
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia2two_years' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx_anginatia2two_years );
 
ODBC_955: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia2two_years
 
 
ODBC_956: Executed: on connection 2
Prepared statement ODBC_955
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004200
Total SQL execution seconds were:                   0.052424
423                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL prepare seconds were:                     0.020886
Total SQL describe seconds were:                    0.000478
Total seconds used by the ODBC ACCESS engine were     0.097045
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 239.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.54 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2two_years PURGE ) BY imp;
 
ODBC_957: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2two_years PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082485
Total seconds used by the ODBC ACCESS engine were     0.083976
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd2two_years AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2two_years as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_958: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd2two_years AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
424                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2two_years as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.747898
Total seconds used by the ODBC ACCESS engine were     6.227357
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd2two_years' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_noncvd2two_years );
 
ODBC_959: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd2two_years' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd2two_years
 
 
ODBC_960: Executed: on connection 2
Prepared statement ODBC_959
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004267
Total SQL execution seconds were:                   0.049223
Total SQL prepare seconds were:                     0.022116
Total SQL describe seconds were:                    0.000532
Total seconds used by the ODBC ACCESS engine were     0.094273
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 240.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.83 seconds
      cpu time            0.43 seconds
      

140        %demo_tx(all, eligend);
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1all PURGE ) BY imp;
 
ODBC_961: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall1all PURGE
 
425                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084979
Total seconds used by the ODBC ACCESS engine were     0.086683
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_962: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
426                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.827892
Total seconds used by the ODBC ACCESS engine were     6.320236
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_overall1all );
 
ODBC_963: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall1all
 
 
ODBC_964: Executed: on connection 2
Prepared statement ODBC_963
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004325
Total SQL execution seconds were:                   0.051676
Total SQL prepare seconds were:                     0.021304
Total SQL describe seconds were:                    0.000478
Total seconds used by the ODBC ACCESS engine were     0.097356
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 241.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.92 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1all PURGE ) BY imp;
 
ODBC_965: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.089807
Total seconds used by the ODBC ACCESS engine were     0.091597
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
427                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_966: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.927816
Total seconds used by the ODBC ACCESS engine were     6.437435
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi1all );
 
ODBC_967: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi1all
 
 
ODBC_968: Executed: on connection 2
Prepared statement ODBC_967
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003798
Total SQL execution seconds were:                   0.052272
Total SQL prepare seconds were:                     0.020455
Total SQL describe seconds were:                    0.000502
Total seconds used by the ODBC ACCESS engine were     0.096645
428                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 242.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.70 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1all PURGE ) BY imp;
 
ODBC_969: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088612
Total seconds used by the ODBC ACCESS engine were     0.090134
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_970: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
429                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.836695
Total seconds used by the ODBC ACCESS engine were     6.380950
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad1all );
 
ODBC_971: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad1all
 
 
ODBC_972: Executed: on connection 2
Prepared statement ODBC_971
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004940
Total SQL execution seconds were:                   0.050890
Total SQL prepare seconds were:                     0.020339
Total SQL describe seconds were:                    0.000515
Total seconds used by the ODBC ACCESS engine were     0.097219
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 243.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.98 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1all PURGE ) BY imp;
 
ODBC_973: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.101388
Total seconds used by the ODBC ACCESS engine were     0.102904
 
430                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_974: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.920267
Total seconds used by the ODBC ACCESS engine were     6.447658
 
431                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke1all );
 
ODBC_975: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke1all
 
 
ODBC_976: Executed: on connection 2
Prepared statement ODBC_975
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004268
Total SQL execution seconds were:                   0.056071
Total SQL prepare seconds were:                     0.020108
Total SQL describe seconds were:                    0.000535
Total seconds used by the ODBC ACCESS engine were     0.101449
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 244.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.07 seconds
      cpu time            0.42 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1all PURGE ) BY imp;
 
ODBC_977: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084528
Total seconds used by the ODBC ACCESS engine were     0.086177
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina1all as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
432                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_978: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina1all as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.961678
Total seconds used by the ODBC ACCESS engine were     6.503213
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_unsta_angina1all );
 
ODBC_979: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina1all
 
 
ODBC_980: Executed: on connection 2
Prepared statement ODBC_979
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005538
Total SQL execution seconds were:                   0.063791
Total SQL prepare seconds were:                     0.022139
Total SQL describe seconds were:                    0.000511
Total seconds used by the ODBC ACCESS engine were     0.114928
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 245.
433                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           7.12 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1all PURGE ) BY imp;
 
ODBC_981: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082934
Total seconds used by the ODBC ACCESS engine were     0.084632
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1all as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_982: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_sta_angina1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
434                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.811647
Total seconds used by the ODBC ACCESS engine were     6.319588
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_sta_angina1all );
 
ODBC_983: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina1all
 
 
ODBC_984: Executed: on connection 2
Prepared statement ODBC_983
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004648
Total SQL execution seconds were:                   0.050469
Total SQL prepare seconds were:                     0.020345
Total SQL describe seconds were:                    0.000564
Total seconds used by the ODBC ACCESS engine were     0.096376
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 246.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.60 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1all PURGE ) BY imp;
 
ODBC_985: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086765
Total seconds used by the ODBC ACCESS engine were     0.088340
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
435                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_986: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.743036
Total seconds used by the ODBC ACCESS engine were     6.353471
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia1all );
 
436                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_987: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia1all
 
 
ODBC_988: Executed: on connection 2
Prepared statement ODBC_987
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004431
Total SQL execution seconds were:                   0.049543
Total SQL prepare seconds were:                     0.021435
Total SQL describe seconds were:                    0.000511
Total seconds used by the ODBC ACCESS engine were     0.094884
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 247.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.95 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other1all PURGE ) BY imp;
 
ODBC_989: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084733
Total seconds used by the ODBC ACCESS engine were     0.086297
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
437                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_990: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.739674
Total seconds used by the ODBC ACCESS engine were     6.306260
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other1all );
 
ODBC_991: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other1all
 
 
ODBC_992: Executed: on connection 2
Prepared statement ODBC_991
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004500
Total SQL execution seconds were:                   0.049990
Total SQL prepare seconds were:                     0.020122
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.094330
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 248.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.56 seconds
      cpu time            0.44 seconds
438                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1all PURGE ) BY imp;
 
ODBC_993: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082562
Total seconds used by the ODBC ACCESS engine were     0.084134
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_994: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
439                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.774115
Total seconds used by the ODBC ACCESS engine were     6.301886
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc1all );
 
ODBC_995: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc1all
 
 
ODBC_996: Executed: on connection 2
Prepared statement ODBC_995
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004444
Total SQL execution seconds were:                   0.050535
Total SQL prepare seconds were:                     0.019746
Total SQL describe seconds were:                    0.000488
Total seconds used by the ODBC ACCESS engine were     0.095857
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 249.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.90 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1all PURGE ) BY imp;
 
ODBC_997: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.120765
Total seconds used by the ODBC ACCESS engine were     0.122362
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
440                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_998: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.967815
Total seconds used by the ODBC ACCESS engine were     6.478739
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd1all );
 
ODBC_999: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd1all
 
441                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_1000: Executed: on connection 2
Prepared statement ODBC_999
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004729
Total SQL execution seconds were:                   0.053243
Total SQL prepare seconds were:                     0.020802
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.099274
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 250.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.12 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1all PURGE ) BY imp;
 
ODBC_1001: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.095358
Total seconds used by the ODBC ACCESS engine were     0.097004
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
442                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_1002: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.891629
Total seconds used by the ODBC ACCESS engine were     6.417044
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_anginatia1all );
 
ODBC_1003: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia1all
 
 
ODBC_1004: Executed: on connection 2
Prepared statement ODBC_1003
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004246
Total SQL execution seconds were:                   0.054473
Total SQL prepare seconds were:                     0.021860
Total SQL describe seconds were:                    0.000509
Total seconds used by the ODBC ACCESS engine were     0.101228
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 251.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.05 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
443                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1all PURGE ) BY imp;
 
ODBC_1005: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd1all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086061
Total seconds used by the ODBC ACCESS engine were     0.088422
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd1all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1006: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd1all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd1all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
444                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.273865
Total seconds used by the ODBC ACCESS engine were     6.782901
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd1all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_noncvd1all );
 
ODBC_1007: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd1all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd1all
 
 
ODBC_1008: Executed: on connection 2
Prepared statement ODBC_1007
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004356
Total SQL execution seconds were:                   0.052559
Total SQL prepare seconds were:                     0.021797
Total SQL describe seconds were:                    0.000516
Total seconds used by the ODBC ACCESS engine were     0.100130
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 252.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.43 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2all PURGE ) BY imp;
 
ODBC_1009: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_overall2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083472
Total seconds used by the ODBC ACCESS engine were     0.085173
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_overall2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
445                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_overall=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_overall=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_overall=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_overall=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_overall=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_overall=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1010: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_overall2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_overall2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_overall=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_overall=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_overall=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_overall=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_overall=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.109122
Total seconds used by the ODBC ACCESS engine were     6.604876
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_overall2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_overall2all );
 
ODBC_1011: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_overall2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_overall2all
 
 
ODBC_1012: Executed: on connection 2
446                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Prepared statement ODBC_1011
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004266
Total SQL execution seconds were:                   0.049223
Total SQL prepare seconds were:                     0.020743
Total SQL describe seconds were:                    0.000495
Total seconds used by the ODBC ACCESS engine were     0.093865
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 253.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.20 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2all PURGE ) BY imp;
 
ODBC_1013: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_mi2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.179714
Total seconds used by the ODBC ACCESS engine were     0.181237
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_mi2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1014: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_mi2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
447                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_mi2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_mi=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_mi=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and 
q.index_date_mi=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and 
q.index_date_mi=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_mi=w8.dt 
left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_mi=w11.dt left join dingyig.ldlc_04_drugs 
as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_mi=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_mi=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_mi=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.053622
Total seconds used by the ODBC ACCESS engine were     6.579585
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_mi2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_mi2all );
 
ODBC_1015: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_mi2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_mi2all
 
 
ODBC_1016: Executed: on connection 2
Prepared statement ODBC_1015
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004856
Total SQL execution seconds were:                   0.065773
Total SQL prepare seconds were:                     0.019272
Total SQL describe seconds were:                    0.000551
Total seconds used by the ODBC ACCESS engine were     0.111590
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 254.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.30 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2all PURGE ) BY imp;
 
448                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_1017: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_pad2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085263
Total seconds used by the ODBC ACCESS engine were     0.086989
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_pad2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_pad=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1018: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_pad2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_pad2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_pad=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_pad=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_pad=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_pad=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_pad=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_pad=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_pad=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_pad=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_pad=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_pad=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_pad=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
449                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w16.generic="Anticoagulant" and q.index_date_pad=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.019134
Total seconds used by the ODBC ACCESS engine were     7.539191
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_pad2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_pad2all );
 
ODBC_1019: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_pad2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_pad2all
 
 
ODBC_1020: Executed: on connection 2
Prepared statement ODBC_1019
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004958
Total SQL execution seconds were:                   0.104353
Total SQL prepare seconds were:                     0.020346
Total SQL describe seconds were:                    0.000492
Total seconds used by the ODBC ACCESS engine were     0.150586
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 255.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.20 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2all PURGE ) BY imp;
 
ODBC_1021: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_stroke2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084286
Total seconds used by the ODBC ACCESS engine were     0.085825
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_stroke2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
450                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w5.generic="Niacin" and q.index_date_stroke=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_stroke=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_stroke=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_stroke=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1022: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_stroke2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_stroke2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_stroke=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_stroke=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_stroke=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_stroke=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_stroke=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_stroke=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_stroke=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.921627
Total seconds used by the ODBC ACCESS engine were     6.454306
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_stroke2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_stroke2all );
 
ODBC_1023: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_stroke2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_stroke2all
 
 
ODBC_1024: Executed: on connection 2
Prepared statement ODBC_1023
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005036
451                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.051178
Total SQL prepare seconds were:                     0.020835
Total SQL describe seconds were:                    0.000536
Total seconds used by the ODBC ACCESS engine were     0.098542
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 256.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.05 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2all PURGE ) BY imp;
 
ODBC_1025: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_unsta_angina2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086613
Total seconds used by the ODBC ACCESS engine were     0.088116
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_unsta_angina2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina2all as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1026: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_unsta_angina2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
452                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_unsta_angina2all as q left 
join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.854705
Total seconds used by the ODBC ACCESS engine were     6.388930
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_unsta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_unsta_angina2all );
 
ODBC_1027: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_unsta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_unsta_angina2all
 
 
ODBC_1028: Executed: on connection 2
Prepared statement ODBC_1027
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004875
Total SQL execution seconds were:                   0.050166
Total SQL prepare seconds were:                     0.020837
Total SQL describe seconds were:                    0.000551
Total seconds used by the ODBC ACCESS engine were     0.096632
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 257.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.99 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2all PURGE ) BY imp;
 
ODBC_1029: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_sta_angina2all PURGE
 
453                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082762
Total seconds used by the ODBC ACCESS engine were     0.084348
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_sta_angina2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2all as q left join dingyig.ldlc_04_drugs as w1 
on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join dingyig.ldlc_04_drugs as w13 on 
q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join dingyig.ldlc_04_drugs as w14 on 
q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join dingyig.ldlc_04_drugs as w15 on 
q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1030: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_sta_angina2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , 
case when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid 
is not null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 
end as Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone 
, case when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_sta_angina2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_sta_angina=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_sta_angina=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_sta_angina=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_sta_angina=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_sta_angina=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina=w16.dt
 
454                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.762066
Total seconds used by the ODBC ACCESS engine were     6.293808
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_sta_angina2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_sta_angina2all );
 
ODBC_1031: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_sta_angina2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_sta_angina2all
 
 
ODBC_1032: Executed: on connection 2
Prepared statement ODBC_1031
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004920
Total SQL execution seconds were:                   0.071503
Total SQL prepare seconds were:                     0.020693
Total SQL describe seconds were:                    0.000517
Total seconds used by the ODBC ACCESS engine were     0.117877
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 258.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.91 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2all PURGE ) BY imp;
 
ODBC_1033: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_tia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084758
Total seconds used by the ODBC ACCESS engine were     0.086496
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_tia2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_tia=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join 
455                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
q.patid=w11.patid and w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1034: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_tia2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_tia2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_tia=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_tia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_tia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_tia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_tia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_tia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_tia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_tia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_tia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_tia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_tia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_tia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.946297
Total seconds used by the ODBC ACCESS engine were     6.489392
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_tia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_tia2all );
 
ODBC_1035: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_tia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_tia2all
 
 
ODBC_1036: Executed: on connection 2
Prepared statement ODBC_1035
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004850
Total SQL execution seconds were:                   0.050400
Total SQL prepare seconds were:                     0.021563
Total SQL describe seconds were:                    0.000559
456                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.097107
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 259.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.09 seconds
      cpu time            0.45 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_other2all PURGE ) BY imp;
 
ODBC_1037: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_other2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084937
Total seconds used by the ODBC ACCESS engine were     0.086589
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_other2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_other=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_other=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_other=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_other=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_other=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_other=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1038: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_other2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_other2all as q left join 
457                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_other=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_other=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.943415
Total seconds used by the ODBC ACCESS engine were     6.452470
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_other2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_other2all );
 
ODBC_1039: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_other2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_other2all
 
 
ODBC_1040: Executed: on connection 2
Prepared statement ODBC_1039
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004642
Total SQL execution seconds were:                   0.050599
Total SQL prepare seconds were:                     0.021810
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.098544
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 260.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.07 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2all PURGE ) BY imp;
 
ODBC_1041: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_revasc2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085035
458                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     0.086719
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_revasc2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_revasc=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_revasc=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_revasc=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_revasc=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1042: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_revasc2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_revasc2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_revasc=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_revasc=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_revasc=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_revasc=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_revasc=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_revasc=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_revasc=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.849103
459                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total seconds used by the ODBC ACCESS engine were     6.358823
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_revasc2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_revasc2all );
 
ODBC_1043: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_revasc2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_revasc2all
 
 
ODBC_1044: Executed: on connection 2
Prepared statement ODBC_1043
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004828
Total SQL execution seconds were:                   0.061535
Total SQL prepare seconds were:                     0.020204
Total SQL describe seconds were:                    0.000518
Total seconds used by the ODBC ACCESS engine were     0.107172
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 261.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.65 seconds
      cpu time            0.43 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2all PURGE ) BY imp;
 
ODBC_1045: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_cvd2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090141
Total seconds used by the ODBC ACCESS engine were     0.091688
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_cvd2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_cvd=w5.dt 
left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on 
q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on 
460                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w11.patid and w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1046: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_cvd2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when 
w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null 
then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_cvd2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_cvd=w1.dt left join dingyig.ldlc_04_drugs 
as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid 
and w4.generic="Fibrates" and q.index_date_cvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_cvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_cvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_cvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_cvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_cvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_cvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_cvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_cvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_cvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_cvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.914085
Total seconds used by the ODBC ACCESS engine were     6.638627
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_cvd2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_cvd2all );
 
ODBC_1047: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_cvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_cvd2all
 
 
ODBC_1048: Executed: on connection 2
Prepared statement ODBC_1047
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004788
Total SQL execution seconds were:                   0.050554
Total SQL prepare seconds were:                     0.020551
Total SQL describe seconds were:                    0.000487
Total seconds used by the ODBC ACCESS engine were     0.096542
 
MPRINT(CREATE):   QUIT;
461                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 262.
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.24 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2all PURGE ) BY imp;
 
ODBC_1049: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_anginatia2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.095653
Total seconds used by the ODBC ACCESS engine were     0.097248
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_anginatia2all AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid 
and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_anginatia=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1050: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_anginatia2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_anginatia2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia=w3.dt left join 
462                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_anginatia=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_anginatia=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_anginatia=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_anginatia=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_anginatia=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   6.086686
Total seconds used by the ODBC ACCESS engine were     6.621793
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_anginatia2all' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx_anginatia2all );
 
ODBC_1051: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_anginatia2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_anginatia2all
 
 
ODBC_1052: Executed: on connection 2
Prepared statement ODBC_1051
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004621
Total SQL execution seconds were:                   0.050999
Total SQL prepare seconds were:                     0.020913
Total SQL describe seconds were:                    0.000551
Total seconds used by the ODBC ACCESS engine were     0.096677
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 263.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.89 seconds
      cpu time            0.44 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2all PURGE ) BY imp;
 
ODBC_1053: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx_noncvd2all PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.094697
Total seconds used by the ODBC ACCESS engine were     0.096313
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx_noncvd2all AS
463                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null then 1 end as Statins , case when w2.patid is not null then 
1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not null then 1 end as Fibrates , 
case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as Mipomersen , case when w7.patid 
is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case when w9.patid is not null then 
1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when w11.patid is not null then 1 end as 
ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not null then 1 end as Niacin_Statin , 
case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null then 1 end as MRA , case when 
w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2all as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_noncvd=w11.dt left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_noncvd=w15.dt left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
MPRINT(CREATE):   ) BY imp;
 
ODBC_1054: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx_noncvd2all AS select distinct q.* , case when w1.patid is not null then 1 end as Statins , case 
when w2.patid is not null then 1 end as PCSK9i , case when w3.patid is not null then 1 end as Ezetimibe , case when w4.patid is not 
null then 1 end as Fibrates , case when w5.patid is not null then 1 end as Niacin , case when w6.patid is not null then 1 end as 
Mipomersen , case when w7.patid is not null then 1 end as Tocilizumab , case when w8.patid is not null then 1 end as Hormone , case 
when w9.patid is not null then 1 end as Fibrinolytic , case when w10.patid is not null then 1 end as Betablocker , case when 
w11.patid is not null then 1 end as ACE , case when w12.patid is not null then 1 end as Antiplatelet , case when w13.patid is not 
null then 1 end as Niacin_Statin , case when w14.patid is not null then 1 end as Loop_Diuretic , case when w15.patid is not null 
then 1 end as MRA , case when w16.patid is not null then 1 end as Anticoagulant from dingyig._12_lab1_noncvd2all as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_noncvd=w1.dt left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd=w2.dt left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd=w3.dt left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_noncvd=w4.dt left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd=w5.dt left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd=w6.dt left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_noncvd=w7.dt left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd=w8.dt left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd=w9.dt left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_noncvd=w10.dt left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd=w11.dt left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_noncvd=w12.dt left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd=w13.dt left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_noncvd=w14.dt left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd=w15.dt left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_noncvd=w16.dt
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   5.735761
Total seconds used by the ODBC ACCESS engine were     6.245802
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx_noncvd2all' As _table, COUNT(*) AS _rows FROM 
464                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig._12_demo_tx_noncvd2all );
 
ODBC_1055: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx_noncvd2all' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx_noncvd2all
 
 
ODBC_1056: Executed: on connection 2
Prepared statement ODBC_1055
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003845
Total SQL execution seconds were:                   0.053770
Total SQL prepare seconds were:                     0.018362
Total SQL describe seconds were:                    0.000481
Total seconds used by the ODBC ACCESS engine were     0.096068
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 264.
NOTE: PROCEDURE SQL used (Total process time):
      real time           6.86 seconds
      cpu time            0.45 seconds
      

141        
142        * Medications post index;
143        %macro demo_tx(year, years);
144        %do z=1 %to 2;
145        	%let groups=overall*mi*pad*stroke*unsta_angina*sta_angina*tia*other*revasc*cvd*anginatia*noncvd;
146        		%do zz=1 %to 12;
147        		%let ad = %scan(&groups., &zz., *);			
148        	%create(_12_demo_tx1_&ad.&z.&year.)
149        		select distinct q.*
150        			%do i=1 %to 16;
151        				%let tx =
151      ! %scan(Statins*PCSK9i*Ezetimibe*Fibrates*Niacin*Mipomersen*Tocilizumab*Hormone*Fibrinolytic*Betablocker*ACE*Antiplatelet*N
151      ! iacin_Statin*Loop_Diuretic*MRA*Anticoagulant, &i., *);	
152        				, case when w&i..patid is not null and q.index_date_&ad. < w&i..dt and w&i..dt<=&years. then 1 end as &tx._index
153        			%end;
154        		from dingyig._12_demo_tx_&ad.&z.&year. as q
155        			%do t=1 %to 16;
156        				%let tx =
156      ! %scan(Statins*PCSK9i*Ezetimibe*Fibrates*Niacin*Mipomersen*Tocilizumab*Hormone*Fibrinolytic*Betablocker*ACE*Antiplatelet*N
156      ! iacin_Statin*Loop_Diuretic*MRA*Anticoagulant, &t., *);	
157        				left join dingyig.ldlc_04_drugs as w&t.
158        				on q.patid=w&t..patid and w&t..generic="&tx." and q.index_date_&ad. < w&t..dt and  w&t..dt<=&years. 	
159        			%end;			
160        		
161        	%create(_12_demo_tx1_&ad.&z.&year.)
162        	%end;
163        	%end;
164        %mend demo_tx;
165        
166        %demo_tx(one_year, index_date_&ad. + INTERVAL 365 DAYS);
WARNING: Apparent symbolic reference AD not resolved.
MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
465                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_overall1one_year PURGE ) BY imp;
 
ODBC_1057: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_overall1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083784
Total seconds used by the ODBC ACCESS engine were     0.085446
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_overall1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_overall 
< w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid 
is not null and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrates_index , case 
when w5.patid is not null and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + INTERVAL 365 DAYS 
then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_overall 
< w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_overall < w10.dt and w10.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as ACE_index 
, case when w12.patid is not null and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end 
as Antiplatelet_index , case when w13.patid is not null and q.index_date_overall < w13.dt and w13.dt<=index_date_overall + INTERVAL 
365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_overall < w14.dt and 
w14.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_overall < w15.dt and w15.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is 
not null and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Anticoagulant_index 
from dingyig._12_demo_tx_overall1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" 
and q.index_date_overall < w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall < w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall < w3.dt and 
w3.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall < w6.dt and 
w6.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall < w10.dt and 
w10.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" 
and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall < w13.dt 
and w13.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall < w15.dt and 
w15.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1058: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_overall1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_overall 
< w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
466                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_overall < w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is 
not null and q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case 
when w4.patid is not null and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Fibrates_index , case when w5.patid is not null and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS 
then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_overall < w7.dt and 
w7.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and 
q.index_date_overall < w8.dt and w8.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is 
not null and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case 
when w10.patid is not null and q.index_date_overall < w10.dt and w10.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 
DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_overall < w13.dt and 
w13.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_overall < w15.dt and w15.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as MRA_index 
, case when w16.patid is not null and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end 
as Anticoagulant_index from dingyig._12_demo_tx_overall1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_overall < w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall < w5.dt and 
w5.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" 
and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall < w10.dt and 
w10.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" 
and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall < w13.dt 
and w13.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall < w15.dt and 
w15.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                 107.465816
Total seconds used by the ODBC ACCESS engine were   107.969966
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_overall1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_overall1one_year );
 
ODBC_1059: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_overall1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_overall1one_year
 
 
ODBC_1060: Executed: on connection 2
Prepared statement ODBC_1059
 
 
Summary Statistics for ODBC are:
467                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total row fetch seconds were:                       0.004315
Total SQL execution seconds were:                   0.051899
Total SQL prepare seconds were:                     0.021034
Total SQL describe seconds were:                    0.000506
Total seconds used by the ODBC ACCESS engine were     0.096671
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 265.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:48.57
      cpu time            1.04 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_mi1one_year PURGE ) BY imp;
 
ODBC_1061: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_mi1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085423
Total seconds used by the ODBC ACCESS engine were     0.086972
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_mi1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_mi < w2.dt and w2.dt<=index_date_mi 
+ INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_mi < w3.dt and 
w3.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_mi < w4.dt 
and w4.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_mi < 
w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_mi 
< w6.dt and w6.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and 
q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not 
null and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is 
not null and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when 
w10.patid is not null and q.index_date_mi < w10.dt and w10.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Betablocker_index , 
case when w11.patid is not null and q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as ACE_index 
, case when w12.patid is not null and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_mi < w13.dt and w13.dt<=index_date_mi + INTERVAL 365 DAYS 
then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_mi < w15.dt and 
w15.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_mi < w16.dt 
and w16.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_mi1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi < w2.dt and 
w2.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_mi < w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi < w6.dt and w6.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi < 
w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 
on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi < w10.dt and 
w10.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
468                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid 
and w12.generic="Antiplatelet" and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi < w13.dt and 
w13.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi < w15.dt and w15.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_mi < 
w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1062: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_mi1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_mi < w1.dt 
and w1.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_mi < 
w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_mi 
< w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and 
q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null 
and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not 
null and q.index_date_mi < w6.dt and w6.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid 
is not null and q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index 
, case when w10.patid is not null and q.index_date_mi < w10.dt and w10.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS then 
1 end as ACE_index , case when w12.patid is not null and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS 
then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_mi < w13.dt and w13.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_mi < w14.dt and 
w14.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_mi < 
w15.dt and w15.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_mi 
< w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_mi1one_year as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi < w1.dt and 
w1.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_mi < w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi < w6.dt 
and w6.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid 
and w8.generic="Hormone" and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi < w10.dt and 
w10.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid 
and w12.generic="Antiplatelet" and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi < w13.dt and 
w13.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi < w15.dt and w15.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_mi < 
w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  79.200914
Total seconds used by the ODBC ACCESS engine were    79.712715
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_mi1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_mi1one_year );
469                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_1063: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_mi1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_mi1one_year
 
 
ODBC_1064: Executed: on connection 2
Prepared statement ODBC_1063
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004879
Total SQL execution seconds were:                   0.173915
Total SQL prepare seconds were:                     0.021375
Total SQL describe seconds were:                    0.000525
Total seconds used by the ODBC ACCESS engine were     0.221268
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 266.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:20.45
      cpu time            0.79 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_pad1one_year PURGE ) BY imp;
 
ODBC_1065: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_pad1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084475
Total seconds used by the ODBC ACCESS engine were     0.085959
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_pad1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_pad < w2.dt and 
w2.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_pad < w3.dt 
and w3.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_pad < 
w4.dt and w4.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_pad < w7.dt and w7.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_pad < w8.dt and w8.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Fibrinolytic_index , case when w10.patid is not null and q.index_date_pad < w10.dt and w10.dt<=index_date_pad + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_pad < w11.dt and w11.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_pad < w12.dt and 
w12.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_pad 
< w13.dt and w13.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_pad < w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_pad1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
470                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad < w3.dt and w3.dt<=index_date_pad + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_pad < w4.dt and 
w4.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad < w7.dt and w7.dt<=index_date_pad 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad < w8.dt 
and w8.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad < w10.dt and 
w10.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_pad < w11.dt and w11.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_pad < w12.dt and w12.dt<=index_date_pad + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_pad < w13.dt and 
w13.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_pad 
< w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1066: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_pad1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_pad < w1.dt 
and w1.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_pad < 
w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_pad < w3.dt and w3.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_pad < w4.dt and w4.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_pad < w7.dt and w7.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_pad < w8.dt and w8.dt<=index_date_pad + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS 
then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_pad < w10.dt and w10.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_pad < w11.dt and 
w11.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_pad < w12.dt 
and w12.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_pad < w13.dt and w13.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_pad < w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_pad1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad < w3.dt and w3.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_pad < w4.dt 
and w4.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad < w7.dt and w7.dt<=index_date_pad 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad < w8.dt 
and w8.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad < w10.dt and 
w10.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_pad < w11.dt and w11.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_pad < w12.dt and w12.dt<=index_date_pad + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_pad < w13.dt and 
w13.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
471                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w14.generic="Loop_Diuretic" and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_pad 
< w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  42.343904
Total seconds used by the ODBC ACCESS engine were    42.868740
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_pad1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_pad1one_year );
 
ODBC_1067: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_pad1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_pad1one_year
 
 
ODBC_1068: Executed: on connection 2
Prepared statement ODBC_1067
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004587
Total SQL execution seconds were:                   0.049616
Total SQL prepare seconds were:                     0.020830
Total SQL describe seconds were:                    0.000500
Total seconds used by the ODBC ACCESS engine were     0.100655
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 267.
NOTE: PROCEDURE SQL used (Total process time):
      real time           43.14 seconds
      cpu time            0.46 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_stroke1one_year PURGE ) BY imp;
 
ODBC_1069: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_stroke1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.088345
Total seconds used by the ODBC ACCESS engine were     0.090094
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_stroke1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_stroke < w1.dt and 
w1.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_stroke < 
w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_stroke < w3.dt and w3.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_stroke < w6.dt and w6.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + 
472                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_stroke < w11.dt and w11.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_stroke < w13.dt and w13.dt<=index_date_stroke + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_stroke < w14.dt and 
w14.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_stroke < w15.dt and w15.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_stroke1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke < w3.dt and 
w3.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke < w6.dt and 
w6.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke < w11.dt and 
w11.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke < w13.dt and 
w13.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke < w14.dt and w14.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke < w15.dt and 
w15.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1070: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_stroke1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_stroke < 
w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_stroke < w3.dt and w3.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrates_index 
, case when w5.patid is not null and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_stroke < w6.dt and w6.dt<=index_date_stroke + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_stroke < w8.dt and 
w8.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_stroke < 
w9.dt and w9.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_stroke < w11.dt and w11.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_stroke < w13.dt and w13.dt<=index_date_stroke + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_stroke < w14.dt and 
w14.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_stroke < w15.dt and w15.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_stroke1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
473                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke < w3.dt and 
w3.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke < w6.dt and 
w6.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke < w11.dt and 
w11.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke < w13.dt and 
w13.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke < w14.dt and w14.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke < w15.dt and 
w15.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.728326
Total seconds used by the ODBC ACCESS engine were     8.218627
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_stroke1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_stroke1one_year );
 
ODBC_1071: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_stroke1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_stroke1one_year
 
 
ODBC_1072: Executed: on connection 2
Prepared statement ODBC_1071
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.009632
Total SQL execution seconds were:                   0.049539
Total SQL prepare seconds were:                     0.021045
Total SQL describe seconds were:                    0.000557
Total seconds used by the ODBC ACCESS engine were     0.099031
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 268.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.82 seconds
      cpu time            0.13 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_unsta_angina1one_year PURGE ) BY imp;
 
ODBC_1073: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_unsta_angina1one_year PURGE
474                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.147032
Total seconds used by the ODBC ACCESS engine were     0.148785
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_unsta_angina1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when 
w3.patid is not null and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_unsta_angina < w4.dt and w4.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_unsta_angina < w5.dt and 
w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_unsta_angina < w8.dt and w8.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_unsta_angina < w9.dt and 
w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Betablocker_index , case 
when w11.patid is not null and q.index_date_unsta_angina < w11.dt and w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as ACE_index , case when w12.patid is not null and q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_unsta_angina < w13.dt and 
w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_unsta_angina < w14.dt and w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case 
when w15.patid is not null and q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as MRA_index , case when w16.patid is not null and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_unsta_angina1one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina < w3.dt and 
w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_unsta_angina < w4.dt and w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina < w5.dt and 
w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina < w7.dt and 
w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_unsta_angina < w8.dt and w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina < w9.dt and 
w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina < w11.dt and 
w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina < w13.dt and 
w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_unsta_angina < w14.dt and w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina < w15.dt and 
w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1074: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_unsta_angina1one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when 
w2.patid is not null and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
475                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

PCSK9i_index , case when w3.patid is not null and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 
365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_unsta_angina < w4.dt and 
w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_unsta_angina < w5.dt and w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_unsta_angina < w8.dt and 
w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and 
q.index_date_unsta_angina < w9.dt and w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case 
when w10.patid is not null and q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as Betablocker_index , case when w11.patid is not null and q.index_date_unsta_angina < w11.dt and 
w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and 
q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case 
when w13.patid is not null and q.index_date_unsta_angina < w13.dt and w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_unsta_angina < w14.dt and 
w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as MRA_index , case when 
w16.patid is not null and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_unsta_angina1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid 
and w1.generic="Statins" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina < w4.dt and 
w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_unsta_angina < w5.dt and w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina < w6.dt and 
w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina < w8.dt and 
w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_unsta_angina < w9.dt and w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina < w10.dt and 
w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_unsta_angina < w11.dt and w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina < w12.dt and 
w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_unsta_angina < w13.dt and w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina < w14.dt and 
w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina < w16.dt and 
w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  10.681146
Total seconds used by the ODBC ACCESS engine were    11.173201
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_unsta_angina1one_year' As _table, COUNT(*) AS 
_rows FROM dingyig._12_demo_tx1_unsta_angina1one_year );
 
ODBC_1075: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_unsta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_unsta_angina1one_year
 
 
ODBC_1076: Executed: on connection 2
Prepared statement ODBC_1075
476                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004548
Total SQL execution seconds were:                   0.050596
Total SQL prepare seconds were:                     0.020895
Total SQL describe seconds were:                    0.000584
Total seconds used by the ODBC ACCESS engine were     0.094563
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 269.
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.83 seconds
      cpu time            0.17 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_sta_angina1one_year PURGE ) BY imp;
 
ODBC_1077: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_sta_angina1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.139754
Total seconds used by the ODBC ACCESS engine were     0.141337
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_sta_angina1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when 
w3.patid is not null and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_sta_angina < w4.dt and w4.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_sta_angina < w5.dt and 
w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_sta_angina < w7.dt and w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_sta_angina < w9.dt and 
w9.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_sta_angina < w10.dt and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
ACE_index , case when w12.patid is not null and q.index_date_sta_angina < w12.dt and w12.dt<=index_date_sta_angina + INTERVAL 365 
DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_sta_angina < w13.dt and 
w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_sta_angina < w14.dt and w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case 
when w15.patid is not null and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
MRA_index , case when w16.patid is not null and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + INTERVAL 365 
DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_sta_angina1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina < w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina < w4.dt and 
w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
477                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina < w7.dt and 
w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina < w10.dt 
and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina < w14.dt and 
w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 
on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1078: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_sta_angina1one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_sta_angina < w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when 
w2.patid is not null and q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
PCSK9i_index , case when w3.patid is not null and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 
DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_sta_angina < w4.dt and 
w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_sta_angina < w7.dt and w7.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_sta_angina < w8.dt and 
w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and 
q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when 
w10.patid is not null and q.index_date_sta_angina < w10.dt and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case 
when w14.patid is not null and q.index_date_sta_angina < w14.dt and w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Loop_Diuretic_index , case when w15.patid is not null and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_sta_angina < w16.dt and 
w16.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_sta_angina1one_year as 
q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" 
and q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina < w4.dt and 
w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina < w7.dt and 
w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina < w10.dt 
and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
478                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina < w14.dt and 
w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 
on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  65.909683
Total seconds used by the ODBC ACCESS engine were    66.394876
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_sta_angina1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_sta_angina1one_year );
 
ODBC_1079: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_sta_angina1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_sta_angina1one_year
 
 
ODBC_1080: Executed: on connection 2
Prepared statement ODBC_1079
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003465
Total SQL execution seconds were:                   0.063263
Total SQL prepare seconds were:                     0.022528
Total SQL describe seconds were:                    0.000776
Total seconds used by the ODBC ACCESS engine were     0.110379
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 270.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:06.76
      cpu time            0.66 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_tia1one_year PURGE ) BY imp;
 
ODBC_1081: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_tia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.112139
Total seconds used by the ODBC ACCESS engine were     0.114520
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_tia1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_tia < w2.dt and 
w2.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_tia < w3.dt 
and w3.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_tia < 
w4.dt and w4.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_tia < w7.dt and w7.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
479                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w8.patid is not null and q.index_date_tia < w8.dt and w8.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Fibrinolytic_index , case when w10.patid is not null and q.index_date_tia < w10.dt and w10.dt<=index_date_tia + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_tia < w11.dt and w11.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_tia < w12.dt and 
w12.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_tia 
< w13.dt and w13.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_tia < w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_tia1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia < w3.dt and w3.dt<=index_date_tia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_tia < w4.dt and 
w4.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia < w7.dt and w7.dt<=index_date_tia 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia < w8.dt 
and w8.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia < w10.dt and 
w10.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_tia < w11.dt and w11.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_tia < w12.dt and w12.dt<=index_date_tia + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_tia < w13.dt and 
w13.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_tia 
< w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1082: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_tia1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_tia < w1.dt 
and w1.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_tia < 
w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_tia < w3.dt and w3.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_tia < w4.dt and w4.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_tia < w7.dt and w7.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_tia < w8.dt and w8.dt<=index_date_tia + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS 
then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_tia < w10.dt and w10.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_tia < w11.dt and 
w11.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_tia < w12.dt 
and w12.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_tia < w13.dt and w13.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_tia < w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_tia1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia < w3.dt and w3.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_tia < w4.dt 
480                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and w4.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia < w7.dt and w7.dt<=index_date_tia 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia < w8.dt 
and w8.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia < w10.dt and 
w10.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_tia < w11.dt and w11.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_tia < w12.dt and w12.dt<=index_date_tia + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_tia < w13.dt and 
w13.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_tia 
< w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.473703
Total seconds used by the ODBC ACCESS engine were     8.016992
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_tia1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_tia1one_year );
 
ODBC_1083: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_tia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_tia1one_year
 
 
ODBC_1084: Executed: on connection 2
Prepared statement ODBC_1083
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004966
Total SQL execution seconds were:                   0.089445
Total SQL prepare seconds were:                     0.026347
Total SQL describe seconds were:                    0.000567
Total seconds used by the ODBC ACCESS engine were     0.144022
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 271.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.70 seconds
      cpu time            0.13 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_other1one_year PURGE ) BY imp;
 
ODBC_1085: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_other1one_year PURGE
 
 
Summary Statistics for ODBC are:
481                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.085304
Total seconds used by the ODBC ACCESS engine were     0.086897
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_other1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_other < w1.dt and w1.dt<=index_date_other 
+ INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_other < w2.dt and 
w2.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_other < 
w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and 
q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not 
null and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid 
is not null and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case 
when w7.patid is not null and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS 
then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_other < w9.dt and w9.dt<=index_date_other + INTERVAL 
365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_other < w10.dt and 
w10.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and 
q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not 
null and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when 
w13.patid is not null and q.index_date_other < w13.dt and w13.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Niacin_Statin_index , case when w14.patid is not null and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_other < 
w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_other1one_year 
as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other < w1.dt and 
w1.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other < w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other < w4.dt and 
w4.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other < w7.dt and 
w7.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other < w9.dt and w9.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other < w10.dt and 
w10.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other < w13.dt and 
w13.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1086: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_other1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_other < 
w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_other < w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrates_index , 
case when w5.patid is not null and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS then 1 
end as Mipomersen_index , case when w7.patid is not null and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_other < w8.dt and w8.dt<=index_date_other + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_other < w9.dt and 
482                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w9.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_other < w10.dt and w10.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid 
is not null and q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as ACE_index , case when 
w12.patid is not null and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_other < w13.dt and w13.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_other < w14.dt and 
w14.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_other < w15.dt and w15.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_other1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other < w3.dt and 
w3.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other < w6.dt and 
w6.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other < w9.dt and 
w9.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other < w10.dt and w10.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other < w11.dt and 
w11.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other < w13.dt and 
w13.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   9.858149
Total seconds used by the ODBC ACCESS engine were    10.365199
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_other1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_other1one_year );
 
ODBC_1087: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_other1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_other1one_year
 
 
ODBC_1088: Executed: on connection 2
Prepared statement ODBC_1087
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004432
Total SQL execution seconds were:                   0.051570
Total SQL prepare seconds were:                     0.021695
Total SQL describe seconds were:                    0.000526
Total seconds used by the ODBC ACCESS engine were     0.097303
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 272.
483                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           10.97 seconds
      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_revasc1one_year PURGE ) BY imp;
 
ODBC_1089: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_revasc1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086572
Total seconds used by the ODBC ACCESS engine were     0.088232
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_revasc1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_revasc < w1.dt and 
w1.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_revasc < 
w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_revasc < w3.dt and w3.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_revasc < w6.dt and w6.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_revasc < w11.dt and w11.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_revasc < w13.dt and w13.dt<=index_date_revasc + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_revasc < w14.dt and 
w14.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_revasc < w15.dt and w15.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_revasc1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc < w3.dt and 
w3.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc < w6.dt and 
w6.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc < w11.dt and 
w11.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc < w13.dt and 
w13.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc < w14.dt and w14.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
484                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc < w15.dt and 
w15.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1090: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_revasc1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_revasc < 
w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_revasc < w3.dt and w3.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrates_index 
, case when w5.patid is not null and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_revasc < w6.dt and w6.dt<=index_date_revasc + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_revasc < w8.dt and 
w8.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_revasc < 
w9.dt and w9.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_revasc < w11.dt and w11.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_revasc < w13.dt and w13.dt<=index_date_revasc + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_revasc < w14.dt and 
w14.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_revasc < w15.dt and w15.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_revasc1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc < w3.dt and 
w3.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc < w6.dt and 
w6.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc < w11.dt and 
w11.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc < w13.dt and 
w13.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc < w14.dt and w14.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc < w15.dt and 
w15.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  15.033042
Total seconds used by the ODBC ACCESS engine were    15.537522
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_revasc1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_revasc1one_year );
 
ODBC_1091: Prepared: on connection 2
485                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

SELECT 'dingyig._12_demo_tx1_revasc1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_revasc1one_year
 
 
ODBC_1092: Executed: on connection 2
Prepared statement ODBC_1091
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004601
Total SQL execution seconds were:                   0.054605
Total SQL prepare seconds were:                     0.020606
Total SQL describe seconds were:                    0.000524
Total seconds used by the ODBC ACCESS engine were     0.099286
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 273.
NOTE: PROCEDURE SQL used (Total process time):
      real time           16.16 seconds
      cpu time            0.21 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_cvd1one_year PURGE ) BY imp;
 
ODBC_1093: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_cvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.099084
Total seconds used by the ODBC ACCESS engine were     0.100735
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_cvd1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_cvd < w2.dt and 
w2.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_cvd < w3.dt 
and w3.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_cvd < 
w4.dt and w4.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_cvd < w8.dt and w8.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
Fibrinolytic_index , case when w10.patid is not null and q.index_date_cvd < w10.dt and w10.dt<=index_date_cvd + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_cvd < w12.dt and 
w12.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_cvd 
< w13.dt and w13.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_cvd < w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_cvd1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_cvd < w4.dt and 
486                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w4.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd < w8.dt 
and w8.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd < w10.dt and 
w10.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_cvd < w12.dt and w12.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_cvd < w13.dt and 
w13.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_cvd 
< w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1094: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_cvd1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_cvd < w1.dt 
and w1.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_cvd < 
w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_cvd < w4.dt and w4.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_cvd < w8.dt and w8.dt<=index_date_cvd + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS 
then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_cvd < w10.dt and w10.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_cvd < w11.dt and 
w11.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_cvd < w12.dt 
and w12.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_cvd < w13.dt and w13.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_cvd < w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_cvd1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_cvd < w4.dt 
and w4.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd < w8.dt 
and w8.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd < w10.dt and 
w10.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_cvd < w12.dt and w12.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_cvd < w13.dt and 
w13.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + 
487                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_cvd 
< w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  79.428255
Total seconds used by the ODBC ACCESS engine were    79.950790
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_cvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_cvd1one_year );
 
ODBC_1095: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_cvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_cvd1one_year
 
 
ODBC_1096: Executed: on connection 2
Prepared statement ODBC_1095
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004845
Total SQL execution seconds were:                   0.060767
Total SQL prepare seconds were:                     0.022546
Total SQL describe seconds were:                    0.000498
Total seconds used by the ODBC ACCESS engine were     0.108818
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 274.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:20.58
      cpu time            0.75 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_anginatia1one_year PURGE ) BY imp;
 
ODBC_1097: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_anginatia1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.106600
Total seconds used by the ODBC ACCESS engine were     0.108182
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_anginatia1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid 
is not null and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , 
case when w4.patid is not null and q.index_date_anginatia < w4.dt and w4.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Fibrates_index , case when w5.patid is not null and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia 
+ INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and 
q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid 
is not null and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index 
488                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

, case when w10.patid is not null and q.index_date_anginatia < w10.dt and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 
end as Betablocker_index , case when w11.patid is not null and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when 
w14.patid is not null and q.index_date_anginatia < w14.dt and w14.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Loop_Diuretic_index , case when w15.patid is not null and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + 
INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_anginatia < w16.dt and 
w16.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_anginatia1one_year as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" 
and q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia < w4.dt and 
w4.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia < w10.dt 
and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia < w14.dt and 
w14.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 
365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1098: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_anginatia1one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_anginatia < w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid 
is not null and q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , 
case when w3.patid is not null and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_anginatia < w4.dt and w4.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_anginatia < w5.dt and 
w5.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_anginatia < w7.dt and w7.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 
365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_anginatia < w9.dt and 
w9.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_anginatia < w10.dt and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
ACE_index , case when w12.patid is not null and q.index_date_anginatia < w12.dt and w12.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_anginatia < w13.dt and 
w13.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_anginatia < w14.dt and w14.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
MRA_index , case when w16.patid is not null and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_anginatia1one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia < w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia < w2.dt and 
489                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia < w4.dt and 
w4.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia < w10.dt 
and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia < w14.dt and 
w14.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 
365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                 126.621938
Total seconds used by the ODBC ACCESS engine were   127.103102
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_anginatia1one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_anginatia1one_year );
 
ODBC_1099: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_anginatia1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_anginatia1one_year
 
 
ODBC_1100: Executed: on connection 2
Prepared statement ODBC_1099
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004096
Total SQL execution seconds were:                   0.061701
Total SQL prepare seconds were:                     0.028758
Total SQL describe seconds were:                    0.000631
Total seconds used by the ODBC ACCESS engine were     0.113768
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 275.
NOTE: PROCEDURE SQL used (Total process time):
      real time           2:07.75
      cpu time            1.20 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_noncvd1one_year PURGE ) BY imp;
 
ODBC_1101: Executed: on connection 2
490                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DROP TABLE IF EXISTS dingyig._12_demo_tx1_noncvd1one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084869
Total seconds used by the ODBC ACCESS engine were     0.086519
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_noncvd1one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_noncvd < w1.dt and 
w1.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_noncvd < 
w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_noncvd < w3.dt and w3.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_noncvd < w6.dt and w6.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_noncvd < w11.dt and w11.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_noncvd < w13.dt and w13.dt<=index_date_noncvd + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_noncvd < w14.dt and 
w14.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_noncvd < w15.dt and w15.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_noncvd1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd < w3.dt and 
w3.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd < w6.dt and 
w6.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd < w11.dt and 
w11.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd < w13.dt and 
w13.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd < w14.dt and w14.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd < w15.dt and 
w15.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1102: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_noncvd1one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_noncvd < 
w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_noncvd < w3.dt and w3.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrates_index 
491                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

, case when w5.patid is not null and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_noncvd < w6.dt and w6.dt<=index_date_noncvd + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_noncvd < w8.dt and 
w8.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_noncvd < 
w9.dt and w9.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_noncvd < w11.dt and w11.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_noncvd < w13.dt and w13.dt<=index_date_noncvd + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_noncvd < w14.dt and 
w14.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_noncvd < w15.dt and w15.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_noncvd1one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd < w3.dt and 
w3.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd < w6.dt and 
w6.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd < w11.dt and 
w11.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd < w13.dt and 
w13.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd < w14.dt and w14.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd < w15.dt and 
w15.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  16.041195
Total seconds used by the ODBC ACCESS engine were    16.556897
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_noncvd1one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_noncvd1one_year );
 
ODBC_1103: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_noncvd1one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_noncvd1one_year
 
 
ODBC_1104: Executed: on connection 2
Prepared statement ODBC_1103
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005114
Total SQL execution seconds were:                   0.115801
Total SQL prepare seconds were:                     0.020481
492                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL describe seconds were:                    0.000537
Total seconds used by the ODBC ACCESS engine were     0.161243
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 276.
NOTE: PROCEDURE SQL used (Total process time):
      real time           16.88 seconds
      cpu time            0.20 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_overall2one_year PURGE ) BY imp;
 
ODBC_1105: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_overall2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.094454
Total seconds used by the ODBC ACCESS engine were     0.096149
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_overall2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_overall < w1.dt and 
w1.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_overall 
< w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid 
is not null and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrates_index , case 
when w5.patid is not null and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + INTERVAL 365 DAYS 
then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_overall 
< w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_overall < w10.dt and w10.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as ACE_index 
, case when w12.patid is not null and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end 
as Antiplatelet_index , case when w13.patid is not null and q.index_date_overall < w13.dt and w13.dt<=index_date_overall + INTERVAL 
365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_overall < w14.dt and 
w14.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_overall < w15.dt and w15.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is 
not null and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Anticoagulant_index 
from dingyig._12_demo_tx_overall2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" 
and q.index_date_overall < w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall < w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_overall < w3.dt and 
w3.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_overall < w6.dt and 
w6.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall < w10.dt and 
w10.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" 
493                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall < w13.dt 
and w13.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall < w15.dt and 
w15.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1106: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_overall2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_overall 
< w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_overall < w2.dt and w2.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is 
not null and q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case 
when w4.patid is not null and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Fibrates_index , case when w5.patid is not null and q.index_date_overall < w5.dt and w5.dt<=index_date_overall + INTERVAL 365 DAYS 
then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_overall < w7.dt and 
w7.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and 
q.index_date_overall < w8.dt and w8.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is 
not null and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case 
when w10.patid is not null and q.index_date_overall < w10.dt and w10.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 
DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + 
INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_overall < w13.dt and 
w13.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_overall < w15.dt and w15.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end as MRA_index 
, case when w16.patid is not null and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS then 1 end 
as Anticoagulant_index from dingyig._12_demo_tx_overall2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_overall < w1.dt and w1.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_overall < w2.dt and 
w2.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" 
and q.index_date_overall < w3.dt and w3.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on 
q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_overall < w4.dt and w4.dt<=index_date_overall + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_overall < w5.dt and 
w5.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" 
and q.index_date_overall < w6.dt and w6.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on 
q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_overall < w7.dt and w7.dt<=index_date_overall + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_overall < w8.dt and 
w8.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_overall < w9.dt and w9.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_overall < w10.dt and 
w10.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" 
and q.index_date_overall < w11.dt and w11.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_overall < w12.dt and w12.dt<=index_date_overall + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_overall < w13.dt 
and w13.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_overall < w14.dt and w14.dt<=index_date_overall + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_overall < w15.dt and 
w15.dt<=index_date_overall + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_overall < w16.dt and w16.dt<=index_date_overall + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  24.489825
Total seconds used by the ODBC ACCESS engine were    25.031806
494                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_overall2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_overall2one_year );
 
ODBC_1107: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_overall2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_overall2one_year
 
 
ODBC_1108: Executed: on connection 2
Prepared statement ODBC_1107
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.005030
Total SQL execution seconds were:                   0.066663
Total SQL prepare seconds were:                     0.021693
Total SQL describe seconds were:                    0.000567
Total seconds used by the ODBC ACCESS engine were     0.113209
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 277.
NOTE: PROCEDURE SQL used (Total process time):
      real time           25.32 seconds
      cpu time            0.28 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_mi2one_year PURGE ) BY imp;
 
ODBC_1109: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_mi2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090945
Total seconds used by the ODBC ACCESS engine were     0.092670
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_mi2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_mi < w2.dt and w2.dt<=index_date_mi 
+ INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_mi < w3.dt and 
w3.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_mi < w4.dt 
and w4.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_mi < 
w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_mi 
< w6.dt and w6.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and 
q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not 
null and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is 
not null and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when 
w10.patid is not null and q.index_date_mi < w10.dt and w10.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Betablocker_index , 
case when w11.patid is not null and q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as ACE_index 
, case when w12.patid is not null and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_mi < w13.dt and w13.dt<=index_date_mi + INTERVAL 365 DAYS 
then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_mi < w15.dt and 
w15.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_mi < w16.dt 
and w16.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_mi2one_year as q left join 
495                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi < w1.dt and w1.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_mi < w2.dt and 
w2.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and 
q.index_date_mi < w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi < w6.dt and w6.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_mi < 
w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 
on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi < w10.dt and 
w10.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid 
and w12.generic="Antiplatelet" and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi < w13.dt and 
w13.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi < w15.dt and w15.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_mi < 
w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1110: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_mi2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_mi < w1.dt 
and w1.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_mi < 
w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_mi 
< w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and 
q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null 
and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not 
null and q.index_date_mi < w6.dt and w6.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid 
is not null and q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index 
, case when w10.patid is not null and q.index_date_mi < w10.dt and w10.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS then 
1 end as ACE_index , case when w12.patid is not null and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS 
then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_mi < w13.dt and w13.dt<=index_date_mi + 
INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_mi < w14.dt and 
w14.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_mi < 
w15.dt and w15.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_mi 
< w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_mi2one_year as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_mi < w1.dt and 
w1.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_mi < w2.dt and w2.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_mi < w3.dt and w3.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_mi < w4.dt and w4.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_mi < w5.dt and w5.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_mi < w6.dt 
and w6.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_mi < w7.dt and w7.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid 
and w8.generic="Hormone" and q.index_date_mi < w8.dt and w8.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_mi < w9.dt and w9.dt<=index_date_mi + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_mi < w10.dt and 
w10.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_mi < w11.dt and w11.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid 
and w12.generic="Antiplatelet" and q.index_date_mi < w12.dt and w12.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_mi < w13.dt and 
496                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w13.dt<=index_date_mi + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_mi < w14.dt and w14.dt<=index_date_mi + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_mi < w15.dt and w15.dt<=index_date_mi + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_mi < 
w16.dt and w16.dt<=index_date_mi + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  18.516747
Total seconds used by the ODBC ACCESS engine were    19.187033
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_mi2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_mi2one_year );
 
ODBC_1111: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_mi2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_mi2one_year
 
 
ODBC_1112: Executed: on connection 2
Prepared statement ODBC_1111
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004217
Total SQL execution seconds were:                   0.055219
Total SQL prepare seconds were:                     0.020475
Total SQL describe seconds were:                    0.000520
Total seconds used by the ODBC ACCESS engine were     0.099069
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 278.
NOTE: PROCEDURE SQL used (Total process time):
      real time           2:27.12
      cpu time            0.22 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_pad2one_year PURGE ) BY imp;
 
ODBC_1113: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_pad2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086884
Total seconds used by the ODBC ACCESS engine were     0.088440
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_pad2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_pad < w2.dt and 
w2.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_pad < w3.dt 
and w3.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_pad < 
w4.dt and w4.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_pad < w7.dt and w7.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
497                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w8.patid is not null and q.index_date_pad < w8.dt and w8.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Fibrinolytic_index , case when w10.patid is not null and q.index_date_pad < w10.dt and w10.dt<=index_date_pad + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_pad < w11.dt and w11.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_pad < w12.dt and 
w12.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_pad 
< w13.dt and w13.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_pad < w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_pad2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad < w3.dt and w3.dt<=index_date_pad + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_pad < w4.dt and 
w4.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad < w7.dt and w7.dt<=index_date_pad 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad < w8.dt 
and w8.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad < w10.dt and 
w10.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_pad < w11.dt and w11.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_pad < w12.dt and w12.dt<=index_date_pad + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_pad < w13.dt and 
w13.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_pad 
< w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1114: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_pad2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_pad < w1.dt 
and w1.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_pad < 
w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_pad < w3.dt and w3.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_pad < w4.dt and w4.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_pad < w7.dt and w7.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_pad < w8.dt and w8.dt<=index_date_pad + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS 
then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_pad < w10.dt and w10.dt<=index_date_pad + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_pad < w11.dt and 
w11.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_pad < w12.dt 
and w12.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_pad < w13.dt and w13.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_pad < w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_pad2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_pad < w1.dt and w1.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_pad < w2.dt and w2.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_pad < w3.dt and w3.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_pad < w4.dt 
498                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and w4.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_pad < w5.dt and w5.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_pad < w6.dt and w6.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_pad < w7.dt and w7.dt<=index_date_pad 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_pad < w8.dt 
and w8.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_pad < w9.dt and w9.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_pad < w10.dt and 
w10.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_pad < w11.dt and w11.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_pad < w12.dt and w12.dt<=index_date_pad + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_pad < w13.dt and 
w13.dt<=index_date_pad + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_pad < w14.dt and w14.dt<=index_date_pad + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_pad < w15.dt and w15.dt<=index_date_pad + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_pad 
< w16.dt and w16.dt<=index_date_pad + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  17.235836
Total seconds used by the ODBC ACCESS engine were    17.755516
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_pad2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_pad2one_year );
 
ODBC_1115: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_pad2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_pad2one_year
 
 
ODBC_1116: Executed: on connection 2
Prepared statement ODBC_1115
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003872
Total SQL execution seconds were:                   0.049931
Total SQL prepare seconds were:                     0.020926
Total SQL describe seconds were:                    0.000511
Total seconds used by the ODBC ACCESS engine were     0.094536
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 279.
NOTE: PROCEDURE SQL used (Total process time):
      real time           18.03 seconds
      cpu time            0.22 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_stroke2one_year PURGE ) BY imp;
 
ODBC_1117: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_stroke2one_year PURGE
 
 
Summary Statistics for ODBC are:
499                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Total SQL execution seconds were:                   0.084734
Total seconds used by the ODBC ACCESS engine were     0.086186
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_stroke2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_stroke < w1.dt and 
w1.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_stroke < 
w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_stroke < w3.dt and w3.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_stroke < w6.dt and w6.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_stroke < w11.dt and w11.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_stroke < w13.dt and w13.dt<=index_date_stroke + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_stroke < w14.dt and 
w14.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_stroke < w15.dt and w15.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_stroke2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke < w3.dt and 
w3.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke < w6.dt and 
w6.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke < w11.dt and 
w11.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke < w13.dt and 
w13.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke < w14.dt and w14.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke < w15.dt and 
w15.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1118: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_stroke2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_stroke < 
w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_stroke < w3.dt and w3.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrates_index 
, case when w5.patid is not null and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_stroke < w6.dt and w6.dt<=index_date_stroke + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_stroke < w8.dt and 
500                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w8.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_stroke < 
w9.dt and w9.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_stroke < w11.dt and w11.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_stroke < w13.dt and w13.dt<=index_date_stroke + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_stroke < w14.dt and 
w14.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_stroke < w15.dt and w15.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_stroke2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_stroke < w1.dt and w1.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_stroke < w2.dt and w2.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_stroke < w3.dt and 
w3.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_stroke < w4.dt and w4.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_stroke < w5.dt and w5.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_stroke < w6.dt and 
w6.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_stroke < w7.dt and w7.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_stroke < w8.dt and w8.dt<=index_date_stroke + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_stroke < w9.dt and 
w9.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_stroke < w10.dt and w10.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_stroke < w11.dt and 
w11.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_stroke < w12.dt and w12.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_stroke < w13.dt and 
w13.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_stroke < w14.dt and w14.dt<=index_date_stroke + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_stroke < w15.dt and 
w15.dt<=index_date_stroke + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_stroke < w16.dt and w16.dt<=index_date_stroke + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  18.186736
Total seconds used by the ODBC ACCESS engine were    18.789112
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_stroke2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_stroke2one_year );
 
ODBC_1119: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_stroke2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_stroke2one_year
 
 
ODBC_1120: Executed: on connection 2
Prepared statement ODBC_1119
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004102
Total SQL execution seconds were:                   0.050457
Total SQL prepare seconds were:                     0.020782
Total SQL describe seconds were:                    0.000756
Total seconds used by the ODBC ACCESS engine were     0.097440
 
MPRINT(CREATE):   QUIT;
501                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

NOTE: The PROCEDURE SQL printed page 280.
NOTE: PROCEDURE SQL used (Total process time):
      real time           19.04 seconds
      cpu time            0.23 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_unsta_angina2one_year PURGE ) BY imp;
 
ODBC_1121: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_unsta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.087100
Total seconds used by the ODBC ACCESS engine were     0.088615
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_unsta_angina2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when 
w3.patid is not null and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_unsta_angina < w4.dt and w4.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_unsta_angina < w5.dt and 
w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_unsta_angina < w8.dt and w8.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_unsta_angina < w9.dt and 
w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Betablocker_index , case 
when w11.patid is not null and q.index_date_unsta_angina < w11.dt and w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as ACE_index , case when w12.patid is not null and q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_unsta_angina < w13.dt and 
w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_unsta_angina < w14.dt and w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case 
when w15.patid is not null and q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as MRA_index , case when w16.patid is not null and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_unsta_angina2one_year as q left join 
dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_unsta_angina < w1.dt and 
w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and 
w2.generic="PCSK9i" and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_unsta_angina < w3.dt and 
w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and 
w4.generic="Fibrates" and q.index_date_unsta_angina < w4.dt and w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and q.index_date_unsta_angina < w5.dt and 
w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and 
w6.generic="Mipomersen" and q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_unsta_angina < w7.dt and 
w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and 
w8.generic="Hormone" and q.index_date_unsta_angina < w8.dt and w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_unsta_angina < w9.dt and 
w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_unsta_angina < w11.dt and 
w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
502                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w12.generic="Antiplatelet" and q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_unsta_angina < w13.dt and 
w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_unsta_angina < w14.dt and w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_unsta_angina < w15.dt and 
w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1122: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_unsta_angina2one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when 
w2.patid is not null and q.index_date_unsta_angina < w2.dt and w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
PCSK9i_index , case when w3.patid is not null and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 
365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_unsta_angina < w4.dt and 
w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_unsta_angina < w5.dt and w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_unsta_angina < w6.dt and w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + 
INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_unsta_angina < w8.dt and 
w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and 
q.index_date_unsta_angina < w9.dt and w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case 
when w10.patid is not null and q.index_date_unsta_angina < w10.dt and w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as Betablocker_index , case when w11.patid is not null and q.index_date_unsta_angina < w11.dt and 
w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and 
q.index_date_unsta_angina < w12.dt and w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case 
when w13.patid is not null and q.index_date_unsta_angina < w13.dt and w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 
end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_unsta_angina < w14.dt and 
w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as MRA_index , case when 
w16.patid is not null and q.index_date_unsta_angina < w16.dt and w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_unsta_angina2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid 
and w1.generic="Statins" and q.index_date_unsta_angina < w1.dt and w1.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_unsta_angina < w2.dt and 
w2.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_unsta_angina < w3.dt and w3.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_unsta_angina < w4.dt and 
w4.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and 
w5.generic="Niacin" and q.index_date_unsta_angina < w5.dt and w5.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_unsta_angina < w6.dt and 
w6.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and 
w7.generic="Tocilizumab" and q.index_date_unsta_angina < w7.dt and w7.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_unsta_angina < w8.dt and 
w8.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_unsta_angina < w9.dt and w9.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_unsta_angina < w10.dt and 
w10.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_unsta_angina < w11.dt and w11.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_unsta_angina < w12.dt and 
w12.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_unsta_angina < w13.dt and w13.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_unsta_angina < w14.dt and 
w14.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and 
w15.generic="MRA" and q.index_date_unsta_angina < w15.dt and w15.dt<=index_date_unsta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_unsta_angina < w16.dt and 
w16.dt<=index_date_unsta_angina + INTERVAL 365 DAYS
 
 
503                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                  16.644373
Total seconds used by the ODBC ACCESS engine were    17.173881
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_unsta_angina2one_year' As _table, COUNT(*) AS 
_rows FROM dingyig._12_demo_tx1_unsta_angina2one_year );
 
ODBC_1123: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_unsta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_unsta_angina2one_year
 
 
ODBC_1124: Executed: on connection 2
Prepared statement ODBC_1123
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004385
Total SQL execution seconds were:                   0.062260
Total SQL prepare seconds were:                     0.021309
Total SQL describe seconds were:                    0.000505
Total seconds used by the ODBC ACCESS engine were     0.107940
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 281.
NOTE: PROCEDURE SQL used (Total process time):
      real time           17.88 seconds
      cpu time            0.21 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_sta_angina2one_year PURGE ) BY imp;
 
ODBC_1125: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_sta_angina2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.083639
Total seconds used by the ODBC ACCESS engine were     0.085276
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_sta_angina2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when 
w3.patid is not null and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_sta_angina < w4.dt and w4.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_sta_angina < w5.dt and 
w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_sta_angina < w7.dt and w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_sta_angina < w9.dt and 
w9.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_sta_angina < w10.dt and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
ACE_index , case when w12.patid is not null and q.index_date_sta_angina < w12.dt and w12.dt<=index_date_sta_angina + INTERVAL 365 
504                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_sta_angina < w13.dt and 
w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_sta_angina < w14.dt and w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case 
when w15.patid is not null and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
MRA_index , case when w16.patid is not null and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + INTERVAL 365 
DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_sta_angina2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina < w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_sta_angina < w2.dt and 
w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina < w4.dt and 
w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina < w7.dt and 
w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina < w10.dt 
and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina < w14.dt and 
w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 
on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1126: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_sta_angina2one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_sta_angina < w1.dt and w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Statins_index , case when 
w2.patid is not null and q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
PCSK9i_index , case when w3.patid is not null and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 
DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_sta_angina < w4.dt and 
w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_sta_angina < w7.dt and w7.dt<=index_date_sta_angina + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_sta_angina < w8.dt and 
w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and 
q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when 
w10.patid is not null and q.index_date_sta_angina < w10.dt and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Betablocker_index , case when w11.patid is not null and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case 
when w14.patid is not null and q.index_date_sta_angina < w14.dt and w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as 
Loop_Diuretic_index , case when w15.patid is not null and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_sta_angina < w16.dt and 
w16.dt<=index_date_sta_angina + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_sta_angina2one_year as 
q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_sta_angina < w1.dt and 
w1.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" 
and q.index_date_sta_angina < w2.dt and w2.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_sta_angina < w3.dt and w3.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_sta_angina < w4.dt and 
505                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w4.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_sta_angina < w5.dt and w5.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_sta_angina < w6.dt and w6.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_sta_angina < w7.dt and 
w7.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_sta_angina < w8.dt and w8.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_sta_angina < w9.dt and w9.dt<=index_date_sta_angina + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_sta_angina < w10.dt 
and w10.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_sta_angina < w11.dt and w11.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_sta_angina < w12.dt and 
w12.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_sta_angina < w13.dt and w13.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_sta_angina < w14.dt and 
w14.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_sta_angina < w15.dt and w15.dt<=index_date_sta_angina + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 
on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_sta_angina < w16.dt and w16.dt<=index_date_sta_angina + 
INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  11.958029
Total seconds used by the ODBC ACCESS engine were    12.479066
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_sta_angina2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_sta_angina2one_year );
 
ODBC_1127: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_sta_angina2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_sta_angina2one_year
 
 
ODBC_1128: Executed: on connection 2
Prepared statement ODBC_1127
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004622
Total SQL execution seconds were:                   0.072233
Total SQL prepare seconds were:                     0.019985
Total SQL describe seconds were:                    0.000470
Total seconds used by the ODBC ACCESS engine were     0.117592
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 282.
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.76 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_tia2one_year PURGE ) BY imp;
 
ODBC_1129: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_tia2one_year PURGE
 
 
506                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.085827
Total seconds used by the ODBC ACCESS engine were     0.087507
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_tia2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_tia < w2.dt and 
w2.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_tia < w3.dt 
and w3.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_tia < 
w4.dt and w4.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_tia < w7.dt and w7.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_tia < w8.dt and w8.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Fibrinolytic_index , case when w10.patid is not null and q.index_date_tia < w10.dt and w10.dt<=index_date_tia + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_tia < w11.dt and w11.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_tia < w12.dt and 
w12.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_tia 
< w13.dt and w13.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_tia < w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_tia2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia < w3.dt and w3.dt<=index_date_tia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_tia < w4.dt and 
w4.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia < w7.dt and w7.dt<=index_date_tia 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia < w8.dt 
and w8.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia < w10.dt and 
w10.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_tia < w11.dt and w11.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_tia < w12.dt and w12.dt<=index_date_tia + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_tia < w13.dt and 
w13.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_tia 
< w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1130: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_tia2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_tia < w1.dt 
and w1.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_tia < 
w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_tia < w3.dt and w3.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_tia < w4.dt and w4.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_tia < w7.dt and w7.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_tia < w8.dt and w8.dt<=index_date_tia + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS 
507                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_tia < w10.dt and w10.dt<=index_date_tia + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_tia < w11.dt and 
w11.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_tia < w12.dt 
and w12.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_tia < w13.dt and w13.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_tia < w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_tia2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_tia < w1.dt and w1.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_tia < w2.dt and w2.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_tia < w3.dt and w3.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_tia < w4.dt 
and w4.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_tia < w5.dt and w5.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_tia < w6.dt and w6.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_tia < w7.dt and w7.dt<=index_date_tia 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_tia < w8.dt 
and w8.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_tia < w9.dt and w9.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_tia < w10.dt and 
w10.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_tia < w11.dt and w11.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_tia < w12.dt and w12.dt<=index_date_tia + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_tia < w13.dt and 
w13.dt<=index_date_tia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_tia < w14.dt and w14.dt<=index_date_tia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_tia < w15.dt and w15.dt<=index_date_tia + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_tia 
< w16.dt and w16.dt<=index_date_tia + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   9.857706
Total seconds used by the ODBC ACCESS engine were    10.376115
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_tia2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_tia2one_year );
 
ODBC_1131: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_tia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_tia2one_year
 
 
ODBC_1132: Executed: on connection 2
Prepared statement ODBC_1131
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.003840
Total SQL execution seconds were:                   0.050030
Total SQL prepare seconds were:                     0.019777
Total SQL describe seconds were:                    0.000524
Total seconds used by the ODBC ACCESS engine were     0.092951
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 283.
NOTE: PROCEDURE SQL used (Total process time):
      real time           10.97 seconds
508                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

      cpu time            0.15 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_other2one_year PURGE ) BY imp;
 
ODBC_1133: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_other2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.082664
Total seconds used by the ODBC ACCESS engine were     0.084291
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_other2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_other < w1.dt and w1.dt<=index_date_other 
+ INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_other < w2.dt and 
w2.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_other < 
w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and 
q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not 
null and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid 
is not null and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case 
when w7.patid is not null and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS 
then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_other < w9.dt and w9.dt<=index_date_other + INTERVAL 
365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_other < w10.dt and 
w10.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and 
q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not 
null and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when 
w13.patid is not null and q.index_date_other < w13.dt and w13.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Niacin_Statin_index , case when w14.patid is not null and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_other < 
w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_other2one_year 
as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_other < w1.dt and 
w1.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and 
q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other < w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_other < w4.dt and 
w4.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_other < w7.dt and 
w7.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and 
q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other < w9.dt and w9.dt<=index_date_other + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_other < w10.dt and 
w10.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other < w13.dt and 
w13.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS
509                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   ) BY imp;
 
ODBC_1134: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_other2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_other < 
w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_other < w3.dt and w3.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrates_index , 
case when w5.patid is not null and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_other < w6.dt and w6.dt<=index_date_other + INTERVAL 365 DAYS then 1 
end as Mipomersen_index , case when w7.patid is not null and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_other < w8.dt and w8.dt<=index_date_other + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_other < w9.dt and 
w9.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_other < w10.dt and w10.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid 
is not null and q.index_date_other < w11.dt and w11.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as ACE_index , case when 
w12.patid is not null and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_other < w13.dt and w13.dt<=index_date_other + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_other < w14.dt and 
w14.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_other < w15.dt and w15.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_other2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_other < w1.dt and w1.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_other < w2.dt and w2.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_other < w3.dt and 
w3.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and 
q.index_date_other < w4.dt and w4.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_other < w5.dt and w5.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_other < w6.dt and 
w6.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_other < w7.dt and w7.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_other < w8.dt and w8.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_other < w9.dt and 
w9.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_other < w10.dt and w10.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_other < w11.dt and 
w11.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_other < w12.dt and w12.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_other < w13.dt and 
w13.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_other < w14.dt and w14.dt<=index_date_other + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_other < w15.dt and 
w15.dt<=index_date_other + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_other < w16.dt and w16.dt<=index_date_other + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.646222
Total seconds used by the ODBC ACCESS engine were     8.179428
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_other2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_other2one_year );
 
ODBC_1135: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_other2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_other2one_year
 
 
510                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

ODBC_1136: Executed: on connection 2
Prepared statement ODBC_1135
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004983
Total SQL execution seconds were:                   0.050170
Total SQL prepare seconds were:                     0.021470
Total SQL describe seconds were:                    0.000463
Total seconds used by the ODBC ACCESS engine were     0.100177
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 284.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.78 seconds
      cpu time            0.13 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_revasc2one_year PURGE ) BY imp;
 
ODBC_1137: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_revasc2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.097631
Total seconds used by the ODBC ACCESS engine were     0.099946
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_revasc2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_revasc < w1.dt and 
w1.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_revasc < 
w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_revasc < w3.dt and w3.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_revasc < w6.dt and w6.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_revasc < w11.dt and w11.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_revasc < w13.dt and w13.dt<=index_date_revasc + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_revasc < w14.dt and 
w14.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_revasc < w15.dt and w15.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_revasc2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc < w3.dt and 
w3.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
511                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc < w6.dt and 
w6.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc < w11.dt and 
w11.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc < w13.dt and 
w13.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc < w14.dt and w14.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc < w15.dt and 
w15.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1138: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_revasc2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_revasc < 
w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_revasc < w3.dt and w3.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrates_index 
, case when w5.patid is not null and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_revasc < w6.dt and w6.dt<=index_date_revasc + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_revasc < w8.dt and 
w8.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_revasc < 
w9.dt and w9.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_revasc < w11.dt and w11.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_revasc < w13.dt and w13.dt<=index_date_revasc + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_revasc < w14.dt and 
w14.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_revasc < w15.dt and w15.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_revasc2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_revasc < w1.dt and w1.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_revasc < w2.dt and w2.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_revasc < w3.dt and 
w3.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_revasc < w4.dt and w4.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_revasc < w5.dt and w5.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_revasc < w6.dt and 
w6.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_revasc < w7.dt and w7.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_revasc < w8.dt and w8.dt<=index_date_revasc + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_revasc < w9.dt and 
w9.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_revasc < w10.dt and w10.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_revasc < w11.dt and 
w11.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_revasc < w12.dt and w12.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_revasc < w13.dt and 
w13.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_revasc < w14.dt and w14.dt<=index_date_revasc + INTERVAL 365 DAYS left join 
512                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_revasc < w15.dt and 
w15.dt<=index_date_revasc + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_revasc < w16.dt and w16.dt<=index_date_revasc + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  16.440843
Total seconds used by the ODBC ACCESS engine were    16.948102
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_revasc2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_revasc2one_year );
 
ODBC_1139: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_revasc2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_revasc2one_year
 
 
ODBC_1140: Executed: on connection 2
Prepared statement ODBC_1139
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004252
Total SQL execution seconds were:                   0.128201
Total SQL prepare seconds were:                     0.020785
Total SQL describe seconds were:                    0.000509
Total seconds used by the ODBC ACCESS engine were     0.172747
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 285.
NOTE: PROCEDURE SQL used (Total process time):
      real time           17.65 seconds
      cpu time            0.24 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_cvd2one_year PURGE ) BY imp;
 
ODBC_1141: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_cvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.086361
Total seconds used by the ODBC ACCESS engine were     0.087911
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_cvd2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_cvd < w2.dt and 
w2.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and q.index_date_cvd < w3.dt 
and w3.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not null and q.index_date_cvd < 
w4.dt and w4.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid is not null and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null 
and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is 
not null and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when 
w8.patid is not null and q.index_date_cvd < w8.dt and w8.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Hormone_index , case 
when w9.patid is not null and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
513                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

Fibrinolytic_index , case when w10.patid is not null and q.index_date_cvd < w10.dt and w10.dt<=index_date_cvd + INTERVAL 365 DAYS 
then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_cvd < w12.dt and 
w12.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_cvd 
< w13.dt and w13.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is 
not null and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid 
is not null and q.index_date_cvd < w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_cvd2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid 
and w2.generic="PCSK9i" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs 
as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_cvd < w4.dt and 
w4.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
and w6.generic="Mipomersen" and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd < w8.dt 
and w8.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd < w10.dt and 
w10.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_cvd < w12.dt and w12.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_cvd < w13.dt and 
w13.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_cvd 
< w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1142: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_cvd2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_cvd < w1.dt 
and w1.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_cvd < 
w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is not 
null and q.index_date_cvd < w4.dt and w4.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when w5.patid 
is not null and q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_index , case when 
w6.patid is not null and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Mipomersen_index , 
case when w7.patid is not null and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_cvd < w8.dt and w8.dt<=index_date_cvd + INTERVAL 365 DAYS then 
1 end as Hormone_index , case when w9.patid is not null and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS 
then 1 end as Fibrinolytic_index , case when w10.patid is not null and q.index_date_cvd < w10.dt and w10.dt<=index_date_cvd + 
INTERVAL 365 DAYS then 1 end as Betablocker_index , case when w11.patid is not null and q.index_date_cvd < w11.dt and 
w11.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_cvd < w12.dt 
and w12.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_cvd < w13.dt and w13.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is 
not null and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as MRA_index , case 
when w16.patid is not null and q.index_date_cvd < w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS then 1 end as 
Anticoagulant_index from dingyig._12_demo_tx_cvd2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and 
w1.generic="Statins" and q.index_date_cvd < w1.dt and w1.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as 
w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_cvd < w2.dt and w2.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_cvd < w3.dt and w3.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_cvd < w4.dt 
and w4.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" and 
q.index_date_cvd < w5.dt and w5.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid 
514                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

and w6.generic="Mipomersen" and q.index_date_cvd < w6.dt and w6.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_cvd < w7.dt and w7.dt<=index_date_cvd 
+ INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" and q.index_date_cvd < w8.dt 
and w8.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and 
w9.generic="Fibrinolytic" and q.index_date_cvd < w9.dt and w9.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_cvd < w10.dt and 
w10.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and 
q.index_date_cvd < w11.dt and w11.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on 
q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_cvd < w12.dt and w12.dt<=index_date_cvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_cvd < w13.dt and 
w13.dt<=index_date_cvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_cvd < w14.dt and w14.dt<=index_date_cvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_cvd < w15.dt and w15.dt<=index_date_cvd + 
INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_cvd 
< w16.dt and w16.dt<=index_date_cvd + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  19.657444
Total seconds used by the ODBC ACCESS engine were    20.206881
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_cvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_cvd2one_year );
 
ODBC_1143: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_cvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_cvd2one_year
 
 
ODBC_1144: Executed: on connection 2
Prepared statement ODBC_1143
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004350
Total SQL execution seconds were:                   0.050503
Total SQL prepare seconds were:                     0.021405
Total SQL describe seconds were:                    0.000486
Total seconds used by the ODBC ACCESS engine were     0.096252
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 286.
NOTE: PROCEDURE SQL used (Total process time):
      real time           20.47 seconds
      cpu time            0.25 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_anginatia2one_year PURGE ) BY imp;
 
ODBC_1145: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_anginatia2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.090138
Total seconds used by the ODBC ACCESS engine were     0.091781
515                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_anginatia2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid 
is not null and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , 
case when w4.patid is not null and q.index_date_anginatia < w4.dt and w4.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Fibrates_index , case when w5.patid is not null and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Niacin_index , case when w6.patid is not null and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia 
+ INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and 
q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid 
is not null and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index 
, case when w10.patid is not null and q.index_date_anginatia < w10.dt and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 
end as Betablocker_index , case when w11.patid is not null and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + 
INTERVAL 365 DAYS then 1 end as ACE_index , case when w12.patid is not null and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and 
q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when 
w14.patid is not null and q.index_date_anginatia < w14.dt and w14.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Loop_Diuretic_index , case when w15.patid is not null and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + 
INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not null and q.index_date_anginatia < w16.dt and 
w16.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_anginatia2one_year as q 
left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia < w1.dt and 
w1.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" 
and q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on 
q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia < w4.dt and 
w4.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia < w10.dt 
and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia < w14.dt and 
w14.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 
365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1146: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_anginatia2one_year AS select distinct q.* , case when w1.patid is not null and 
q.index_date_anginatia < w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid 
is not null and q.index_date_anginatia < w2.dt and w2.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as PCSK9i_index , 
case when w3.patid is not null and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Ezetimibe_index , case when w4.patid is not null and q.index_date_anginatia < w4.dt and w4.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Fibrates_index , case when w5.patid is not null and q.index_date_anginatia < w5.dt and 
w5.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_index , case when w6.patid is not null and 
q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Mipomersen_index , case when 
w7.patid is not null and q.index_date_anginatia < w7.dt and w7.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
Tocilizumab_index , case when w8.patid is not null and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 
516                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_anginatia < w9.dt and 
w9.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_anginatia < w10.dt and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
ACE_index , case when w12.patid is not null and q.index_date_anginatia < w12.dt and w12.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Antiplatelet_index , case when w13.patid is not null and q.index_date_anginatia < w13.dt and 
w13.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and 
q.index_date_anginatia < w14.dt and w14.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when 
w15.patid is not null and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS then 1 end as 
MRA_index , case when w16.patid is not null and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 365 
DAYS then 1 end as Anticoagulant_index from dingyig._12_demo_tx_anginatia2one_year as q left join dingyig.ldlc_04_drugs as w1 on 
q.patid=w1.patid and w1.generic="Statins" and q.index_date_anginatia < w1.dt and w1.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w2 on q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_anginatia < w2.dt and 
w2.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and 
w3.generic="Ezetimibe" and q.index_date_anginatia < w3.dt and w3.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" and q.index_date_anginatia < w4.dt and 
w4.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on q.patid=w5.patid and w5.generic="Niacin" 
and q.index_date_anginatia < w5.dt and w5.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w6 on 
q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_anginatia < w6.dt and w6.dt<=index_date_anginatia + INTERVAL 365 DAYS 
left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" and q.index_date_anginatia < w7.dt and 
w7.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on q.patid=w8.patid and w8.generic="Hormone" 
and q.index_date_anginatia < w8.dt and w8.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w9 on 
q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_anginatia < w9.dt and w9.dt<=index_date_anginatia + INTERVAL 365 
DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and w10.generic="Betablocker" and q.index_date_anginatia < w10.dt 
and w10.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and 
w11.generic="ACE" and q.index_date_anginatia < w11.dt and w11.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and w12.generic="Antiplatelet" and q.index_date_anginatia < w12.dt and 
w12.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and 
w13.generic="Niacin_Statin" and q.index_date_anginatia < w13.dt and w13.dt<=index_date_anginatia + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and w14.generic="Loop_Diuretic" and q.index_date_anginatia < w14.dt and 
w14.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" 
and q.index_date_anginatia < w15.dt and w15.dt<=index_date_anginatia + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on 
q.patid=w16.patid and w16.generic="Anticoagulant" and q.index_date_anginatia < w16.dt and w16.dt<=index_date_anginatia + INTERVAL 
365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                  17.086982
Total seconds used by the ODBC ACCESS engine were    17.588147
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_anginatia2one_year' As _table, COUNT(*) AS _rows 
FROM dingyig._12_demo_tx1_anginatia2one_year );
 
ODBC_1147: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_anginatia2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_anginatia2one_year
 
 
ODBC_1148: Executed: on connection 2
Prepared statement ODBC_1147
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004472
Total SQL execution seconds were:                   0.049920
Total SQL prepare seconds were:                     0.021433
Total SQL describe seconds were:                    0.000503
Total seconds used by the ODBC ACCESS engine were     0.095230
 
517                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 287.
NOTE: PROCEDURE SQL used (Total process time):
      real time           18.25 seconds
      cpu time            0.22 seconds
      

MPRINT(CREATE):   PROC SQL;
MPRINT(CREATE):   CONNECT TO ODBC AS imp (USER="dingyig" PASSWORD="NewJersey11" DATASRC='rwe');
ODBC: AUTOCOMMIT is YES for connection 2
MPRINT(CREATE):   EXECUTE( DROP TABLE IF EXISTS dingyig._12_demo_tx1_noncvd2one_year PURGE ) BY imp;
 
ODBC_1149: Executed: on connection 2
DROP TABLE IF EXISTS dingyig._12_demo_tx1_noncvd2one_year PURGE
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   0.084933
Total seconds used by the ODBC ACCESS engine were     0.088643
 
MPRINT(CREATE):   EXECUTE( CREATE TABLE dingyig._12_demo_tx1_noncvd2one_year AS
MPRINT(DEMO_TX):   select distinct q.* , case when w1.patid is not null and q.index_date_noncvd < w1.dt and 
w1.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and q.index_date_noncvd < 
w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not null and 
q.index_date_noncvd < w3.dt and w3.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when w4.patid is 
not null and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrates_index , case when 
w5.patid is not null and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Niacin_index , 
case when w6.patid is not null and q.index_date_noncvd < w6.dt and w6.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Mipomersen_index , case when w7.patid is not null and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS 
then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + 
INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_noncvd < w11.dt and w11.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_noncvd < w13.dt and w13.dt<=index_date_noncvd + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_noncvd < w14.dt and 
w14.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_noncvd < w15.dt and w15.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_noncvd2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd < w3.dt and 
w3.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd < w6.dt and 
w6.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd < w11.dt and 
w11.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd < w13.dt and 
518                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

w13.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd < w14.dt and w14.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd < w15.dt and 
w15.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS
MPRINT(CREATE):   ) BY imp;
 
ODBC_1150: Executed: on connection 2
CREATE TABLE dingyig._12_demo_tx1_noncvd2one_year AS select distinct q.* , case when w1.patid is not null and q.index_date_noncvd < 
w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Statins_index , case when w2.patid is not null and 
q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as PCSK9i_index , case when w3.patid is not 
null and q.index_date_noncvd < w3.dt and w3.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Ezetimibe_index , case when 
w4.patid is not null and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrates_index 
, case when w5.patid is not null and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Niacin_index , case when w6.patid is not null and q.index_date_noncvd < w6.dt and w6.dt<=index_date_noncvd + INTERVAL 365 DAYS then 
1 end as Mipomersen_index , case when w7.patid is not null and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 
365 DAYS then 1 end as Tocilizumab_index , case when w8.patid is not null and q.index_date_noncvd < w8.dt and 
w8.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Hormone_index , case when w9.patid is not null and q.index_date_noncvd < 
w9.dt and w9.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Fibrinolytic_index , case when w10.patid is not null and 
q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Betablocker_index , case when 
w11.patid is not null and q.index_date_noncvd < w11.dt and w11.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as ACE_index , 
case when w12.patid is not null and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as 
Antiplatelet_index , case when w13.patid is not null and q.index_date_noncvd < w13.dt and w13.dt<=index_date_noncvd + INTERVAL 365 
DAYS then 1 end as Niacin_Statin_index , case when w14.patid is not null and q.index_date_noncvd < w14.dt and 
w14.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Loop_Diuretic_index , case when w15.patid is not null and 
q.index_date_noncvd < w15.dt and w15.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as MRA_index , case when w16.patid is not 
null and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS then 1 end as Anticoagulant_index from 
dingyig._12_demo_tx_noncvd2one_year as q left join dingyig.ldlc_04_drugs as w1 on q.patid=w1.patid and w1.generic="Statins" and 
q.index_date_noncvd < w1.dt and w1.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w2 on 
q.patid=w2.patid and w2.generic="PCSK9i" and q.index_date_noncvd < w2.dt and w2.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w3 on q.patid=w3.patid and w3.generic="Ezetimibe" and q.index_date_noncvd < w3.dt and 
w3.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w4 on q.patid=w4.patid and w4.generic="Fibrates" 
and q.index_date_noncvd < w4.dt and w4.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w5 on 
q.patid=w5.patid and w5.generic="Niacin" and q.index_date_noncvd < w5.dt and w5.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w6 on q.patid=w6.patid and w6.generic="Mipomersen" and q.index_date_noncvd < w6.dt and 
w6.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w7 on q.patid=w7.patid and w7.generic="Tocilizumab" 
and q.index_date_noncvd < w7.dt and w7.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w8 on 
q.patid=w8.patid and w8.generic="Hormone" and q.index_date_noncvd < w8.dt and w8.dt<=index_date_noncvd + INTERVAL 365 DAYS left 
join dingyig.ldlc_04_drugs as w9 on q.patid=w9.patid and w9.generic="Fibrinolytic" and q.index_date_noncvd < w9.dt and 
w9.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w10 on q.patid=w10.patid and 
w10.generic="Betablocker" and q.index_date_noncvd < w10.dt and w10.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w11 on q.patid=w11.patid and w11.generic="ACE" and q.index_date_noncvd < w11.dt and 
w11.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w12 on q.patid=w12.patid and 
w12.generic="Antiplatelet" and q.index_date_noncvd < w12.dt and w12.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w13 on q.patid=w13.patid and w13.generic="Niacin_Statin" and q.index_date_noncvd < w13.dt and 
w13.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w14 on q.patid=w14.patid and 
w14.generic="Loop_Diuretic" and q.index_date_noncvd < w14.dt and w14.dt<=index_date_noncvd + INTERVAL 365 DAYS left join 
dingyig.ldlc_04_drugs as w15 on q.patid=w15.patid and w15.generic="MRA" and q.index_date_noncvd < w15.dt and 
w15.dt<=index_date_noncvd + INTERVAL 365 DAYS left join dingyig.ldlc_04_drugs as w16 on q.patid=w16.patid and 
w16.generic="Anticoagulant" and q.index_date_noncvd < w16.dt and w16.dt<=index_date_noncvd + INTERVAL 365 DAYS
 
 
Summary Statistics for ODBC are:
Total SQL execution seconds were:                   7.085696
Total seconds used by the ODBC ACCESS engine were     7.585392
 
MPRINT(CREATE):   SELECT * FROM CONNECTION TO imp ( SELECT 'dingyig._12_demo_tx1_noncvd2one_year' As _table, COUNT(*) AS _rows FROM 
dingyig._12_demo_tx1_noncvd2one_year );
519                                                        The SAS System                       Saturday, March 20, 2021 10:31:00 PM

 
ODBC_1151: Prepared: on connection 2
SELECT 'dingyig._12_demo_tx1_noncvd2one_year' As _table, COUNT(*) AS _rows FROM dingyig._12_demo_tx1_noncvd2one_year
 
 
ODBC_1152: Executed: on connection 2
Prepared statement ODBC_1151
 
 
Summary Statistics for ODBC are:
Total row fetch seconds were:                       0.004739
Total SQL execution seconds were:                   0.116117
Total SQL prepare seconds were:                     0.020013
Total SQL describe seconds were:                    0.000535
Total seconds used by the ODBC ACCESS engine were     0.164051
 
MPRINT(CREATE):   QUIT;
NOTE: The PROCEDURE SQL printed page 288.
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.25 seconds
      cpu time            0.13 seconds
      